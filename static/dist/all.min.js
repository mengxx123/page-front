/*! eui-1.1.js 2017-05-07*/
!function(a){"function"==typeof window.define?window.define.amd?window.define("eEditor",["jquery"],a):window.define.cmd?window.define(function(b,c,d){return a}):a(window.jQuery):"object"==typeof module&&"object"==typeof module.exports?(window.eEditorCssPath?require(window.eEditorCssPath):require("../dist/css/eEditor.css"),module.exports=a(window.eEditorJQueryPath?require(window.eEditorJQueryPath):require("jquery"))):a(window.jQuery)}(function(a){if(!jQuery)return void alert("在引用 editor.js 之前，先引用jQuery，否则无法使用 editor");var b=function(b){var c=window.EDITOR;c&&b(c,a)};return function(a,b){if(a.EDITOR)return void alert("一个页面不能重复引用 editor.js ！！！");var c=function(a,d){"string"==typeof a&&(a="#"+a);var e=b(a);if(1===e.length){this.opts=b.extend({},c.DEFAULTS,d);var f=e[0].nodeName;"TEXTAREA"!==f&&"DIV"!==f||(this.lock=!1,this.valueNodeName=f.toLowerCase(),this.$valueContainer=e,this.$prev=e.prev(),this.$parent=e.parent(),this.init())}};c.DEFAULTS={simple:!1},c.fn=c.prototype,c.$body=b("body"),c.$document=b(document),c.$window=b(a),c.userAgent=navigator.userAgent,c.getComputedStyle=a.getComputedStyle,c.w3cRange="function"==typeof document.createRange,c.hostname=location.hostname.toLowerCase(),c.websiteHost="eeditor.github.io|www.eeditor.com|eeditor.coding.me",c.isOnWebsite=c.websiteHost.indexOf(c.hostname)>=0,c.isOnWebsite=!0,a.Editor=a.EDITOR=c,c.plugin=function(a){c._plugins||(c._plugins=[]),"function"==typeof a&&c._plugins.push(a)}}(window,a),b(function(a,b){a.fn.addEditorContainer=function(){this.$editorContainer=b('<div class="eEditor-container"></div>')},a.fn.addTxt=function(){var b=this,c=new a.Txt(b);b.txt=c},a.fn.initDefaultConfig0=function(){var c=this;c.config=b.extend({},a.config)},a.fn.init=function(){this.readyFns=[],this.initDefaultConfig0(),this.initDefaultConfig&&this.initDefaultConfig(),this.opts.simple||this.addEditorContainer&&this.addEditorContainer(),this.addTxt&&this.addTxt(),this.readyHeadler(),a.readyHeadler.call(this),this.commandHooks(),this.initUi&&this.initUi()},a.fn.triggerChange=function(){this.lock||this.trigger("stateChange")}}),b(function(a,b){a.fn.ready=function(a){!this.readyFns,this.readyFns.push(a)},a.fn.readyHeadler=function(){for(var a=this.readyFns;a.length;)a.shift().call(this)},a.fn.updateValue=function(){var a=this,b=a.txt.$txt;if(a.$valueContainer!==b){var c=b.html();a.$valueContainer.val(c)}},a.fn.getInitValue=function(){var a=this,b="",c=a.valueNodeName;return"div"===c?b=a.$valueContainer.html():"textarea"===c&&(b=a.$valueContainer.val()),b}}),b(function(a,b){function c(){}var d=!a.w3cRange;a.fn.test=function(){},a.fn.currentRange=function(a){return a?void(this._rangeData=a):this._rangeData},a.fn.collapseRange=function(a,b){b=b||"end",b="start"===b,a=a||this.currentRange(),a&&(a.collapse(b),this.currentRange(a))},a.fn.getRangeText=d?c:function(a){if(a=a||this.currentRange())return a.toString()},a.fn.getRangeElem=d?c:function(a){a=a||this.currentRange();var b=a.commonAncestorContainer;return 1===b.nodeType?b:b.parentNode},a.fn.isRangeEmpty=d?c:function(a){return a=a||this.currentRange(),!(!a||!a.startContainer||a.startContainer!==a.endContainer||a.startOffset!==a.endOffset)},a.fn.saveSelection=d?c:function(a){var c,d,e=this,f=e.txt.$txt.get(0);a?c=a.commonAncestorContainer:(d=document.getSelection(),d.getRangeAt&&d.rangeCount&&(a=document.getSelection().getRangeAt(0),c=a.commonAncestorContainer)),c&&(b.contains(f,c)||f===c)&&e.currentRange(a)},a.fn.restoreSelection=d?c:function(b){var c;if(b=b||this.currentRange())try{c=document.getSelection(),c.removeAllRanges(),c.addRange(b)}catch(d){a.error("执行 editor.restoreSelection 时，IE可能会有异常，不影响使用")}},a.fn.restoreSelectionByElem=d?c:function(a,b){a&&(b=b||"end",this.setRangeByElem(a),"start"===b&&this.collapseRange(this.currentRange(),"start"),"end"===b&&this.collapseRange(this.currentRange(),"end"),this.restoreSelection())},a.fn.initSelection=d?c:function(){var a=this;if(!a.currentRange()){var b=a.txt.$txt,c=b.children().first();c.length&&a.restoreSelectionByElem(c.get(0))}},a.fn.setRangeByElem=d?c:function(a){var c=this,d=c.txt.$txt.get(0);if(a&&b.contains(d,a)){for(var e=a.firstChild;e&&3!==e.nodeType;)e=e.firstChild;for(var f=a.lastChild;f&&3!==f.nodeType;)f=f.lastChild;var g=document.createRange();e&&f?(g.setStart(e,0),g.setEnd(f,f.textContent.length)):(g.setStart(a,0),g.setEnd(a,0)),c.saveSelection(g)}}}),b(function(a,b){a.fn.commandHooks=function(){var a=this,c={};c.insertHtml=function(c){var d,e=b(c),f=a.getRangeElem();d=a.getLegalTags(f),d&&b(d).after(e)},a.commandHooks=c}}),b(function(a,b){a.fn.command=function(a,b,c,d){function e(){b&&(g.queryCommandSupported(b)?document.execCommand(b,!1,c):(f=g.commandHooks,b in f&&f[b](c)))}var f,g=this;this.customCommand(a,e,d)},a.fn.commandForElem=function(a,b,c,d,e){var f,g;"string"==typeof a?f=a:(f=a.selector,g=a.check);var h=this.getRangeElem();h=this.getSelfOrParentByName(h,f,g),h&&this.setRangeByElem(h),this.command(b,c,d,e)},a.fn.customCommand=function(a,b,c){var d=this,e=d.currentRange();return e?(d.undoRecord&&d.undoRecord(),this.restoreSelection(e),b.call(d),this.saveSelection(),this.restoreSelection(),c&&"function"==typeof c&&c.call(d),d.txt.insertEmptyP(),d.txt.wrapImgAndText(),d.updateValue(),d.updateMenuStyle&&d.updateMenuStyle(),d.triggerChange(),void(a&&a.preventDefault())):void(a&&a.preventDefault())},a.fn.queryCommandState=function(b){if(a.cmds[b]&&a.cmds[b].queryState){var c=a.cmds[b].queryState(this);return c}var d=b;a.cmds[b]&&a.cmds[b].systemCmd&&(d=a.cmds[b].systemCmd);var c=!1;try{c=document.queryCommandState(d)}catch(e){}return c},a.fn.queryCommandSupported=function(a){var b=!1;try{b=document.queryCommandSupported(a)}catch(c){}return b}}),b(function(a,b){function c(a){var c=this,d=b(a),e=!1;return d.each(function(){if(this===c)return e=!0,!1}),e}var d;a.fn.getLegalTags=function(b){var c=this.config.legalTags;return c?this.getSelfOrParentByName(b,c):void a.error("配置项中缺少 legalTags 的配置")},a.fn.getSelfOrParentByName=function(a,e,f){if(a&&e){d||(d=a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.matchesSelector),d||(d=c);for(var g=this.txt.$txt.get(0);a&&g!==a&&b.contains(g,a);){if(d.call(a,e)){if(!f)return a;if(f(a))return a}a=a.parentNode}}}}),b(function(a,b){var c=window.console,d=function(){};b.each(["info","log","warn","error"],function(b,e){null==c?a[e]=d:a[e]=function(b){a.config&&a.config.printLog&&c[e]("editor提示: "+b)}}),a.random=function(){return Math.random().toString().slice(2)}}),b(function(a,b){a.langs={},a.langs["zh-cn"]={bold:"粗体",underline:"下划线",italic:"斜体",forecolor:"文字颜色",bgcolor:"背景色",strikethrough:"删除线",eraser:"清空格式",source:"源码",quote:"引用",fontfamily:"字体",fontsize:"字号",head:"标题",orderlist:"有序列表",unorderlist:"无序列表",alignleft:"左对齐",aligncenter:"居中",alignright:"右对齐",link:"链接",text:"文本",submit:"提交",cancel:"取消",unlink:"取消链接",table:"表格",emotion:"表情",img:"图片",video:"视频",width:"宽",height:"高",location:"位置",loading:"加载中",searchlocation:"搜索位置",dynamicMap:"动态地图",clearLocation:"清除位置",langDynamicOneLocation:"动态地图只能显示一个位置",insertcode:"插入代码",undo:"撤销",redo:"重复",fullscreen:"全屏",openLink:"打开链接"},a.langs.en={bold:"Bold",underline:"Underline",italic:"Italic",forecolor:"Color",bgcolor:"Backcolor",strikethrough:"Strikethrough",eraser:"Eraser",source:"Codeview",quote:"Quote",fontfamily:"Font family",fontsize:"Font size",head:"Head",orderlist:"Ordered list",unorderlist:"Unordered list",alignleft:"Align left",aligncenter:"Align center",alignright:"Align right",link:"Insert link",text:"Text",submit:"Submit",cancel:"Cancel",unlink:"Unlink",table:"Table",emotion:"Emotions",img:"Image",video:"Video",width:"width",height:"height",location:"Location",loading:"Loading",searchlocation:"search",dynamicMap:"Dynamic",clearLocation:"Clear",langDynamicOneLocation:"Only one location in dynamic map",insertcode:"Insert Code",undo:"Undo",redo:"Redo",fullscreen:"Full screnn",openLink:"open link"}}),b(function(a,b){a.config={},a.config.zindex=1e4,a.config.printLog=!0,a.config.jsFilter=!0,a.config.legalTags="p,h1,h2,h3,h4,h5,h6,blockquote,table,ul,ol,pre",a.config.lang=a.langs["zh-cn"],a.config.pasteFilter=!0,a.config.pasteText=!1}),b(function(a,b){var c=function(a){this.editor=a,this.init()};c.fn=c.prototype,a.Txt=c}),b(function(a,b){var c=a.Txt;c.fn.init=function(){var a,c=this,d=c.editor,e=d.$valueContainer,f=d.getInitValue();"DIV"===e.get(0).nodeName?(a=e,a.addClass("eEditor-txt"),a.attr("contentEditable","true"),console.log("是")):(console.log("不是"),a=b('<div class="eEditor-txt" contentEditable="true">'+f+"</div>")),d.ready(function(){c.insertEmptyP()}),c.$txt=a,c.contentEmptyHandle(),c.bindEnterForDiv(),c.bindEnterForText(),c.bindTabEvent(),c.bindPasteFilter(),c.bindFormatText(),c.bindHtml()},c.fn.contentEmptyHandle=function(){var a,c=this,d=c.editor,e=c.$txt;e.on("keydown.ui.editor",function(a){if(8===a.keyCode){var c=b.trim(e.html().toLowerCase());return"<p><br></p>"===c?void a.preventDefault():void 0}}),e.on("keyup.ui.editor",function(c){if(8===c.keyCode){var f=b.trim(e.html().toLowerCase());f&&"<br>"!==f||(a=b("<p><br/></p>"),e.html(""),e.append(a),d.restoreSelectionByElem(a.get(0)))}})},c.fn.bindEnterForDiv=function(){function c(){if(d){var a=b("<p>"+d.html()+"</p>");d.after(a),d.remove()}}var d,e=(a.config.legalTags,this),f=e.editor,g=e.$txt;g.on("keydown.ui.editor keyup.ui.editor",function(a){if(13===a.keyCode){var e,g,h=f.getRangeElem(),i=f.getLegalTags(h);if(!i){if(i=f.getSelfOrParentByName(h,"div"),!i)return;e=b(i),"keydown"===a.type&&(d=e,setTimeout(c,0)),"keyup"===a.type&&(g=b("<p>"+e.html()+"</p>"),e.after(g),e.remove(),f.restoreSelectionByElem(g.get(0),"start"))}}})},c.fn.bindEnterForText=function(){var a,b=this,c=b.$txt;c.on("keyup.ui.editor",function(c){13===c.keyCode&&(a||(a=function(){b.wrapImgAndText()}),setTimeout(a))})},c.fn.bindTabEvent=function(){var a=this,b=a.editor,c=a.$txt;c.on("keydown.ui.editor",function(a){9===a.keyCode&&b.queryCommandSupported("insertHtml")&&b.command(a,"insertHtml","&nbsp;&nbsp;&nbsp;&nbsp;")})},c.fn.bindPasteFilter=function(){function a(e){if(e&&e.nodeType&&e.nodeName){var f,h=e.nodeName.toLowerCase(),i=e.nodeType;if(3===i||1===i){if(f=b(e),"div"===h)return void b.each(e.childNodes,function(){a(this)});if(j.indexOf(h)>=0)g+=c(e);else if(3===i)g+="<p>"+e.textContent+"</p>";else if("br"===h)g+="<br/>";else{if(["meta","style","script","object","form","iframe","hr"].indexOf(h)>=0)return;f=b(d(e)),g+=b("<div>").append(f.clone()).html()}}}}function c(a){var c,e=a.nodeName.toLowerCase(),f="",g="";return["blockquote"].indexOf(e)>=0?(c=b(a),"<"+e+">"+c.text()+"</"+e+">"):["p","h1","h2","h3","h4","h5"].indexOf(e)>=0?(a=d(a),c=b(a),f=c.html(),f=f.replace(/<.*?>/gi,function(a){return"</a>"===a||0===a.indexOf("<a ")||0===a.indexOf("<img ")?a:""}),"<"+e+">"+f+"</"+e+">"):["ul","ol"].indexOf(e)>=0?(c=b(a),c.children().each(function(){var a=b(d(this)),c=a.html();c=c.replace(/<.*?>/gi,function(a){return"</a>"===a||0===a.indexOf("<a ")||0===a.indexOf("<img ")?a:""}),g+="<li>"+c+"</li>"}),"<"+e+">"+g+"</"+e+">"):(c=b(d(a)),b("<div>").append(c).html())}function d(a){var c=a.attributes||[],e=[],f=["href","target","src","alt","rowspan","colspan"];b.each(c,function(a,b){b&&2===b.nodeType&&e.push(b.nodeName)}),b.each(e,function(b,c){f.indexOf(c)<0&&a.removeAttribute(c)});var g=a.childNodes;return g.length&&b.each(g,function(a,b){d(b)}),a}var e=this,f=e.editor,g="",h=e.$txt,i=f.config.legalTags,j=i.split(",");h.on("paste.ui.editor",function(c){if(f.config.pasteFilter){var d=f.getRangeElem().nodeName;if("TD"!==d&&"TH"!==d){g="";var h,i,j=c.clipboardData||c.originalEvent.clipboardData,k=window.clipboardData;if(f.config.pasteText){if(j&&j.getData)h=j.getData("text/plain");else{if(!k||!k.getData)return;h=k.getData("text")}h&&(g="<p>"+h+"</p>")}else if(j&&j.getData)h=j.getData("text/html"),h?(i=b("<div>"+h+"</div>"),a(i.get(0))):(h=j.getData("text/plain"),h&&(h=h.replace(/[ ]/g,"&nbsp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"</p><p>"),g="<p>"+h+"</p>",g=g.replace(/<p>(https?:\/\/.*?)<\/p>/gi,function(a,b){return'<p><a href="'+b+'" target="_blank">'+b+"</p>"})));else{if(!k||!k.getData)return;if(g=k.getData("text"),!g)return;g="<p>"+g+"</p>",g=g.replace(new RegExp("\n","g"),"</p><p>")}g&&(f.command(c,"insertHtml",g),e.clearEmptyOrNestP())}}})},c.fn.bindFormatText=function(){var c=this,d=(c.editor,c.$txt),e=a.config.legalTags,f=e.split(","),g=(f.length,[]);b.each(f,function(a,b){var c=">\\s*<("+b+")>";g.push(new RegExp(c,"ig"))}),g.push(new RegExp(">\\s*<(li)>","ig")),g.push(new RegExp(">\\s*<(tr)>","ig")),g.push(new RegExp(">\\s*<(code)>","ig")),d.formatText=function(){var a=b("<div>"),c=d.html();return c=c.replace(/\s*</gi,"<"),b.each(g,function(a,b){b.test(c)&&(c=c.replace(b,function(a,b){return">\n<"+b+">"}))}),a.html(c),a.text()}},c.fn.bindHtml=function(){var a=this,c=a.editor,d=a.$txt,e=c.$valueContainer,f=c.valueNodeName;d.html=function(a){var c;return"div"===f&&(c=b.fn.html.call(d,a)),void 0===a?(c=b.fn.html.call(d),c=c.replace(/(href|src)\=\"(.*)\"/gim,function(a,b,c){return b+'="'+c.replace("&amp;","&")+'"'})):(c=b.fn.html.call(d,a),e.val(a)),void 0===a?c:void d.change()}}}),b(function(a,b){var c=a.Txt,d="propertychange change click keyup input paste";c.fn.initHeight=function(){var a=this.editor,b=this.$txt,c=a.$valueContainer.height(),d=a.menuContainer.height(),e=c-d;e=e<50?50:e,b.height(e),a.valueContainerHeight=c,this.initMaxHeight(e,d)},c.fn.initMaxHeight=function(c,d){var e=this.editor,f=e.menuContainer.$menuContainer,g=this.$txt,h=b("<div>");if(window.getComputedStyle&&"max-height"in window.getComputedStyle(g.get(0))){var i=parseInt(e.$valueContainer.css("max-height"));if(isNaN(i))return;if(e.menus.fullscreen)return void a.warn("max-height和『全屏』菜单一起使用时，会有一些问题尚未解决，请暂时不要两个同时使用");e.useMaxHeight=!0,h.css({"max-height":i-d+"px","overflow-y":"auto"}),g.css({height:"auto","overflow-y":"visible","min-height":c+"px"}),h.on("scroll",function(){g.parent().scrollTop()>10?f.addClass("eEditor-menu-shadow"):f.removeClass("eEditor-menu-shadow")}),this.opts.simple||g.wrap(h)}},c.fn.saveSelectionEvent=function(){function a(){g.saveSelection()}function b(){Date.now()-h<100||(h=Date.now(),a())}function c(){e&&clearTimeout(e),e=setTimeout(a,300)}var e,f=this.$txt,g=this.editor,h=Date.now();f.on(d+" focus blur",function(a){b(),c()}),f.on("mousedown.ui.editor",function(){f.on("mouseleave.saveSelection",function(a){b(),c(),g.updateMenuStyle&&g.updateMenuStyle(),g.triggerChange()})}).on("mouseup.ui.editor",function(){f.off("mouseleave.saveSelection")})},c.fn.updateValueEvent=function(){function a(){var a=e.html();c!==a&&(f.onchange&&"function"==typeof f.onchange&&f.onchange.call(f),f.updateValue(),c=a)}var b,c,e=this.$txt,f=this.editor;e.on(d,function(d){null==c&&(c=e.html()),b&&clearTimeout(b),b=setTimeout(a,100)})},c.fn.updateMenuStyleEvent=function(){var a=this.$txt,b=this.editor;a.on(d,function(a){b.updateMenuStyle&&b.updateMenuStyle(),b.triggerChange()})},c.fn.insertEmptyP=function(){var a=this.$txt,c=a.children();return 0===c.length?void a.append(b("<p><br></p>")):void("<br>"!==b.trim(c.last().html()).toLowerCase()&&a.append(b("<p><br></p>")))},c.fn.wrapImgAndText=function(){var a,c,d=this.$txt,e=d.children("img"),f=d[0],g=f.childNodes,h=g.length;for(e.length&&e.each(function(){b(this).wrap("<p>")}),a=0;a<h;a++)c=g[a],3===c.nodeType&&c.textContent&&b.trim(c.textContent)&&b(c).wrap("<p>")},c.fn.clearEmptyOrNestP=function(){var a=this.$txt,c=a.find("p");c.each(function(){var a,c=b(this),d=c.children(),e=d.length,f=b.trim(c.html());return f?void(1===e&&(a=d.first(),a.get(0)&&"P"===a.get(0).nodeName&&c.html(a.html()))):void c.remove()})},c.fn.scrollTop=function(a){var b=this,c=b.editor,d=b.$txt;return c.useMaxHeight?d.parent().scrollTop(a):d.scrollTop(a)},c.fn.showHeightOnHover=function(){function a(a){i||(e.append(h),i=!0);var b=(g.position().top,g.outerHeight(),a.height()),c=a.position().top,d=parseInt(a.css("margin-top"),10),j=parseInt(a.css("padding-top"),10),k=parseInt(a.css("margin-bottom"),10),l=parseInt(a.css("padding-bottom"),10);c+f.height();h.css({height:b+j+d+l+k,top:c+f.height()})}function c(){i&&(h.remove(),i=!1)}var d=this.editor,e=d.$editorContainer,f=d.menuContainer,g=this.$txt,h=b('<i class="height-tip"><i>'),i=!1;g.on("mouseenter.ui.editor","ul,ol,blockquote,p,h1,h2,h3,h4,h5,table,pre",function(c){a(b(c.currentTarget))}).on("mouseleave.ui.editor",function(){c()})}}),b(function(a,b){a.fn.create=function(){var c=this;a.$body&&0!==a.$body.length||(a.$body=b("body"),a.$document=b(document),a.$window=b(window)),c.createMenu&&c.createMenu(),c.eventTxt(),c.renderTxt(),c.renderEditorContainer(),c.initSelection(),c.$txt=c.txt.$txt;var d=a._plugins;d&&d.length&&b.each(d,function(a,b){b.call(c)}),this.trigger("ready")},a.fn.disable=function(){this.txt.$txt.removeAttr("contenteditable"),this.disableMenusExcept(),this._disabled=!0},a.fn.enable=function(){this._disabled=!1,this.txt.$txt.attr("contenteditable","true"),this.enableMenusExcept()},a.fn.destroy=function(){var a=this.$valueContainer,b=this.$editorContainer,c=this.valueNodeName;this.opts.simple?a.removeAttr("contenteditable"):"div"===c?(a.removeAttr("contenteditable"),b.after(a),b.hide()):(a.show(),b.hide());var d=this.txt.$txt;d.children().last().remove(),d.removeClass("eEditor-txt"),d.off(".ui.editor")},a.fn.clear=function(){var a=this,b=a.txt.$txt;b.html("<p><br></p>"),a.restoreSelectionByElem(b.find("p").get(0))},a.fn.renderTxt=function(){var a=this.txt;if(!this.opts.simple){var b=this.$editorContainer;b.append(this.$txt)}this.ready(function(){a.initHeight()})},a.fn.eventTxt=function(){var a=this.txt;a.saveSelectionEvent(),a.updateValueEvent(),a.updateMenuStyleEvent()},a.fn.renderEditorContainer=function(){var a,b,c=this,d=c.$valueContainer,e=c.$editorContainer,f=c.txt.$txt;d===f?(a=c.$prev,b=c.$parent,a&&a.length?a.after(e):b.prepend(e)):(d.after(e),d.hide())}}),window.EDITOR}),function(){var a=window.EDITOR;a.cmds={},a.addCommand=function(b){a.cmds[b.name]={name:b.name,value:null,handler:b.handler,queryState:b.queryState}},a.fn.execCommand=function(b,c){a.cmds[b]&&a.cmds[b].handler.call(this,this,c)},a.fn.queryCommandValue=function(b){var c=b;a.cmds[b]&&a.cmds[b].systemCmd&&(c=a.cmds[b].systemCmd);var d="";try{d=document.queryCommandValue(c)}catch(e){}return d}}(),function(){var a=window.EDITOR;a.fn.on=function(a,b){this.eventHandlers||(this.eventHandlers={}),this.eventHandlers[a]||(this.eventHandlers[a]=[]),this.eventHandlers[a].push(b)},a.fn.trigger=function(a){if(this.eventHandlers&&this.eventHandlers[a])for(var b=this.eventHandlers[a],c=0;c<b.length;c++)b[c]()},a.ready=function(b){a.readyFns||(a.readyFns=[]),a.readyFns.push(b)},a.readyHeadler=function(){var b=a.readyFns;if(b)for(var c=0;c<b.length;c++)b[c].call(this)}}(),function(){function a(a){var b;return!!(a&&a.style&&null!=a.style.cssText&&(b=a.style.cssText,b&&b.indexOf("background-color:")>=0))}var b=window.Editor;b.addCommand({name:"bold",handler:function(){var a=null,b=this.isRangeEmpty();b?this.commandForElem("b,strong,h1,h2,h3,h4,h5",a,"Bold"):this.command(a,"Bold")},systemCmd:"Bold"}),b.addCommand({name:"italic",handler:function(){var a=null,b=this.isRangeEmpty();b?this.commandForElem("i",a,"Italic"):this.command(a,"Italic")},systemCmd:"Italic"}),b.addCommand({name:"align-left",handler:function(){var a=null;this.command(a,"JustifyLeft")},systemCmd:"JustifyLeft",queryState:function(a){var b=a.getRangeElem();return b=a.getSelfOrParentByName(b,"p,h1,h2,h3,h4,h5,li",function(a){var b;return!!(a&&a.style&&null!=a.style.cssText&&(b=a.style.cssText,b&&/text-align:\s*left;/.test(b)))||"left"===$(a).attr("align")}),!!b}}),b.addCommand({name:"align-right",handler:function(){var a=null;this.command(a,"JustifyRight")},systemCmd:"JustifyRight",queryState:function(a){var b=a.getRangeElem();return b=a.getSelfOrParentByName(b,"p,h1,h2,h3,h4,h5,li",function(a){var b;return!!(a&&a.style&&null!=a.style.cssText&&(b=a.style.cssText,b&&/text-align:\s*right;/.test(b)))||"right"===$(a).attr("align")}),!!b}}),b.addCommand({name:"align-center",handler:function(){var a=null;this.command(a,"JustifyCenter")},systemCmd:"JustifyCenter",queryState:function(a){var b=a.getRangeElem();return b=a.getSelfOrParentByName(b,"p,h1,h2,h3,h4,h5,li",function(a){var b;return!!(a&&a.style&&null!=a.style.cssText&&(b=a.style.cssText,b&&/text-align:\s*center;/.test(b)))||"center"===$(a).attr("align")}),!!b}}),b.addCommand({name:"underline",handler:function(a){var b=null,c=a.isRangeEmpty();c?a.commandForElem("u,a",b,"Underline"):a.command(b,"Underline")},systemCmd:"Underline"}),b.addCommand({name:"strikethrough",handler:function(a){var b=null,c=a.isRangeEmpty();c?a.commandForElem("strike",b,"StrikeThrough"):a.command(b,"StrikeThrough")},systemCmd:"StrikeThrough"}),b.ready(function(){function a(){c.undoRecord()}var b,c=this,d=c.txt.$txt;d.on("keydown.ui.editor",function(d){var e=d.keyCode;return d.ctrlKey&&90===e?void c.undo():void(13===e?a():(b&&clearTimeout(b),b=setTimeout(a,1e3)))}),c.undoRecord()}),b.addCommand({name:"undo",handler:function(a){a.undo()}}),b.addCommand({name:"redo",handler:function(a){a.redo()}}),b.addCommand({name:"unorderlist",handler:function(a){var b=null;this.command(b,"InsertUnorderedList")},systemCmd:"InsertUnorderedList"}),b.addCommand({name:"orderlist",handler:function(a){var b=null;this.command(b,"InsertOrderedList")},systemCmd:"InsertOrderedList"}),b.addCommand({name:"superscript",handler:function(a){var b=null,c=a.isRangeEmpty();c?a.commandForElem("p,sup",b,"SuperScript"):a.command(b,"SuperScript")},systemCmd:"SuperScript"}),b.addCommand({name:"subscript",handler:function(a){var b=null,c=a.isRangeEmpty();c?a.commandForElem("sub",b,"SubScript"):a.command(b,"SubScript")},systemCmd:"SubScript"}),b.addCommand({name:"forecolor",handler:function(a,b){var c=null,d=a.isRangeEmpty();d?a.commandForElem("sub",c,"SubScript"):a.command(c,"forecolor",b)},queryState:function(a){var b=a.getRangeElem(),c=$(b).css("color");return c}}),b.addCommand({name:"fontfamily",handler:function(a,b){var c=null,d=a.isRangeEmpty();d?a.commandForElem("sub",c,"SubScript"):a.command(c,"fontName",b)},queryState:function(a){var b=a.getRangeElem(),c=$(b).css("font-family");return c}}),b.addCommand({name:"fontsize",handler:function(a,b){var c=null,d=a.isRangeEmpty();if(d)a.commandForElem("sub",c,"SubScript");else{a.lock=!0,a.command(c,"fontSize",b);var e=a.getRangeElem();$(e).css("font-size",b),a.lock=!1,a.triggerChange()}},queryState:function(a){var b=a.getRangeElem(),c=$(b).css("font-size");return console.log("qs",c),c}}),b.addCommand({name:"link",handler:function(a,b){},queryState:function(a){var b=a.getRangeElem(),c=a.getSelfOrParentByName(b,"a");return!!c},systemCmd:"unLink"}),b.addCommand({name:"unlink",handler:function(a,b){function c(){h.after(i).remove()}function d(){a.restoreSelectionByElem(i.get(0))}var e=null,f=a.getRangeElem(),g=a.getSelfOrParentByName(f,"a");if(g){var h=$(g),i=$("<span>"+h.text()+"</span>");a.customCommand(e,c,d)}},queryState:function(a){var b=a.getRangeElem(),c=a.getSelfOrParentByName(b,"a");return!!c},systemCmd:"unLink"}),b.addCommand({name:"bgcolor",handler:function(b,c){var d=null,e=b.isRangeEmpty();e?b.command(d,"BackColor",c):b.commandForElem({selector:"span,font",check:a},d,"BackColor",c)},queryState:function(a){var b=a.getRangeElem(),c=$(b).css("background-color");return c}})}(),function(a){var b=(window.EDITOR,function(b){var c=window.EDITOR;c&&b(c,a)});b(function(a,b){function c(a){return null==a._redoList&&(a._redoList=[]),a._redoList}function d(a){return null==a._undoList&&(a._undoList=[]),a._undoList}function e(a,b,c){var d=b.val,e=a.txt.$txt.html();if(null!=d){if(d===e)return"redo"===c?void a.redo():"undo"===c?void a.undo():void 0;a.txt.$txt.html(d),a.updateValue(),a.onchange&&"function"==typeof a.onchange&&a.onchange.call(a)}}var f=20;a.fn.undoRecord=function(){var a=this,b=a.txt.$txt,e=b.html(),g=d(a),h=c(a),i=g.length?g[0]:"";e!==i.val&&(h.length&&(h=[]),g.unshift({range:a.currentRange(),val:e}),g.length>f&&g.pop())},a.fn.undo=function(){var a=this,b=d(a),f=c(a);if(b.length){var g=b.shift();f.unshift(g),e(this,g,"undo")}},a.fn.redo=function(){var a=this,b=d(a),f=c(a);if(f.length){var g=f.shift();b.unshift(g),e(this,g,"redo")}}})}(jQuery),!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a:a(jQuery)}(function(a){function b(b){var g=b||window.event,h=i.call(arguments,1),j=0,l=0,m=0,n=0,o=0,p=0;if(b=a.event.fix(g),b.type="mousewheel","detail"in g&&(m=-1*g.detail),"wheelDelta"in g&&(m=g.wheelDelta),"wheelDeltaY"in g&&(m=g.wheelDeltaY),"wheelDeltaX"in g&&(l=-1*g.wheelDeltaX),"axis"in g&&g.axis===g.HORIZONTAL_AXIS&&(l=-1*m,m=0),j=0===m?l:m,"deltaY"in g&&(m=-1*g.deltaY,j=m),"deltaX"in g&&(l=g.deltaX,0===m&&(j=-1*l)),0!==m||0!==l){if(1===g.deltaMode){var q=a.data(this,"mousewheel-line-height");j*=q,m*=q,l*=q}else if(2===g.deltaMode){var r=a.data(this,"mousewheel-page-height");j*=r,m*=r,l*=r}if(n=Math.max(Math.abs(m),Math.abs(l)),(!f||f>n)&&(f=n,d(g,n)&&(f/=40)),d(g,n)&&(j/=40,l/=40,m/=40),j=Math[j>=1?"floor":"ceil"](j/f),l=Math[l>=1?"floor":"ceil"](l/f),m=Math[m>=1?"floor":"ceil"](m/f),k.settings.normalizeOffset&&this.getBoundingClientRect){var s=this.getBoundingClientRect();o=b.clientX-s.left,p=b.clientY-s.top}return b.deltaX=l,b.deltaY=m,b.deltaFactor=f,b.offsetX=o,b.offsetY=p,b.deltaMode=0,h.unshift(b,j,l,m),e&&clearTimeout(e),e=setTimeout(c,200),(a.event.dispatch||a.event.handle).apply(this,h)}}function c(){f=null}function d(a,b){return k.settings.adjustOldDeltas&&"mousewheel"===a.type&&b%120===0}var e,f,g=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],h="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],i=Array.prototype.slice;if(a.event.fixHooks)for(var j=g.length;j;)a.event.fixHooks[g[--j]]=a.event.mouseHooks;var k=a.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var c=h.length;c;)this.addEventListener(h[--c],b,!1);else this.onmousewheel=b;a.data(this,"mousewheel-line-height",k.getLineHeight(this)),a.data(this,"mousewheel-page-height",k.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var c=h.length;c;)this.removeEventListener(h[--c],b,!1);else this.onmousewheel=null;a.removeData(this,"mousewheel-line-height"),a.removeData(this,"mousewheel-page-height")},getLineHeight:function(b){var c=a(b),d=c["offsetParent"in a.fn?"offsetParent":"parent"]();return d.length||(d=a("body")),parseInt(d.css("fontSize"),10)||parseInt(c.css("fontSize"),10)||16},getPageHeight:function(b){return a(b).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})}),function(){"use strict";function a(a){return"[object Array]"===Object.prototype.toString.call(a)}var b=function(a){this.value={h:0,s:0,b:0,a:1},this.origFormat=null,a&&(void 0!==a.toLowerCase?(a+="",this.setColor(a)):void 0!==a.h&&(this.value=a))};b.prototype={constructor:b,colors:{aliceblue:"#f0f8ff",yellowgreen:"#9acd32",transparent:"transparent"},_sanitizeNumber:function(a){return"number"==typeof a?a:isNaN(a)||null===a||""===a||void 0===a?1:""===a?0:void 0!==a.toLowerCase?(a.match(/^\./)&&(a="0"+a),Math.ceil(100*parseFloat(a))/100):1},setColor:function(a){a=a.toLowerCase().trim(),a&&(b.isTransparent(a)?this.value={h:0,s:0,b:0,a:0}:this.value=this.stringToHSB(a)||{h:0,s:0,b:0,a:1})},stringToHSB:function(a){a=a.toLowerCase();var b=this,c=!1;return $.each(this.stringParsers,function(d,e){var f=e.re.exec(a),g=f&&e.parse.apply(b,[f]),h=e.format||"rgba";return!g||(c=h.match(/hsla?/)?b.RGBtoHSB.apply(b,b.HSLtoRGB.apply(b,g)):b.RGBtoHSB.apply(b,g),b.origFormat=h,!1)}),c},setR:function(a){var b=this.toRGB();return b.r=a,this.value=this.RGBtoHSB(b.r,b.g,b.b,b.a),this},setG:function(a){var b=this.toRGB();return b.g=a,this.value=this.RGBtoHSB(b.r,b.g,b.b,b.a),this},setB:function(a){var b=this.toRGB();return b.b=a,this.value=this.RGBtoHSB(b.r,b.g,b.b,b.a),this},setHue:function(a){return this.value.h=a,this},setSaturation:function(a){return this.value.s=a,this},setBrightness:function(a){return this.value.b=a,this},setAlpha:function(a){this.value.a=Math.round(parseInt(100*a,10)/100*100)/100},toRGB:function(a,b,c,d){a||(a=this.value.h,b=this.value.s,c=this.value.b),a*=360;var e,f,g,h,i;return a=a%360/60,i=c*b,h=i*(1-Math.abs(a%2-1)),e=f=g=c-i,a=~~a,e+=[i,h,0,0,h,i][a],f+=[h,i,i,h,0,0][a],g+=[0,0,h,i,i,h][a],{r:Math.round(255*e),g:Math.round(255*f),b:Math.round(255*g),a:d||this.value.a}},toHex:function(a,c,d,e){var f=this.toRGB(a,c,d,e);return b.rgbaIsTransparent(f)?"transparent":"#"+(1<<24|parseInt(f.r)<<16|parseInt(f.g)<<8|parseInt(f.b)).toString(16).substr(1)},toHSL:function(a,b,c,d){a=a||this.value.h,b=b||this.value.s,c=c||this.value.b,d=d||this.value.a;var e=a,f=(2-b)*c,g=b*c;return g/=f>0&&f<=1?f:2-f,f/=2,g>1&&(g=1),{h:isNaN(e)?0:e,s:isNaN(g)?0:g,l:isNaN(f)?0:f,a:isNaN(d)?0:d}},RGBtoHSB:function(a,b,c,d){a/=255,b/=255,c/=255;var e,f,g,h;return g=Math.max(a,b,c),h=g-Math.min(a,b,c),e=0===h?null:g===a?(b-c)/h:g===b?(c-a)/h+2:(a-b)/h+4,e=(e+360)%6*60/360,f=0===h?0:h/g,{h:this._sanitizeNumber(e),s:f,b:g,a:this._sanitizeNumber(d)}},HueToRGB:function(a,b,c){return c<0?c+=1:c>1&&(c-=1),6*c<1?a+(b-a)*c*6:2*c<1?b:3*c<2?a+(b-a)*(2/3-c)*6:a},HSLtoRGB:function(a,b,c,d){b<0&&(b=0);var e;e=c<=.5?c*(1+b):c+b-c*b;var f=2*c-e,g=a+1/3,h=a,i=a-1/3,j=Math.round(255*this.HueToRGB(f,e,g)),k=Math.round(255*this.HueToRGB(f,e,h)),l=Math.round(255*this.HueToRGB(f,e,i));return[j,k,l,this._sanitizeNumber(d)]},toString:function(a){a=a||"rgba";var c=!1;switch(a){case"rgb":return c=this.toRGB(),b.rgbaIsTransparent(c)?"transparent":"rgb("+c.r+","+c.g+","+c.b+")";case"rgba":return c=this.toRGB(),"rgba("+c.r+","+c.g+","+c.b+","+c.a+")";case"hsl":return c=this.toHSL(),"hsl("+Math.round(360*c.h)+","+Math.round(100*c.s)+"%,"+Math.round(100*c.l)+"%)";case"hsla":return c=this.toHSL(),"hsla("+Math.round(360*c.h)+","+Math.round(100*c.s)+"%,"+Math.round(100*c.l)+"%,"+c.a+")";case"hex":return this.toHex();default:return c}},stringParsers:[{re:/rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*?\)/,format:"rgb",parse:function(a){return[a[1],a[2],a[3],1]}},{re:/rgb\(\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*?\)/,format:"rgb",parse:function(a){return[2.55*a[1],2.55*a[2],2.55*a[3],1]}},{re:/rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d*(?:\.\d+)?)\s*)?\)/,format:"rgba",parse:function(a){return[a[1],a[2],a[3],a[4]]}},{re:/rgba\(\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*(?:,\s*(\d*(?:\.\d+)?)\s*)?\)/,format:"rgba",parse:function(a){return[2.55*a[1],2.55*a[2],2.55*a[3],a[4]]}},{re:/hsl\(\s*(\d*(?:\.\d+)?)\s*,\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*?\)/,format:"hsl",parse:function(a){return[a[1]/360,a[2]/100,a[3]/100,a[4]]}},{re:/hsla\(\s*(\d*(?:\.\d+)?)\s*,\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*(?:,\s*(\d*(?:\.\d+)?)\s*)?\)/,format:"hsla",parse:function(a){return[a[1]/360,a[2]/100,a[3]/100,a[4]]}},{re:/#?([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,format:"hex",parse:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16),1]}},{re:/#?([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,format:"hex",parse:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16),1]}}]},b.rgbaIsTransparent=function(a){return 0===a.r&&0===a.g&&0===a.b&&0===a.a},b.isTransparent=function(a){return!!a&&(a=a.toLowerCase().trim(),"transparent"===a||a.match(/#?00000000/)||a.match(/(rgba|hsla)\(0,0,0,0?\.?0\)/)||a.match(/(rgba|hsla)\(0, 0, 0, 0?\.?0\)/)||a.match(/hsl\(0,0%,0%\)/))},b.hslToRgb=function(a,b,c){var d,e,f;if(0==b)d=e=f=c;else{var g=function(a,b,c){return c<0&&(c+=1),c>1&&(c-=1),c<1/6?a+6*(b-a)*c:c<.5?b:c<2/3?a+(b-a)*(2/3-c)*6:a},h=c<.5?c*(1+b):c+b-c*b,i=2*c-h;d=g(i,h,a+1/3),e=g(i,h,a),f=g(i,h,a-1/3)}return[Math.round(255*d),Math.round(255*e),Math.round(255*f)];
},b.rbgToHsl=function(a,b,c){a/=255,b/=255,c/=255;var d,e,f=Math.max(a,b,c),g=Math.min(a,b,c),h=(f+g)/2;if(f==g)d=e=0;else{var i=f-g;switch(e=h>.5?i/(2-f-g):i/(f+g),f){case a:d=(b-c)/i+(b<c?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}return[d,e,h]};var c=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;b.rbg2Hex=function(b){var d=b;if(a(b)){for(var e=b,f="#",g=0;g<e.length;g++){var h=Number(e[g]).toString(16);"0"===h&&(h+=h),f+=h}return 7!==f.length&&(f=d),f}if(/^(rgb|RGB)/.test(d)){for(var e=d.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(","),f="#",g=0;g<e.length;g++){var h=Number(e[g]).toString(16);"0"===h&&(h+=h),f+=h}return 7!==f.length&&(f=d),f}if(!c.test(d))return d;var i=d.replace(/#/,"").split("");if(6===i.length)return d;if(3===i.length){for(var j="#",g=0;g<i.length;g+=1)j+=i[g]+i[g];return j}},b.hex2Rbg=function(a){var b=a.toLowerCase();if(b&&c.test(b)){if(4===b.length){for(var d="#",e=1;e<4;e+=1)d+=b.slice(e,e+1).concat(b.slice(e,e+1));b=d}for(var f=[],e=1;e<7;e+=2)f.push(parseInt("0x"+b.slice(e,e+2)));return f}return b},b.dark=function(a){var b=colorRgb(a),c=rgbToHsl(b[0],b[1],b[2]),d=hslToRgb(c[0],c[1],.8*c[2]),e=colorHex(d);return e},UI.Color=b}(),function(a){"use strict";"object"==typeof exports?module.exports=a(window.jQuery):"function"==typeof define&&define.amd?define(["jquery"],a):window.jQuery&&!window.jQuery.fn.colorpicker&&a(window.jQuery)}(function(a){"use strict";var b=UI.Color,c=function(d,e){if(this.element=a(d).addClass("colorpicker-element"),this.opts=a.extend({},c.DEFAULTS,this.element.data(),e),this.container=this.opts.container===!0?this.element:this.opts.container,this.container=this.container!==!1&&a(this.container),this.input=this.element.is("input")?this.element:!!this.opts.input&&this.element.find(this.opts.input),this.input&&0===this.input.length&&(this.input=!1),this.color=new b(this.opts.color!==!1?this.opts.color:this.getValue()),this.format=this.opts.format!==!1?this.opts.format:this.color.origFormat,this.input&&(this.input.css("width","33px"),this.value=this.input.val(),this.input.val(""),this.input.hide()),this.block=a('<div class="ui-color"></div>'),this.element.after(this.block),this.opts.color!==!1&&(this.updateInput(this.color),this.updateData(this.color)),this.picker=a(this.opts.template),this.opts.customClass&&this.picker.addClass(this.opts.customClass),this.opts.inline?this.picker.addClass("colorpicker-inline colorpicker-visible"):this.picker.addClass("colorpicker-hidden"),this.opts.horizontal&&this.picker.addClass("colorpicker-horizontal"),"rgba"!==this.format&&"hsla"!==this.format&&this.opts.format!==!1||this.picker.addClass("colorpicker-with-alpha"),"right"===this.opts.align&&this.picker.addClass("colorpicker-right"),this.opts.inline===!0&&this.picker.addClass("colorpicker-no-arrow"),this.opts.colorSelectors){var f=this;a.each(this.opts.colorSelectors,function(b,c){var d=a("<i />").css("background-color",c).data("class",b);d.click(function(){f.setValue(a(this).css("background-color"),!0)}),f.picker.find(".colorpicker-selectors").append(d)}),this.picker.find(".colorpicker-selectors").show()}this.picker.on("mousedown.colorpicker touchstart.colorpicker",a.proxy(this.mousedown,this)),this.picker.on("click",function(a){a.stopPropagation()}),this.picker.appendTo(this.container?this.container:a("body")),this.input!==!1&&(this.input.on({"keyup.colorpicker":a.proxy(this.keyup,this)}),this.input.on({"change.colorpicker":a.proxy(this.change,this)}),this.block.on({"click.colorpicker":a.proxy(this.show,this)})),this.update(),a(a.proxy(function(){this.element.trigger("create")},this))};c.DEFAULTS={horizontal:!1,inline:!1,color:!1,format:"hsl",input:"input",container:!1,sliders:{saturation:{maxLeft:100,maxTop:100,callLeft:"setSaturation",callTop:"setBrightness"},hue:{maxLeft:0,maxTop:100,callLeft:!1,callTop:"setHue"},alpha:{maxLeft:0,maxTop:100,callLeft:!1,callTop:"setAlpha"}},slidersHorz:{saturation:{maxLeft:100,maxTop:100,callLeft:"setSaturation",callTop:"setBrightness"},hue:{maxLeft:100,maxTop:0,callLeft:"setHue",callTop:!1},alpha:{maxLeft:100,maxTop:0,callLeft:"setAlpha",callTop:!1}},template:'<div class="colorpicker dropdown-menu"><div class="colorpicker-saturation"><i><b></b></i></div><div class="colorpicker-hue"><i></i></div><div class="colorpicker-alpha"><i></i></div><div class="colorpicker-color"><div /></div><div class="colorpicker-selectors"></div></div>',align:"right",customClass:null,colorSelectors:null},c.Color=b,c.prototype={constructor:c,destroy:function(){this.picker.remove(),this.element.removeData("colorpicker","color").off(".colorpicker"),this.input!==!1&&this.input.off(".colorpicker"),this.element.removeClass("colorpicker-element"),this.element.trigger({type:"destroy"})},reposition:function(){if(this.opts.inline!==!1||this.opts.container)return!1;var a=this.container&&this.container[0]!==document.body?"position":"offset",b=this.block,c=b[a]();"right"===this.opts.align&&(c.left-=this.picker.outerWidth()-b.outerWidth()),this.picker.pot({relativeTo:this.block,y:"bottom",x:"rightEdge",zIndex:1e4})},show:function(b){if(this.isDisabled())return!1;this.isShow=!0,this.picker.addClass("colorpicker-visible").removeClass("colorpicker-hidden"),this.reposition(),a(window).on("resize.colorpicker",a.proxy(this.reposition,this)),!b||this.hasInput()&&"color"!==this.input.attr("type")||b.stopPropagation&&b.preventDefault&&(b.stopPropagation(),b.preventDefault()),this.element.trigger({type:"showPicker",color:this.color});var c=this;setTimeout(function(){a(document).one("click.ui.color",function(a){c.isShow&&c.hide()})},100)},hide:function(){this.isShow=!1,this.picker.addClass("colorpicker-hidden").removeClass("colorpicker-visible"),a(window).off("resize.colorpicker",this.reposition),a(document).off({"mousedown.colorpicker":this.hide}),this.update(),this.element.trigger({type:"hidePicker",color:this.color}),a(document).off("click.ui.color")},updateData:function(a){return a=a||this.color.toString(this.format),this.element.data("color",a),a},updateInput:function(a){if(a=a||this.color.toString(this.format),this.input!==!1&&this.opts.colorSelectors){new b(a)}return b.isTransparent(a)?(this.block.css("background-color","transparent"),this.block.addClass("colorpicker-transparent")):(this.block.removeClass("colorpicker-transparent"),this.block.css("background-color",a)),a},updatePicker:function(c){void 0!==c&&(this.color=new b(c));var d=this.opts.horizontal===!1?this.opts.sliders:this.opts.slidersHorz,e=this.picker.find("i");if(0!==e.length)return this.opts.horizontal===!1?(d=this.opts.sliders,e.eq(1).css("top",d.hue.maxTop*(1-this.color.value.h)).end().eq(2).css("top",d.alpha.maxTop*(1-this.color.value.a))):(d=this.opts.slidersHorz,e.eq(1).css("left",d.hue.maxLeft*(1-this.color.value.h)).end().eq(2).css("left",d.alpha.maxLeft*(1-this.color.value.a))),e.eq(0).css({top:d.saturation.maxTop-this.color.value.b*d.saturation.maxTop,left:this.color.value.s*d.saturation.maxLeft}),this.picker.find(".colorpicker-saturation").css("backgroundColor",this.color.toHex(this.color.value.h,1,1,1)),this.picker.find(".colorpicker-alpha").css("backgroundColor",this.color.toHex()),this.opts.preview?a(this.opts.preview).css("backgroundColor",this.color.toString(this.format)):this.picker.find(".colorpicker-color, .colorpicker-color div").css("backgroundColor",this.color.toString(this.format)),c},updateComponent:function(a){return a=a||this.color.toString(this.format)},update:function(a){var b;return this.getValue(!1)===!1&&a!==!0||(b=this.updateComponent(),this.updateInput(b),this.updateData(b),this.updatePicker()),b},setColor:function(a){this.color=a,this.update(!0),this.element.trigger({type:"changeColor",color:this.color})},setValue:function(a,c){this.color=new b(a),this.update(!0),c&&this.element.trigger({type:"changeColor",color:this.color})},getValue:function(a){a=void 0===a?"#000000":a;var b;return b=this.hasInput()?this.value:this.element.data("color"),void 0!==b&&""!==b&&null!==b||(b=a),b},hasInput:function(){return this.input!==!1},isDisabled:function(){return!!this.hasInput()&&this.input.prop("disabled")===!0},disable:function(){return!!this.hasInput()&&(this.input.prop("disabled",!0),this.element.trigger({type:"disable",color:this.color,value:this.getValue()}),!0)},enable:function(){return!!this.hasInput()&&(this.input.prop("disabled",!1),this.element.trigger({type:"enable",color:this.color,value:this.getValue()}),!0)},currentSlider:null,mousePointer:{left:0,top:0},mousedown:function(b){!b.pageX&&!b.pageY&&b.originalEvent&&b.originalEvent.touches&&(b.pageX=b.originalEvent.touches[0].pageX,b.pageY=b.originalEvent.touches[0].pageY),b.stopPropagation(),b.preventDefault();var c=a(b.target),d=c.closest("div"),e=this.opts.horizontal?this.opts.slidersHorz:this.opts.sliders;if(!d.is(".colorpicker")){if(d.is(".colorpicker-saturation"))this.currentSlider=a.extend({},e.saturation);else if(d.is(".colorpicker-hue"))this.currentSlider=a.extend({},e.hue);else{if(!d.is(".colorpicker-alpha"))return!1;this.currentSlider=a.extend({},e.alpha)}var f=d.offset();this.currentSlider.guide=d.find("i")[0].style,this.currentSlider.left=b.pageX-f.left,this.currentSlider.top=b.pageY-f.top,this.mousePointer={left:b.pageX,top:b.pageY},a(document).on({"mousemove.colorpicker":a.proxy(this.mousemove,this),"touchmove.colorpicker":a.proxy(this.mousemove,this),"mouseup.colorpicker":a.proxy(this.mouseup,this),"touchend.colorpicker":a.proxy(this.mouseup,this)}).trigger("mousemove")}return!1},mousemove:function(a){!a.pageX&&!a.pageY&&a.originalEvent&&a.originalEvent.touches&&(a.pageX=a.originalEvent.touches[0].pageX,a.pageY=a.originalEvent.touches[0].pageY),a.stopPropagation(),a.preventDefault();var b=Math.max(0,Math.min(this.currentSlider.maxLeft,this.currentSlider.left+((a.pageX||this.mousePointer.left)-this.mousePointer.left))),c=Math.max(0,Math.min(this.currentSlider.maxTop,this.currentSlider.top+((a.pageY||this.mousePointer.top)-this.mousePointer.top)));return this.currentSlider.guide.left=b+"px",this.currentSlider.guide.top=c+"px",this.currentSlider.callLeft&&this.color[this.currentSlider.callLeft].call(this.color,b/this.currentSlider.maxLeft),this.currentSlider.callTop&&this.color[this.currentSlider.callTop].call(this.color,1-c/this.currentSlider.maxTop),"setAlpha"===this.currentSlider.callTop&&this.opts.format===!1&&(1!==this.color.value.a?(this.format="rgba",this.color.origFormat="rgba"):(this.format="hex",this.color.origFormat="hex")),this.update(!0),this.element.trigger({type:"changeColor",color:this.color}),!1},mouseup:function(b){return b.stopPropagation(),b.preventDefault(),a(document).off({"mousemove.colorpicker":this.mousemove,"touchmove.colorpicker":this.mousemove,"mouseup.colorpicker":this.mouseup,"touchend.colorpicker":this.mouseup}),!1},change:function(a){this.block.css("background-color",this.color.toHex()),this.keyup(a)},keyup:function(a){38===a.keyCode?(this.color.value.a<1&&(this.color.value.a=Math.round(100*(this.color.value.a+.01))/100),this.update(!0)):40===a.keyCode?(this.color.value.a>0&&(this.color.value.a=Math.round(100*(this.color.value.a-.01))/100),this.update(!0)):(this.color=new b(this.value),this.color.origFormat&&this.opts.format===!1&&(this.format=this.color.origFormat),this.getValue(!1)!==!1&&(this.updateData(),this.updateComponent(),this.updatePicker())),this.element.trigger({type:"changeColor",color:this.color})}},a.colorpicker=c,a.fn.colorpicker=function(b,d){var e=arguments,f=null,g=this.each(function(){var d=a(this),g=d.data("colorpicker");if(!g){var h="object"==typeof b?b:{};g=new c(this,h),d.data("colorpicker",g)}if("string"==typeof b){var i=Array.prototype.slice.call(e,1);f=g[b].apply(g,i)}});return"getValue"===b?f:g},a.fn.colorpicker.constructor=c}),!function(a,b){"function"==typeof define&&define.amd?define(function(){return b(a,a.document)}):"object"==typeof exports?module.exports=a.document?b(a,a.document):function(a){return b(a,a.document)}:a.SVG=b(a,a.document)}("undefined"!=typeof window?window:this,function(a,b){function c(a,b){return a instanceof b}function d(a,b){return(a.matches||a.matchesSelector||a.msMatchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.oMatchesSelector).call(a,b)}function e(a){return a.toLowerCase().replace(/-(.)/g,function(a,b){return b.toUpperCase()})}function f(a){return a.charAt(0).toUpperCase()+a.slice(1)}function g(a){return 4==a.length?["#",a.substring(1,2),a.substring(1,2),a.substring(2,3),a.substring(2,3),a.substring(3,4),a.substring(3,4)].join(""):a}function h(a){var b=a.toString(16);return 1==b.length?"0"+b:b}function i(a,b,c){if(null==b||null==c){var d=a.bbox();null==b?b=d.width/d.height*c:null==c&&(c=d.height/d.width*b)}return{width:b,height:c}}function j(a,b,c){return{x:b*a.a+c*a.c+0,y:b*a.b+c*a.d+0}}function k(a){return{a:a[0],b:a[1],c:a[2],d:a[3],e:a[4],f:a[5]}}function l(a){return a instanceof s.Matrix||(a=new s.Matrix(a)),a}function m(a,b){a.cx=null==a.cx?b.bbox().cx:a.cx,a.cy=null==a.cy?b.bbox().cy:a.cy}function n(a){return a=a.replace(s.regex.whitespace,"").replace(s.regex.matrix,"").split(s.regex.matrixElements),k(s.utils.map(a,function(a){return parseFloat(a)}))}function o(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b][0],null!=a[b][1]&&(d+=a[b][1],null!=a[b][2]&&(d+=" ",d+=a[b][2],null!=a[b][3]&&(d+=" ",d+=a[b][3],d+=" ",d+=a[b][4],null!=a[b][5]&&(d+=" ",d+=a[b][5],d+=" ",d+=a[b][6],null!=a[b][7]&&(d+=" ",d+=a[b][7])))));return d+" "}function p(a){for(var b=a.childNodes.length-1;b>=0;b--)a.childNodes[b]instanceof SVGElement&&p(a.childNodes[b]);return s.adopt(a).id(s.eid(a.nodeName))}function q(a){return null==a.x&&(a.x=0,a.y=0,a.width=0,a.height=0),a.w=a.width,a.h=a.height,a.x2=a.x+a.width,a.y2=a.y+a.height,a.cx=a.x+a.width/2,a.cy=a.y+a.height/2,a}function r(a){var b=a.toString().match(s.regex.reference);return b?b[1]:void 0}var s=this.SVG=function(a){return s.supported?(a=new s.Doc(a),s.parser.draw||s.prepare(),a):void 0};if(s.ns="http://www.w3.org/2000/svg",s.xmlns="http://www.w3.org/2000/xmlns/",s.xlink="http://www.w3.org/1999/xlink",s.svgjs="http://svgjs.com/svgjs",s.supported=function(){return!!b.createElementNS&&!!b.createElementNS(s.ns,"svg").createSVGRect}(),!s.supported)return!1;s.did=1e3,s.eid=function(a){return"Svgjs"+f(a)+s.did++},s.create=function(a){var c=b.createElementNS(this.ns,a);return c.setAttribute("id",this.eid(a)),c},s.extend=function(){var a,b,c,d;for(a=[].slice.call(arguments),b=a.pop(),d=a.length-1;d>=0;d--)if(a[d])for(c in b)a[d].prototype[c]=b[c];s.Set&&s.Set.inherit&&s.Set.inherit()},s.invent=function(a){var b="function"==typeof a.create?a.create:function(){this.constructor.call(this,s.create(a.create))};return a.inherit&&(b.prototype=new a.inherit),a.extend&&s.extend(b,a.extend),a.construct&&s.extend(a.parent||s.Container,a.construct),b},s.adopt=function(a){if(!a)return null;if(a.instance)return a.instance;var b;return b="svg"==a.nodeName?a.parentNode instanceof SVGElement?new s.Nested:new s.Doc:"linearGradient"==a.nodeName?new s.Gradient("linear"):"radialGradient"==a.nodeName?new s.Gradient("radial"):s[f(a.nodeName)]?new(s[f(a.nodeName)]):new s.Element(a),b.type=a.nodeName,b.node=a,a.instance=b,b instanceof s.Doc&&b.namespace().defs(),b.setData(JSON.parse(a.getAttribute("svgjs:data"))||{}),b},s.prepare=function(){var a=b.getElementsByTagName("body")[0],c=(a?new s.Doc(a):new s.Doc(b.documentElement).nested()).size(2,0);s.parser={body:a||b.documentElement,draw:c.style("opacity:0;position:fixed;left:100%;top:100%;overflow:hidden"),poly:c.polyline().node,path:c.path().node,"native":s.create("svg")}},s.parser={"native":s.create("svg")},b.addEventListener("DOMContentLoaded",function(){s.parser.draw||s.prepare()},!1),s.regex={numberAndUnit:/^([+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?)([a-z%]*)$/i,hex:/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,rgb:/rgb\((\d+),(\d+),(\d+)\)/,reference:/#([a-z0-9\-_]+)/i,matrix:/matrix\(|\)/g,matrixElements:/,*\s+|,/,whitespace:/\s/g,isHex:/^#[a-f0-9]{3,6}$/i,isRgb:/^rgb\(/,isCss:/[^:]+:[^;]+;?/,isBlank:/^(\s+)?$/,isNumber:/^[+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,isPercent:/^-?[\d\.]+%$/,isImage:/\.(jpg|jpeg|png|gif|svg)(\?[^=]+.*)?/i,negExp:/e\-/gi,comma:/,/g,hyphen:/\-/g,pathLetters:/[MLHVCSQTAZ]/gi,isPathLetter:/[MLHVCSQTAZ]/i,whitespaces:/\s+/,X:/X/g},s.utils={map:function(a,b){var c,d=a.length,e=[];for(c=0;d>c;c++)e.push(b(a[c]));return e},filter:function(a,b){var c,d=a.length,e=[];for(c=0;d>c;c++)b(a[c])&&e.push(a[c]);return e},radians:function(a){return a%360*Math.PI/180},degrees:function(a){return 180*a/Math.PI%360},filterSVGElements:function(a){return this.filter(a,function(a){return a instanceof SVGElement})}},s.defaults={attrs:{"fill-opacity":1,"stroke-opacity":1,"stroke-width":0,"stroke-linejoin":"miter","stroke-linecap":"butt",fill:"#000000",stroke:"#000000",opacity:1,x:0,y:0,cx:0,cy:0,width:0,height:0,r:0,rx:0,ry:0,offset:0,"stop-opacity":1,"stop-color":"#000000","font-size":16,"font-family":"Helvetica, Arial, sans-serif","text-anchor":"start"}},s.Color=function(a){var b;this.r=0,this.g=0,this.b=0,a&&("string"==typeof a?s.regex.isRgb.test(a)?(b=s.regex.rgb.exec(a.replace(/\s/g,"")),this.r=parseInt(b[1]),this.g=parseInt(b[2]),this.b=parseInt(b[3])):s.regex.isHex.test(a)&&(b=s.regex.hex.exec(g(a)),this.r=parseInt(b[1],16),this.g=parseInt(b[2],16),this.b=parseInt(b[3],16)):"object"==typeof a&&(this.r=a.r,this.g=a.g,this.b=a.b))},s.extend(s.Color,{toString:function(){return this.toHex()},toHex:function(){return"#"+h(this.r)+h(this.g)+h(this.b)},toRgb:function(){return"rgb("+[this.r,this.g,this.b].join()+")"},brightness:function(){return this.r/255*.3+this.g/255*.59+this.b/255*.11},morph:function(a){return this.destination=new s.Color(a),this},at:function(a){return this.destination?(a=0>a?0:a>1?1:a,new s.Color({r:~~(this.r+(this.destination.r-this.r)*a),g:~~(this.g+(this.destination.g-this.g)*a),b:~~(this.b+(this.destination.b-this.b)*a)})):this}}),s.Color.test=function(a){return a+="",s.regex.isHex.test(a)||s.regex.isRgb.test(a)},s.Color.isRgb=function(a){return a&&"number"==typeof a.r&&"number"==typeof a.g&&"number"==typeof a.b},s.Color.isColor=function(a){return s.Color.isRgb(a)||s.Color.test(a)},s.Array=function(a,b){a=(a||[]).valueOf(),0==a.length&&b&&(a=b.valueOf()),this.value=this.parse(a)},s.extend(s.Array,{morph:function(a){if(this.destination=this.parse(a),this.value.length!=this.destination.length){for(var b=this.value[this.value.length-1],c=this.destination[this.destination.length-1];this.value.length>this.destination.length;)this.destination.push(c);for(;this.value.length<this.destination.length;)this.value.push(b)}return this},settle:function(){for(var a=0,b=this.value.length,c=[];b>a;a++)-1==c.indexOf(this.value[a])&&c.push(this.value[a]);return this.value=c},at:function(a){if(!this.destination)return this;for(var b=0,c=this.value.length,d=[];c>b;b++)d.push(this.value[b]+(this.destination[b]-this.value[b])*a);return new s.Array(d)},toString:function(){return this.value.join(" ")},valueOf:function(){return this.value},parse:function(a){return a=a.valueOf(),Array.isArray(a)?a:this.split(a)},split:function(a){return a.trim().split(/\s+/)},reverse:function(){return this.value.reverse(),this}}),s.PointArray=function(a,b){this.constructor.call(this,a,b||[[0,0]])},s.PointArray.prototype=new s.Array,s.extend(s.PointArray,{toString:function(){for(var a=0,b=this.value.length,c=[];b>a;a++)c.push(this.value[a].join(","));return c.join(" ")},toLine:function(){return{x1:this.value[0][0],y1:this.value[0][1],x2:this.value[1][0],y2:this.value[1][1]}},at:function(a){if(!this.destination)return this;for(var b=0,c=this.value.length,d=[];c>b;b++)d.push([this.value[b][0]+(this.destination[b][0]-this.value[b][0])*a,this.value[b][1]+(this.destination[b][1]-this.value[b][1])*a]);return new s.PointArray(d)},parse:function(a){if(a=a.valueOf(),Array.isArray(a))return a;a=this.split(a);for(var b,c=0,d=a.length,e=[];d>c;c++)b=a[c].split(","),e.push([parseFloat(b[0]),parseFloat(b[1])]);return e},move:function(a,b){var c=this.bbox();if(a-=c.x,b-=c.y,!isNaN(a)&&!isNaN(b))for(var d=this.value.length-1;d>=0;d--)this.value[d]=[this.value[d][0]+a,this.value[d][1]+b];return this},size:function(a,b){var c,d=this.bbox();for(c=this.value.length-1;c>=0;c--)this.value[c][0]=(this.value[c][0]-d.x)*a/d.width+d.x,this.value[c][1]=(this.value[c][1]-d.y)*b/d.height+d.y;return this},bbox:function(){return s.parser.poly.setAttribute("points",this.toString()),s.parser.poly.getBBox()}}),s.PathArray=function(a,b){this.constructor.call(this,a,b||[["M",0,0]])},s.PathArray.prototype=new s.Array,s.extend(s.PathArray,{toString:function(){return o(this.value)},move:function(a,b){var c=this.bbox();if(a-=c.x,b-=c.y,!isNaN(a)&&!isNaN(b))for(var d,e=this.value.length-1;e>=0;e--)d=this.value[e][0],"M"==d||"L"==d||"T"==d?(this.value[e][1]+=a,this.value[e][2]+=b):"H"==d?this.value[e][1]+=a:"V"==d?this.value[e][1]+=b:"C"==d||"S"==d||"Q"==d?(this.value[e][1]+=a,this.value[e][2]+=b,this.value[e][3]+=a,this.value[e][4]+=b,"C"==d&&(this.value[e][5]+=a,this.value[e][6]+=b)):"A"==d&&(this.value[e][6]+=a,this.value[e][7]+=b);return this},size:function(a,b){var c,d,e=this.bbox();for(c=this.value.length-1;c>=0;c--)d=this.value[c][0],"M"==d||"L"==d||"T"==d?(this.value[c][1]=(this.value[c][1]-e.x)*a/e.width+e.x,this.value[c][2]=(this.value[c][2]-e.y)*b/e.height+e.y):"H"==d?this.value[c][1]=(this.value[c][1]-e.x)*a/e.width+e.x:"V"==d?this.value[c][1]=(this.value[c][1]-e.y)*b/e.height+e.y:"C"==d||"S"==d||"Q"==d?(this.value[c][1]=(this.value[c][1]-e.x)*a/e.width+e.x,this.value[c][2]=(this.value[c][2]-e.y)*b/e.height+e.y,this.value[c][3]=(this.value[c][3]-e.x)*a/e.width+e.x,this.value[c][4]=(this.value[c][4]-e.y)*b/e.height+e.y,"C"==d&&(this.value[c][5]=(this.value[c][5]-e.x)*a/e.width+e.x,this.value[c][6]=(this.value[c][6]-e.y)*b/e.height+e.y)):"A"==d&&(this.value[c][1]=this.value[c][1]*a/e.width,this.value[c][2]=this.value[c][2]*b/e.height,this.value[c][6]=(this.value[c][6]-e.x)*a/e.width+e.x,this.value[c][7]=(this.value[c][7]-e.y)*b/e.height+e.y);return this},parse:function(a){if(a instanceof s.PathArray)return a.valueOf();var b,c,d,e,f,g,h=0,i=0,j={M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7};if("string"==typeof a){for(a=a.replace(s.regex.negExp,"X").replace(s.regex.pathLetters," $& ").replace(s.regex.hyphen," -").replace(s.regex.comma," ").replace(s.regex.X,"e-").trim().split(s.regex.whitespaces),b=a.length;--b;)if(a[b].indexOf(".")!=a[b].lastIndexOf(".")){var k=a[b].split("."),l=[k.shift(),k.shift()].join(".");a.splice.apply(a,[b,1].concat(l,k.map(function(a){return"."+a})))}}else a=a.reduce(function(a,b){return[].concat.apply(a,b)},[]);var g=[];do{for(s.regex.isPathLetter.test(a[0])?(e=a[0],a.shift()):"M"==e?e="L":"m"==e&&(e="l"),f=[e.toUpperCase()],b=0;b<j[f[0]];++b)f.push(parseFloat(a.shift()));e==f[0]?"M"==e||"L"==e||"C"==e||"Q"==e||"S"==e||"T"==e?(h=f[j[f[0]]-1],i=f[j[f[0]]]):"V"==e?i=f[1]:"H"==e?h=f[1]:"A"==e&&(h=f[6],i=f[7]):"m"==e||"l"==e||"c"==e||"s"==e||"q"==e||"t"==e?(f[1]+=h,f[2]+=i,null!=f[3]&&(f[3]+=h,f[4]+=i),null!=f[5]&&(f[5]+=h,f[6]+=i),h=f[j[f[0]]-1],i=f[j[f[0]]]):"v"==e?(f[1]+=i,i=f[1]):"h"==e?(f[1]+=h,h=f[1]):"a"==e&&(f[6]+=h,f[7]+=i,h=f[6],i=f[7]),"M"==f[0]&&(c=h,d=i),"Z"==f[0]&&(h=c,i=d),g.push(f)}while(a.length);return g},bbox:function(){return s.parser.path.setAttribute("d",this.toString()),s.parser.path.getBBox()}}),s.Number=s.invent({create:function(a,b){this.value=0,this.unit=b||"","number"==typeof a?this.value=isNaN(a)?0:isFinite(a)?a:0>a?-3.4e38:3.4e38:"string"==typeof a?(b=a.match(s.regex.numberAndUnit),b&&(this.value=parseFloat(b[1]),"%"==b[5]?this.value/=100:"s"==b[5]&&(this.value*=1e3),this.unit=b[5])):a instanceof s.Number&&(this.value=a.valueOf(),this.unit=a.unit)},extend:{toString:function(){return("%"==this.unit?~~(1e8*this.value)/1e6:"s"==this.unit?this.value/1e3:this.value)+this.unit},toJSON:function(){return this.toString()},valueOf:function(){return this.value},plus:function(a){return new s.Number(this+new s.Number(a),this.unit)},minus:function(a){return this.plus(-new s.Number(a))},times:function(a){return new s.Number(this*new s.Number(a),this.unit)},divide:function(a){return new s.Number(this/new s.Number(a),this.unit)},to:function(a){var b=new s.Number(this);return"string"==typeof a&&(b.unit=a),b},morph:function(a){return this.destination=new s.Number(a),this},at:function(a){return this.destination?new s.Number(this.destination).minus(this).times(a).plus(this):this}}}),s.Element=s.invent({create:function(a){this._stroke=s.defaults.attrs.stroke,this.dom={},(this.node=a)&&(this.type=a.nodeName,this.node.instance=this,this._stroke=a.getAttribute("stroke")||this._stroke)},extend:{x:function(a){return this.attr("x",a)},y:function(a){return this.attr("y",a)},cx:function(a){return null==a?this.x()+this.width()/2:this.x(a-this.width()/2)},cy:function(a){return null==a?this.y()+this.height()/2:this.y(a-this.height()/2)},move:function(a,b){return this.x(a).y(b)},center:function(a,b){return this.cx(a).cy(b)},width:function(a){return this.attr("width",a)},height:function(a){return this.attr("height",a)},size:function(a,b){var c=i(this,a,b);return this.width(new s.Number(c.width)).height(new s.Number(c.height))},clone:function(a){var b=p(this.node.cloneNode(!0));return a?a.add(b):this.after(b),b},remove:function(){return this.parent()&&this.parent().removeElement(this),this},replace:function(a){return this.after(a).remove(),a},addTo:function(a){return a.put(this)},putIn:function(a){return a.add(this)},id:function(a){return this.attr("id",a)},inside:function(a,b){var c=this.bbox();return a>c.x&&b>c.y&&a<c.x+c.width&&b<c.y+c.height},show:function(){return this.style("display","")},hide:function(){return this.style("display","none")},visible:function(){return"none"!=this.style("display")},toString:function(){return this.attr("id")},classes:function(){var a=this.attr("class");return null==a?[]:a.trim().split(/\s+/)},hasClass:function(a){return-1!=this.classes().indexOf(a)},addClass:function(a){if(!this.hasClass(a)){var b=this.classes();b.push(a),this.attr("class",b.join(" "))}return this},removeClass:function(a){return this.hasClass(a)&&this.attr("class",this.classes().filter(function(b){return b!=a}).join(" ")),this},toggleClass:function(a){return this.hasClass(a)?this.removeClass(a):this.addClass(a)},reference:function(a){return s.get(this.attr(a))},parent:function(a){var b=this;if(!b.node.parentNode)return null;if(b=s.adopt(b.node.parentNode),!a)return b;for(;b&&b.node instanceof SVGElement;){if("string"==typeof a?b.matches(a):b instanceof a)return b;b=s.adopt(b.node.parentNode)}},doc:function(){return this instanceof s.Doc?this:this.parent(s.Doc)},parents:function(a){var b=[],c=this;do{if(c=c.parent(a),!c||!c.node)break;b.push(c)}while(c.parent);return b},matches:function(a){return d(this.node,a)},"native":function(){return this.node},svg:function(a){var c=b.createElement("svg");if(!(a&&this instanceof s.Parent))return c.appendChild(a=b.createElement("svg")),this.writeDataToDom(),a.appendChild(this.node.cloneNode(!0)),c.innerHTML.replace(/^<svg>/,"").replace(/<\/svg>$/,"");c.innerHTML="<svg>"+a.replace(/\n/,"").replace(/<(\w+)([^<]+?)\/>/g,"<$1$2></$1>")+"</svg>";for(var d=0,e=c.firstChild.childNodes.length;e>d;d++)this.node.appendChild(c.firstChild.firstChild);return this},writeDataToDom:function(){if(this.each||this.lines){var a=this.each?this:this.lines();a.each(function(){this.writeDataToDom()})}return this.node.removeAttribute("svgjs:data"),Object.keys(this.dom).length&&this.node.setAttribute("svgjs:data",JSON.stringify(this.dom)),this},setData:function(a){return this.dom=a,this},is:function(a){return c(this,a)}}}),s.easing={"-":function(a){return a},"<>":function(a){return-Math.cos(a*Math.PI)/2+.5},">":function(a){return Math.sin(a*Math.PI/2)},"<":function(a){return-Math.cos(a*Math.PI/2)+1}},s.morph=function(a){return function(b,c){return new s.MorphObj(b,c).at(a)}},s.Situation=s.invent({create:function(a){this.init=!1,this.reversed=!1,this.reversing=!1,this.duration=new s.Number(a.duration).valueOf(),this.delay=new s.Number(a.delay).valueOf(),this.start=+new Date+this.delay,this.finish=this.start+this.duration,this.ease=a.ease,this.loop=!1,this.loops=!1,this.animations={},this.attrs={},this.styles={},this.transforms=[],this.once={}}}),s.Delay=function(a){this.delay=new s.Number(a).valueOf()},s.FX=s.invent({create:function(a){this._target=a,this.situations=[],this.active=!1,this.situation=null,this.paused=!1,this.lastPos=0,this.pos=0},extend:{animate:function(a,b,c){"object"==typeof a&&(b=a.ease,c=a.delay,a=a.duration);var d=new s.Situation({duration:a||1e3,delay:c||0,ease:s.easing[b||"-"]||b});return this.queue(d),this},delay:function(a){var a=new s.Delay(a);return this.queue(a)},target:function(a){return a&&a instanceof s.Element?(this._target=a,this):this._target},timeToPos:function(a){return(a-this.situation.start)/this.situation.duration},posToTime:function(a){return this.situation.duration*a+this.situation.start},startAnimFrame:function(){this.stopAnimFrame(),this.animationFrame=requestAnimationFrame(function(){this.step()}.bind(this))},stopAnimFrame:function(){cancelAnimationFrame(this.animationFrame)},start:function(){return!this.active&&this.situation&&(this.situation.start=+new Date+this.situation.delay,this.situation.finish=this.situation.start+this.situation.duration,this.initAnimations(),this.active=!0,this.startAnimFrame()),this},queue:function(a){return("function"==typeof a||a instanceof s.Situation||a instanceof s.Delay)&&this.situations.push(a),this.situation||(this.situation=this.situations.shift()),this},dequeue:function(){if(this.situation&&this.situation.stop&&this.situation.stop(),this.situation=this.situations.shift(),this.situation){var a=function(){this.situation instanceof s.Situation?this.initAnimations().at(0):this.situation instanceof s.Delay?this.dequeue():this.situation.call(this)}.bind(this);this.situation.delay?setTimeout(function(){a()},this.situation.delay):a()}return this},initAnimations:function(){var a,b=this.situation;if(b.init)return this;for(a in b.animations)"viewbox"==a?b.animations[a]=this.target().viewbox().morph(b.animations[a]):(b.animations[a].value="plot"==a?this.target().array().value:this.target()[a](),b.animations[a].value.value&&(b.animations[a].value=b.animations[a].value.value),b.animations[a].relative&&(b.animations[a].destination.value=b.animations[a].destination.value+b.animations[a].value));for(a in b.attrs)if(b.attrs[a]instanceof s.Color){var c=new s.Color(this.target().attr(a));b.attrs[a].r=c.r,b.attrs[a].g=c.g,b.attrs[a].b=c.b}else b.attrs[a].value=this.target().attr(a);for(a in b.styles)b.styles[a].value=this.target().style(a);return b.initialTransformation=this.target().matrixify(),b.init=!0,this},clearQueue:function(){return this.situations=[],this},clearCurrent:function(){return this.situation=null,this},stop:function(a,b){return this.active||this.start(),b&&this.clearQueue(),this.active=!1,a&&this.situation&&(this.situation.loop=!1,this.situation.loops%2==0&&this.situation.reversing&&(this.situation.reversed=!0),this.at(1)),this.stopAnimFrame(),clearTimeout(this.timeout),this.clearCurrent()},reset:function(){if(this.situation){var a=this.situation;this.stop(),this.situation=a,this.at(0)}return this},finish:function(){for(this.stop(!0,!1);this.dequeue().situation&&this.stop(!0,!1););return this.clearQueue().clearCurrent(),this},at:function(a){return this.pos=a,this.situation.start=+new Date-a*this.situation.duration,this.situation.finish=this.situation.start+this.situation.duration,this.step(!0)},speed:function(a){return this.situation.duration=this.situation.duration*this.pos+(1-this.pos)*this.situation.duration/a,this.situation.finish=this.situation.start+this.situation.duration,this.at(this.pos)},loop:function(a,b){return this.situation.loop=this.situation.loops=a||!0,b&&(this.last().reversing=!0),this},pause:function(){return this.paused=!0,this.stopAnimFrame(),clearTimeout(this.timeout),this},play:function(){return this.paused?(this.paused=!1,this.at(this.pos)):this},reverse:function(a){var b=this.last();
return b.reversed="undefined"==typeof a?!b.reversed:a,this},progress:function(a){return a?this.situation.ease(this.pos):this.pos},after:function(a){var b=this.last(),c=function d(c){c.detail.situation==b&&(a.call(this,b),this.off("finished.fx",d))};return this.target().on("finished.fx",c),this},during:function(a){var b=this.last(),c=function(c){c.detail.situation==b&&a.call(this,c.detail.pos,s.morph(c.detail.pos),c.detail.eased,b)};return this.target().off("during.fx",c).on("during.fx",c),this.after(function(){this.off("during.fx",c)})},afterAll:function(a){var b=function c(){a.call(this),this.off("allfinished.fx",c)};return this.target().off("allfinished.fx",b).on("allfinished.fx",b),this},duringAll:function(a){var b=function(b){a.call(this,b.detail.pos,s.morph(b.detail.pos),b.detail.eased,b.detail.situation)};return this.target().off("during.fx",b).on("during.fx",b),this.afterAll(function(){this.off("during.fx",b)})},last:function(){return this.situations.length?this.situations[this.situations.length-1]:this.situation},add:function(a,b,c){return this.last()[c||"animations"][a]=b,setTimeout(function(){this.start()}.bind(this),0),this},step:function(a){if(a||(this.pos=this.timeToPos(+new Date)),this.pos>=1&&(this.situation.loop===!0||"number"==typeof this.situation.loop&&--this.situation.loop))return this.situation.reversing&&(this.situation.reversed=!this.situation.reversed),this.at(this.pos-1);this.situation.reversed&&(this.pos=1-this.pos),this.pos>1&&(this.pos=1),this.pos<0&&(this.pos=0);var b=this.situation.ease(this.pos);for(var c in this.situation.once)c>this.lastPos&&b>=c&&(this.situation.once[c].call(this.target(),this.pos,b),delete this.situation.once[c]);return this.active&&this.target().fire("during",{pos:this.pos,eased:b,fx:this,situation:this.situation}),this.situation?(this.eachAt(),1==this.pos&&!this.situation.reversed||this.situation.reversed&&0==this.pos?(this.stopAnimFrame(),this.target().fire("finished",{fx:this,situation:this.situation}),this.situations.length||(this.target().fire("allfinished"),this.target().off(".fx"),this.active=!1),this.active?this.dequeue():this.clearCurrent()):!this.paused&&this.active&&this.startAnimFrame(),this.lastPos=b,this):this},eachAt:function(){var a,b,c=this,d=this.target(),e=this.situation;for(a in e.animations)b=[].concat(e.animations[a]).map(function(a){return a.at?a.at(e.ease(c.pos),c.pos):a}),d[a].apply(d,b);for(a in e.attrs)b=[a].concat(e.attrs[a]).map(function(a){return a.at?a.at(e.ease(c.pos),c.pos):a}),d.attr.apply(d,b);for(a in e.styles)b=[a].concat(e.styles[a]).map(function(a){return a.at?a.at(e.ease(c.pos),c.pos):a}),d.style.apply(d,b);if(e.transforms.length){b=e.initialTransformation;for(a in e.transforms){var f=e.transforms[a];f instanceof s.Matrix?b=f.relative?b.multiply(f.at(e.ease(this.pos))):b.morph(f).at(e.ease(this.pos)):(f.relative||f.undo(b.extract()),b=b.multiply(f.at(e.ease(this.pos))))}d.matrix(b)}return this},once:function(a,b,c){return c||(a=this.situation.ease(a)),this.situation.once[a]=b,this}},parent:s.Element,construct:{animate:function(a,b,c){return(this.fx||(this.fx=new s.FX(this))).animate(a,b,c)},delay:function(a){return(this.fx||(this.fx=new s.FX(this))).delay(a)},stop:function(a,b){return this.fx&&this.fx.stop(a,b),this},finish:function(){return this.fx&&this.fx.finish(),this},pause:function(){return this.fx&&this.fx.pause(),this},play:function(){return this.fx&&this.fx.play(),this}}}),s.MorphObj=s.invent({create:function(a,b){return s.Color.isColor(b)?new s.Color(a).morph(b):s.regex.numberAndUnit.test(b)?new s.Number(a).morph(b):(this.value=0,void(this.destination=b))},extend:{at:function(a,b){return 1>b?this.value:this.destination},valueOf:function(){return this.value}}}),s.extend(s.FX,{attr:function(a,b){if("object"==typeof a)for(var c in a)this.attr(c,a[c]);else this.add(a,new s.MorphObj(null,b),"attrs");return this},style:function(a,b){if("object"==typeof a)for(var c in a)this.style(c,a[c]);else this.add(a,new s.MorphObj(null,b),"styles");return this},x:function(a,b){if(this.target()instanceof s.G)return this.transform({x:a},b),this;var c=(new s.Number).morph(a);return c.relative=b,this.add("x",c)},y:function(a,b){if(this.target()instanceof s.G)return this.transform({y:a},b),this;var c=(new s.Number).morph(a);return c.relative=b,this.add("y",c)},cx:function(a){return this.add("cx",(new s.Number).morph(a))},cy:function(a){return this.add("cy",(new s.Number).morph(a))},move:function(a,b){return this.x(a).y(b)},center:function(a,b){return this.cx(a).cy(b)},size:function(a,b){if(this.target()instanceof s.Text)this.attr("font-size",a);else{var c;a&&b||(c=this.target().bbox()),a||(a=c.width/c.height*b),b||(b=c.height/c.width*a),this.add("width",(new s.Number).morph(a)).add("height",(new s.Number).morph(b))}return this},plot:function(a){return this.add("plot",this.target().array().morph(a))},leading:function(a){return this.target().leading?this.add("leading",(new s.Number).morph(a)):this},viewbox:function(a,b,c,d){return this.target()instanceof s.Container&&this.add("viewbox",new s.ViewBox(a,b,c,d)),this},update:function(a){if(this.target()instanceof s.Stop){if("number"==typeof a||a instanceof s.Number)return this.update({offset:arguments[0],color:arguments[1],opacity:arguments[2]});null!=a.opacity&&this.attr("stop-opacity",a.opacity),null!=a.color&&this.attr("stop-color",a.color),null!=a.offset&&this.attr("offset",a.offset)}return this}}),s.BBox=s.invent({create:function(a){if(a){var c;try{if(!b.documentElement.contains(a.node))throw new Exception("Element not in the dom");c=a.node.getBBox()}catch(d){if(a instanceof s.Shape){var e=a.clone(s.parser.draw).show();c=e.bbox(),e.remove()}else c={x:a.node.clientLeft,y:a.node.clientTop,width:a.node.clientWidth,height:a.node.clientHeight}}this.x=c.x,this.y=c.y,this.width=c.width,this.height=c.height}q(this)},parent:s.Element,construct:{bbox:function(){return new s.BBox(this)}}}),s.TBox=s.invent({create:function(a){if(a){var b=a.ctm().extract(),c=a.bbox();this.width=c.width*b.scaleX,this.height=c.height*b.scaleY,this.x=c.x+b.x,this.y=c.y+b.y}q(this)},parent:s.Element,construct:{tbox:function(){return new s.TBox(this)}}}),s.RBox=s.invent({create:function(b){if(b){var c=b.doc().parent(),d=b.node.getBoundingClientRect(),e=1;for(this.x=d.left,this.y=d.top,this.x-=c.offsetLeft,this.y-=c.offsetTop;c=c.offsetParent;)this.x-=c.offsetLeft,this.y-=c.offsetTop;for(c=b;c.parent&&(c=c.parent());)c.viewbox&&(e*=c.viewbox().zoom,this.x-=c.x()||0,this.y-=c.y()||0);this.width=d.width/=e,this.height=d.height/=e}q(this),this.x+=a.pageXOffset,this.y+=a.pageYOffset},parent:s.Element,construct:{rbox:function(){return new s.RBox(this)}}}),[s.BBox,s.TBox,s.RBox].forEach(function(a){s.extend(a,{merge:function(b){var c=new a;return c.x=Math.min(this.x,b.x),c.y=Math.min(this.y,b.y),c.width=Math.max(this.x+this.width,b.x+b.width)-c.x,c.height=Math.max(this.y+this.height,b.y+b.height)-c.y,q(c)}})}),s.Matrix=s.invent({create:function(a){var b,c=k([1,0,0,1,0,0]);for(a=a instanceof s.Element?a.matrixify():"string"==typeof a?n(a):6==arguments.length?k([].slice.call(arguments)):"object"==typeof a?a:c,b=u.length-1;b>=0;--b)this[u[b]]=a&&"number"==typeof a[u[b]]?a[u[b]]:c[u[b]]},extend:{extract:function(){var a=j(this,0,1),b=j(this,1,0),c=180/Math.PI*Math.atan2(a.y,a.x)-90;return{x:this.e,y:this.f,transformedX:(this.e*Math.cos(c*Math.PI/180)+this.f*Math.sin(c*Math.PI/180))/Math.sqrt(this.a*this.a+this.b*this.b),transformedY:(this.f*Math.cos(c*Math.PI/180)+this.e*Math.sin(-c*Math.PI/180))/Math.sqrt(this.c*this.c+this.d*this.d),skewX:-c,skewY:180/Math.PI*Math.atan2(b.y,b.x),scaleX:Math.sqrt(this.a*this.a+this.b*this.b),scaleY:Math.sqrt(this.c*this.c+this.d*this.d),rotation:c,a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f,matrix:new s.Matrix(this)}},clone:function(){return new s.Matrix(this)},morph:function(a){return this.destination=new s.Matrix(a),this},at:function(a){if(!this.destination)return this;var b=new s.Matrix({a:this.a+(this.destination.a-this.a)*a,b:this.b+(this.destination.b-this.b)*a,c:this.c+(this.destination.c-this.c)*a,d:this.d+(this.destination.d-this.d)*a,e:this.e+(this.destination.e-this.e)*a,f:this.f+(this.destination.f-this.f)*a});if(this.param&&this.param.to){var c={rotation:this.param.from.rotation+(this.param.to.rotation-this.param.from.rotation)*a,cx:this.param.from.cx,cy:this.param.from.cy};b=b.rotate((this.param.to.rotation-2*this.param.from.rotation)*a,c.cx,c.cy),b.param=c}return b},multiply:function(a){return new s.Matrix(this["native"]().multiply(l(a)["native"]()))},inverse:function(){return new s.Matrix(this["native"]().inverse())},translate:function(a,b){return new s.Matrix(this["native"]().translate(a||0,b||0))},scale:function(a,b,c,d){return(1==arguments.length||3==arguments.length)&&(b=a),3==arguments.length&&(d=c,c=b),this.around(c,d,new s.Matrix(a,0,0,b,0,0))},rotate:function(a,b,c){return a=s.utils.radians(a),this.around(b,c,new s.Matrix(Math.cos(a),Math.sin(a),(-Math.sin(a)),Math.cos(a),0,0))},flip:function(a,b){return"x"==a?this.scale(-1,1,b,0):this.scale(1,-1,0,b)},skew:function(a,b,c,d){return this.around(c,d,this["native"]().skewX(a||0).skewY(b||0))},skewX:function(a,b,c){return this.around(b,c,this["native"]().skewX(a||0))},skewY:function(a,b,c){return this.around(b,c,this["native"]().skewY(a||0))},around:function(a,b,c){return this.multiply(new s.Matrix(1,0,0,1,a||0,b||0)).multiply(c).multiply(new s.Matrix(1,0,0,1,-a||0,-b||0))},"native":function(){for(var a=s.parser["native"].createSVGMatrix(),b=u.length-1;b>=0;b--)a[u[b]]=this[u[b]];return a},toString:function(){return"matrix("+this.a+","+this.b+","+this.c+","+this.d+","+this.e+","+this.f+")"}},parent:s.Element,construct:{ctm:function(){return new s.Matrix(this.node.getCTM())},screenCTM:function(){return new s.Matrix(this.node.getScreenCTM())}}}),s.Point=s.invent({create:function(a,b){var c,d={x:0,y:0};c=Array.isArray(a)?{x:a[0],y:a[1]}:"object"==typeof a?{x:a.x,y:a.y}:null!=b?{x:a,y:b}:d,this.x=c.x,this.y=c.y},extend:{clone:function(){return new s.Point(this)},morph:function(a){return this.destination=new s.Point(a),this},at:function(a){if(!this.destination)return this;var b=new s.Point({x:this.x+(this.destination.x-this.x)*a,y:this.y+(this.destination.y-this.y)*a});return b},"native":function(){var a=s.parser["native"].createSVGPoint();return a.x=this.x,a.y=this.y,a},transform:function(a){return new s.Point(this["native"]().matrixTransform(a["native"]()))}}}),s.extend(s.Element,{point:function(a,b){return new s.Point(a,b).transform(this.screenCTM().inverse())}}),s.extend(s.Element,{attr:function(a,b,c){if(null==a){for(a={},b=this.node.attributes,c=b.length-1;c>=0;c--)a[b[c].nodeName]=s.regex.isNumber.test(b[c].nodeValue)?parseFloat(b[c].nodeValue):b[c].nodeValue;return a}if("object"==typeof a)for(b in a)this.attr(b,a[b]);else if(null===b)this.node.removeAttribute(a);else{if(null==b)return b=this.node.getAttribute(a),null==b?s.defaults.attrs[a]:s.regex.isNumber.test(b)?parseFloat(b):b;"stroke-width"==a?this.attr("stroke",parseFloat(b)>0?this._stroke:null):"stroke"==a&&(this._stroke=b),("fill"==a||"stroke"==a)&&(s.regex.isImage.test(b)&&(b=this.doc().defs().image(b,0,0)),b instanceof s.Image&&(b=this.doc().defs().pattern(0,0,function(){this.add(b)}))),"number"==typeof b?b=new s.Number(b):s.Color.isColor(b)?b=new s.Color(b):Array.isArray(b)?b=new s.Array(b):b instanceof s.Matrix&&b.param&&(this.param=b.param),"leading"==a?this.leading&&this.leading(b):"string"==typeof c?this.node.setAttributeNS(c,a,b.toString()):this.node.setAttribute(a,b.toString()),!this.rebuild||"font-size"!=a&&"x"!=a||this.rebuild(a,b)}return this}}),s.extend(s.Element,{transform:function(a,b){var c,d=this;if("object"!=typeof a)return c=new s.Matrix(d).extract(),"string"==typeof a?c[a]:c;if(c=new s.Matrix(d),b=!!b||!!a.relative,null!=a.a)c=b?c.multiply(new s.Matrix(a)):new s.Matrix(a);else if(null!=a.rotation)m(a,d),c=b?c.rotate(a.rotation,a.cx,a.cy):c.rotate(a.rotation-c.extract().rotation,a.cx,a.cy);else if(null!=a.scale||null!=a.scaleX||null!=a.scaleY){if(m(a,d),a.scaleX=null!=a.scale?a.scale:null!=a.scaleX?a.scaleX:1,a.scaleY=null!=a.scale?a.scale:null!=a.scaleY?a.scaleY:1,!b){var e=c.extract();a.scaleX=1*a.scaleX/e.scaleX,a.scaleY=1*a.scaleY/e.scaleY}c=c.scale(a.scaleX,a.scaleY,a.cx,a.cy)}else if(null!=a.skewX||null!=a.skewY){if(m(a,d),a.skewX=null!=a.skewX?a.skewX:0,a.skewY=null!=a.skewY?a.skewY:0,!b){var e=c.extract();c=c.multiply((new s.Matrix).skew(e.skewX,e.skewY,a.cx,a.cy).inverse())}c=c.skew(a.skewX,a.skewY,a.cx,a.cy)}else a.flip?c=c.flip(a.flip,null==a.offset?d.bbox()["c"+a.flip]:a.offset):(null!=a.x||null!=a.y)&&(b?c=c.translate(a.x,a.y):(null!=a.x&&(c.e=a.x),null!=a.y&&(c.f=a.y)));return this.attr("transform",c)}}),s.extend(s.FX,{transform:function(a,b){var c,d=this.target();return"object"!=typeof a?(c=new s.Matrix(d).extract(),"string"==typeof a?c[a]:c):(b=!!b||!!a.relative,null!=a.a?c=new s.Matrix(a):null!=a.rotation?(m(a,d),c=new s.Rotate(a.rotation,a.cx,a.cy)):null!=a.scale||null!=a.scaleX||null!=a.scaleY?(m(a,d),a.scaleX=null!=a.scale?a.scale:null!=a.scaleX?a.scaleX:1,a.scaleY=null!=a.scale?a.scale:null!=a.scaleY?a.scaleY:1,c=new s.Scale(a.scaleX,a.scaleY,a.cx,a.cy)):null!=a.skewX||null!=a.skewY?(m(a,d),a.skewX=null!=a.skewX?a.skewX:0,a.skewY=null!=a.skewY?a.skewY:0,c=new s.Skew(a.skewX,a.skewY,a.cx,a.cy)):a.flip?c=(new s.Matrix).morph((new s.Matrix).flip(a.flip,null==a.offset?d.bbox()["c"+a.flip]:a.offset)):(null!=a.x||null!=a.y)&&(c=new s.Translate(a.x,a.y)),c?(c.relative=b,this.last().transforms.push(c),setTimeout(function(){this.start()}.bind(this),0),this):this)}}),s.extend(s.Element,{untransform:function(){return this.attr("transform",null)},matrixify:function(){var a=(this.attr("transform")||"").split(/\)\s*/).slice(0,-1).map(function(a){var b=a.trim().split("(");return[b[0],b[1].split(s.regex.matrixElements).map(function(a){return parseFloat(a)})]}).reduce(function(a,b){return"matrix"==b[0]?a.multiply(k(b[1])):a[b[0]].apply(a,b[1])},new s.Matrix);return a},toParent:function(a){if(this==a)return this;var b=this.screenCTM(),c=a.rect(1,1),d=c.screenCTM().inverse();return c.remove(),this.addTo(a).untransform().transform(d.multiply(b)),this},toDoc:function(){return this.toParent(this.doc())}}),s.Transformation=s.invent({create:function(a,b){if(arguments.length>1&&"boolean"!=typeof b)return this.create([].slice.call(arguments));if("object"==typeof a)for(var c=0,d=this.arguments.length;d>c;++c)this[this.arguments[c]]=a[this.arguments[c]];if(Array.isArray(a))for(var c=0,d=this.arguments.length;d>c;++c)this[this.arguments[c]]=a[c];this.inversed=!1,b===!0&&(this.inversed=!0)},extend:{at:function(a){for(var b=[],c=0,d=this.arguments.length;d>c;++c)b.push(this[this.arguments[c]]);var e=this._undo||new s.Matrix;return e=(new s.Matrix).morph(s.Matrix.prototype[this.method].apply(e,b)).at(a),this.inversed?e.inverse():e},undo:function(a){for(var b=0,c=this.arguments.length;c>b;++b)a[this.arguments[b]]="undefined"==typeof this[this.arguments[b]]?0:a[this.arguments[b]];return this._undo=new(s[f(this.method)])(a,(!0)).at(1),this}}}),s.Translate=s.invent({parent:s.Matrix,inherit:s.Transformation,create:function(a,b){"object"==typeof a?this.constructor.call(this,a,b):this.constructor.call(this,[].slice.call(arguments))},extend:{arguments:["transformedX","transformedY"],method:"translate"}}),s.Rotate=s.invent({parent:s.Matrix,inherit:s.Transformation,create:function(a,b){"object"==typeof a?this.constructor.call(this,a,b):this.constructor.call(this,[].slice.call(arguments))},extend:{arguments:["rotation","cx","cy"],method:"rotate",at:function(a){var b=(new s.Matrix).rotate((new s.Number).morph(this.rotation-(this._undo?this._undo.rotation:0)).at(a),this.cx,this.cy);return this.inversed?b.inverse():b},undo:function(a){this._undo=a}}}),s.Scale=s.invent({parent:s.Matrix,inherit:s.Transformation,create:function(a,b){"object"==typeof a?this.constructor.call(this,a,b):this.constructor.call(this,[].slice.call(arguments))},extend:{arguments:["scaleX","scaleY","cx","cy"],method:"scale"}}),s.Skew=s.invent({parent:s.Matrix,inherit:s.Transformation,create:function(a,b){"object"==typeof a?this.constructor.call(this,a,b):this.constructor.call(this,[].slice.call(arguments))},extend:{arguments:["skewX","skewY","cx","cy"],method:"skew"}}),s.extend(s.Element,{style:function(a,b){if(0==arguments.length)return this.node.style.cssText||"";if(arguments.length<2)if("object"==typeof a)for(b in a)this.style(b,a[b]);else{if(!s.regex.isCss.test(a))return this.node.style[e(a)];a=a.split(";");for(var c=0;c<a.length;c++)b=a[c].split(":"),this.style(b[0].replace(/\s+/g,""),b[1])}else this.node.style[e(a)]=null===b||s.regex.isBlank.test(b)?"":b;return this}}),s.Parent=s.invent({create:function(a){this.constructor.call(this,a)},inherit:s.Element,extend:{children:function(){return s.utils.map(s.utils.filterSVGElements(this.node.childNodes),function(a){return s.adopt(a)})},add:function(a,b){return null==b?this.node.appendChild(a.node):a.node!=this.node.childNodes[b]&&this.node.insertBefore(a.node,this.node.childNodes[b]),this},put:function(a,b){return this.add(a,b),a},has:function(a){return this.index(a)>=0},index:function(a){return[].slice.call(this.node.childNodes).indexOf(a.node)},get:function(a){return s.adopt(this.node.childNodes[a])},first:function(){return this.get(0)},last:function(){return this.get(this.node.childNodes.length-1)},each:function(a,b){var c,d,e=this.children();for(c=0,d=e.length;d>c;c++)e[c]instanceof s.Element&&a.apply(e[c],[c,e]),b&&e[c]instanceof s.Container&&e[c].each(a,b);return this},removeElement:function(a){return this.node.removeChild(a.node),this},clear:function(){for(;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);return delete this._defs,this},defs:function(){return this.doc().defs()}}}),s.extend(s.Parent,{ungroup:function(a,b){return 0===b||this instanceof s.Defs?this:(a=a||(this instanceof s.Doc?this:this.parent(s.Parent)),b=b||1/0,this.each(function(){return this instanceof s.Defs?this:this instanceof s.Parent?this.ungroup(a,b-1):this.toParent(a)}),this.node.firstChild||this.remove(),this)},flatten:function(a,b){return this.ungroup(a,b)}}),s.Container=s.invent({create:function(a){this.constructor.call(this,a)},inherit:s.Parent}),s.ViewBox=s.invent({create:function(a){var b,c,d,e,f,g,h,i,j=[0,0,0,0],k=1,l=1,m=/[+-]?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?/gi;if(a instanceof s.Element){for(h=a,i=a,g=(a.attr("viewBox")||"").match(m),f=a.bbox,d=new s.Number(a.width()),e=new s.Number(a.height());"%"==d.unit;)k*=d.value,d=new s.Number(h instanceof s.Doc?h.parent().offsetWidth:h.parent().width()),h=h.parent();for(;"%"==e.unit;)l*=e.value,e=new s.Number(i instanceof s.Doc?i.parent().offsetHeight:i.parent().height()),i=i.parent();this.x=0,this.y=0,this.width=d*k,this.height=e*l,this.zoom=1,g&&(b=parseFloat(g[0]),c=parseFloat(g[1]),d=parseFloat(g[2]),e=parseFloat(g[3]),this.zoom=this.width/this.height>d/e?this.height/e:this.width/d,this.x=b,this.y=c,this.width=d,this.height=e)}else a="string"==typeof a?a.match(m).map(function(a){return parseFloat(a)}):Array.isArray(a)?a:"object"==typeof a?[a.x,a.y,a.width,a.height]:4==arguments.length?[].slice.call(arguments):j,this.x=a[0],this.y=a[1],this.width=a[2],this.height=a[3]},extend:{toString:function(){return this.x+" "+this.y+" "+this.width+" "+this.height},morph:function(a){var a=1==arguments.length?[a.x,a.y,a.width,a.height]:[].slice.call(arguments);return this.destination=new s.ViewBox(a),this},at:function(a){return this.destination?new s.ViewBox([this.x+(this.destination.x-this.x)*a,this.y+(this.destination.y-this.y)*a,this.width+(this.destination.width-this.width)*a,this.height+(this.destination.height-this.height)*a]):this}},parent:s.Container,construct:{viewbox:function(a){return 0==arguments.length?new s.ViewBox(this):(a=1==arguments.length?[a.x,a.y,a.width,a.height]:[].slice.call(arguments),this.attr("viewBox",a))}}}),["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","touchstart","touchmove","touchleave","touchend","touchcancel"].forEach(function(a){s.Element.prototype[a]=function(b){var c=this;return this.node["on"+a]="function"==typeof b?function(){return b.apply(c,arguments)}:null,this}}),s.listeners=[],s.handlerMap=[],s.listenerId=0,s.on=function(a,b,c,d){var e=c.bind(d||a.instance||a),f=(s.handlerMap.indexOf(a)+1||s.handlerMap.push(a))-1,g=b.split(".")[0],h=b.split(".")[1]||"*";s.listeners[f]=s.listeners[f]||{},s.listeners[f][g]=s.listeners[f][g]||{},s.listeners[f][g][h]=s.listeners[f][g][h]||{},c._svgjsListenerId||(c._svgjsListenerId=++s.listenerId),s.listeners[f][g][h][c._svgjsListenerId]=e,a.addEventListener(g,e,!1)},s.off=function(a,b,c){var d=s.handlerMap.indexOf(a),e=b&&b.split(".")[0],f=b&&b.split(".")[1];if(-1!=d)if(c){if("function"==typeof c&&(c=c._svgjsListenerId),!c)return;s.listeners[d][e]&&s.listeners[d][e][f||"*"]&&(a.removeEventListener(e,s.listeners[d][e][f||"*"][c],!1),delete s.listeners[d][e][f||"*"][c])}else if(f&&e){if(s.listeners[d][e]&&s.listeners[d][e][f]){for(c in s.listeners[d][e][f])s.off(a,[e,f].join("."),c);delete s.listeners[d][e][f]}}else if(f)for(b in s.listeners[d])for(namespace in s.listeners[d][b])f===namespace&&s.off(a,[b,f].join("."));else if(e){if(s.listeners[d][e]){for(namespace in s.listeners[d][e])s.off(a,[e,namespace].join("."));delete s.listeners[d][e]}}else{for(b in s.listeners[d])s.off(a,b);delete s.listeners[d]}},s.extend(s.Element,{on:function(a,b,c){return s.on(this.node,a,b,c),this},off:function(a,b){return s.off(this.node,a,b),this},fire:function(a,b){return a instanceof Event?this.node.dispatchEvent(a):this.node.dispatchEvent(new v(a,{detail:b})),this}}),s.Defs=s.invent({create:"defs",inherit:s.Container}),s.G=s.invent({create:"g",inherit:s.Container,extend:{x:function(a){return null==a?this.transform("x"):this.transform({x:a-this.x()},!0)},y:function(a){return null==a?this.transform("y"):this.transform({y:a-this.y()},!0)},cx:function(a){return null==a?this.gbox().cx:this.x(a-this.gbox().width/2)},cy:function(a){return null==a?this.gbox().cy:this.y(a-this.gbox().height/2)},gbox:function(){var a=this.bbox(),b=this.transform();return a.x+=b.x,a.x2+=b.x,a.cx+=b.x,a.y+=b.y,a.y2+=b.y,a.cy+=b.y,a}},construct:{group:function(){return this.put(new s.G)}}}),s.extend(s.Element,{siblings:function(){return this.parent().children()},position:function(){return this.parent().index(this)},next:function(){return this.siblings()[this.position()+1]},previous:function(){return this.siblings()[this.position()-1]},forward:function(){var a=this.position()+1,b=this.parent();return b.removeElement(this).add(this,a),b instanceof s.Doc&&b.node.appendChild(b.defs().node),this},backward:function(){var a=this.position();return a>0&&this.parent().removeElement(this).add(this,a-1),this},front:function(){var a=this.parent();return a.node.appendChild(this.node),a instanceof s.Doc&&a.node.appendChild(a.defs().node),this},back:function(){return this.position()>0&&this.parent().removeElement(this).add(this,0),this},before:function(a){a.remove();var b=this.position();return this.parent().add(a,b),this},after:function(a){a.remove();var b=this.position();return this.parent().add(a,b+1),this}}),s.Mask=s.invent({create:function(){this.constructor.call(this,s.create("mask")),this.targets=[]},inherit:s.Container,extend:{remove:function(){for(var a=this.targets.length-1;a>=0;a--)this.targets[a]&&this.targets[a].unmask();return this.targets=[],this.parent().removeElement(this),this}},construct:{mask:function(){return this.defs().put(new s.Mask)}}}),s.extend(s.Element,{maskWith:function(a){return this.masker=a instanceof s.Mask?a:this.parent().mask().add(a),this.masker.targets.push(this),this.attr("mask",'url("#'+this.masker.attr("id")+'")')},unmask:function(){return delete this.masker,this.attr("mask",null)}}),s.ClipPath=s.invent({create:function(){this.constructor.call(this,s.create("clipPath")),this.targets=[]},inherit:s.Container,extend:{remove:function(){for(var a=this.targets.length-1;a>=0;a--)this.targets[a]&&this.targets[a].unclip();return this.targets=[],this.parent().removeElement(this),this}},construct:{clip:function(){return this.defs().put(new s.ClipPath)}}}),s.extend(s.Element,{clipWith:function(a){return this.clipper=a instanceof s.ClipPath?a:this.parent().clip().add(a),this.clipper.targets.push(this),this.attr("clip-path",'url("#'+this.clipper.attr("id")+'")')},unclip:function(){return delete this.clipper,this.attr("clip-path",null)}}),s.Gradient=s.invent({create:function(a){this.constructor.call(this,s.create(a+"Gradient")),this.type=a},inherit:s.Container,extend:{at:function(a,b,c){return this.put(new s.Stop).update(a,b,c)},update:function(a){return this.clear(),"function"==typeof a&&a.call(this,this),this},fill:function(){return"url(#"+this.id()+")"},toString:function(){return this.fill()},attr:function(a,b,c){return"transform"==a&&(a="gradientTransform"),s.Container.prototype.attr.call(this,a,b,c)}},construct:{gradient:function(a,b){return this.defs().gradient(a,b)}}}),s.extend(s.Gradient,s.FX,{from:function(a,b){return"radial"==(this._target||this).type?this.attr({fx:new s.Number(a),fy:new s.Number(b)}):this.attr({x1:new s.Number(a),y1:new s.Number(b)})},to:function(a,b){return"radial"==(this._target||this).type?this.attr({cx:new s.Number(a),cy:new s.Number(b)}):this.attr({x2:new s.Number(a),y2:new s.Number(b)})}}),s.extend(s.Defs,{gradient:function(a,b){return this.put(new s.Gradient(a)).update(b)}}),s.Stop=s.invent({create:"stop",inherit:s.Element,extend:{update:function(a){return("number"==typeof a||a instanceof s.Number)&&(a={offset:arguments[0],color:arguments[1],opacity:arguments[2]}),null!=a.opacity&&this.attr("stop-opacity",a.opacity),null!=a.color&&this.attr("stop-color",a.color),null!=a.offset&&this.attr("offset",new s.Number(a.offset)),this}}}),s.Pattern=s.invent({create:"pattern",inherit:s.Container,extend:{fill:function(){return"url(#"+this.id()+")"},update:function(a){return this.clear(),"function"==typeof a&&a.call(this,this),this},toString:function(){return this.fill()},attr:function(a,b,c){return"transform"==a&&(a="patternTransform"),s.Container.prototype.attr.call(this,a,b,c)}},construct:{pattern:function(a,b,c){return this.defs().pattern(a,b,c)}}}),s.extend(s.Defs,{pattern:function(a,b,c){return this.put(new s.Pattern).update(c).attr({x:0,y:0,width:a,height:b,patternUnits:"userSpaceOnUse"})}}),s.Doc=s.invent({create:function(a){a&&(a="string"==typeof a?b.getElementById(a):a,"svg"==a.nodeName?this.constructor.call(this,a):(this.constructor.call(this,s.create("svg")),a.appendChild(this.node),this.size("100%","100%")),this.namespace().defs())},inherit:s.Container,extend:{namespace:function(){return this.attr({xmlns:s.ns,version:"1.1"}).attr("xmlns:xlink",s.xlink,s.xmlns).attr("xmlns:svgjs",s.svgjs,s.xmlns)},defs:function(){if(!this._defs){var a;this._defs=(a=this.node.getElementsByTagName("defs")[0])?s.adopt(a):new s.Defs,this.node.appendChild(this._defs.node)}return this._defs},parent:function(){return"#document"==this.node.parentNode.nodeName?null:this.node.parentNode},spof:function(){var a=this.node.getScreenCTM();return a&&this.style("left",-a.e%1+"px").style("top",-a.f%1+"px"),this},remove:function(){return this.parent()&&this.parent().removeChild(this.node),this}}}),s.Shape=s.invent({create:function(a){this.constructor.call(this,a)},inherit:s.Element}),s.Bare=s.invent({create:function(a,b){if(this.constructor.call(this,s.create(a)),b)for(var c in b.prototype)"function"==typeof b.prototype[c]&&(this[c]=b.prototype[c])},inherit:s.Element,extend:{words:function(a){for(;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);return this.node.appendChild(b.createTextNode(a)),this}}}),s.extend(s.Parent,{element:function(a,b){return this.put(new s.Bare(a,b))},symbol:function(){return this.defs().element("symbol",s.Container)}}),s.Use=s.invent({create:"use",inherit:s.Shape,extend:{element:function(a,b){return this.attr("href",(b||"")+"#"+a,s.xlink)}},construct:{use:function(a,b){return this.put(new s.Use).element(a,b)}}}),s.Rect=s.invent({create:"rect",inherit:s.Shape,construct:{rect:function(a,b){return this.put(new s.Rect).size(a,b)}}}),s.Circle=s.invent({create:"circle",inherit:s.Shape,construct:{circle:function(a){return this.put(new s.Circle).rx(new s.Number(a).divide(2)).move(0,0)}}}),s.extend(s.Circle,s.FX,{rx:function(a){return this.attr("r",a)},ry:function(a){return this.rx(a)}}),s.Ellipse=s.invent({create:"ellipse",inherit:s.Shape,construct:{ellipse:function(a,b){return this.put(new s.Ellipse).size(a,b).move(0,0)}}}),s.extend(s.Ellipse,s.Rect,s.FX,{rx:function(a){return this.attr("rx",a)},ry:function(a){return this.attr("ry",a)}}),s.extend(s.Circle,s.Ellipse,{x:function(a){return null==a?this.cx()-this.rx():this.cx(a+this.rx())},y:function(a){return null==a?this.cy()-this.ry():this.cy(a+this.ry())},cx:function(a){return null==a?this.attr("cx"):this.attr("cx",a)},cy:function(a){return null==a?this.attr("cy"):this.attr("cy",a)},width:function(a){return null==a?2*this.rx():this.rx(new s.Number(a).divide(2))},height:function(a){return null==a?2*this.ry():this.ry(new s.Number(a).divide(2))},size:function(a,b){var c=i(this,a,b);return this.rx(new s.Number(c.width).divide(2)).ry(new s.Number(c.height).divide(2))}}),s.Line=s.invent({create:"line",inherit:s.Shape,extend:{array:function(){return new s.PointArray([[this.attr("x1"),this.attr("y1")],[this.attr("x2"),this.attr("y2")]])},plot:function(a,b,c,d){return a="undefined"!=typeof b?{x1:a,y1:b,x2:c,y2:d}:new s.PointArray(a).toLine(),this.attr(a)},move:function(a,b){return this.attr(this.array().move(a,b).toLine())},size:function(a,b){var c=i(this,a,b);return this.attr(this.array().size(c.width,c.height).toLine())}},construct:{line:function(a,b,c,d){return this.put(new s.Line).plot(a,b,c,d)}}}),s.Polyline=s.invent({create:"polyline",inherit:s.Shape,construct:{polyline:function(a){return this.put(new s.Polyline).plot(a)}}}),s.Polygon=s.invent({create:"polygon",inherit:s.Shape,construct:{polygon:function(a){return this.put(new s.Polygon).plot(a)}}}),s.extend(s.Polyline,s.Polygon,{array:function(){return this._array||(this._array=new s.PointArray(this.attr("points")))},plot:function(a){return this.attr("points",this._array=new s.PointArray(a))},move:function(a,b){return this.attr("points",this.array().move(a,b))},size:function(a,b){var c=i(this,a,b);return this.attr("points",this.array().size(c.width,c.height))}}),s.extend(s.Line,s.Polyline,s.Polygon,{morphArray:s.PointArray,x:function(a){return null==a?this.bbox().x:this.move(a,this.bbox().y)},y:function(a){return null==a?this.bbox().y:this.move(this.bbox().x,a)},width:function(a){var b=this.bbox();return null==a?b.width:this.size(a,b.height)},height:function(a){var b=this.bbox();return null==a?b.height:this.size(b.width,a)}}),s.Path=s.invent({create:"path",inherit:s.Shape,extend:{morphArray:s.PathArray,array:function(){return this._array||(this._array=new s.PathArray(this.attr("d")))},plot:function(a){return this.attr("d",this._array=new s.PathArray(a))},move:function(a,b){return this.attr("d",this.array().move(a,b))},x:function(a){return null==a?this.bbox().x:this.move(a,this.bbox().y)},y:function(a){return null==a?this.bbox().y:this.move(this.bbox().x,a)},size:function(a,b){var c=i(this,a,b);return this.attr("d",this.array().size(c.width,c.height))},width:function(a){return null==a?this.bbox().width:this.size(a,this.bbox().height)},height:function(a){return null==a?this.bbox().height:this.size(this.bbox().width,a)}},construct:{path:function(a){return this.put(new s.Path).plot(a)}}}),s.Image=s.invent({create:"image",inherit:s.Shape,extend:{load:function(a){if(!a)return this;var c=this,d=b.createElement("img");return d.onload=function(){var b=c.parent(s.Pattern);null!==b&&(0==c.width()&&0==c.height()&&c.size(d.width,d.height),b&&0==b.width()&&0==b.height()&&b.size(c.width(),c.height()),"function"==typeof c._loaded&&c._loaded.call(c,{width:d.width,height:d.height,
ratio:d.width/d.height,url:a}))},d.onerror=function(a){"function"==typeof c._error&&c._error.call(c,a)},this.attr("href",d.src=this.src=a,s.xlink)},loaded:function(a){return this._loaded=a,this},error:function(a){return this._error=a,this}},construct:{image:function(a,b,c){return this.put(new s.Image).load(a).size(b||0,c||b||0)}}}),s.Text=s.invent({create:function(){this.constructor.call(this,s.create("text")),this.dom.leading=new s.Number(1.3),this._rebuild=!0,this._build=!1,this.attr("font-family",s.defaults.attrs["font-family"])},inherit:s.Shape,extend:{x:function(a){return null==a?this.attr("x"):(this.textPath||this.lines().each(function(){this.dom.newLined&&this.x(a)}),this.attr("x",a))},y:function(a){var b=this.attr("y"),c="number"==typeof b?b-this.bbox().y:0;return null==a?"number"==typeof b?b-c:b:this.attr("y","number"==typeof a?a+c:a)},cx:function(a){return null==a?this.bbox().cx:this.x(a-this.bbox().width/2)},cy:function(a){return null==a?this.bbox().cy:this.y(a-this.bbox().height/2)},text:function(a){if("undefined"==typeof a){for(var a="",b=this.node.childNodes,c=0,d=b.length;d>c;++c)0!=c&&3!=b[c].nodeType&&1==s.adopt(b[c]).dom.newLined&&(a+="\n"),a+=b[c].textContent;return a}if(this.clear().build(!0),"function"==typeof a)a.call(this,this);else{a=a.split("\n");for(var c=0,e=a.length;e>c;c++)this.tspan(a[c]).newLine()}return this.build(!1).rebuild()},size:function(a){return this.attr("font-size",a).rebuild()},leading:function(a){return null==a?this.dom.leading:(this.dom.leading=new s.Number(a),this.rebuild())},lines:function(){var a=(this.textPath&&this.textPath()||this).node,b=s.utils.map(s.utils.filterSVGElements(a.childNodes),function(a){return s.adopt(a)});return new s.Set(b)},rebuild:function(a){if("boolean"==typeof a&&(this._rebuild=a),this._rebuild){var b=this,c=0,d=this.dom.leading*new s.Number(this.attr("font-size"));this.lines().each(function(){this.dom.newLined&&(this.textPath||this.attr("x",b.attr("x")),"\n"==this.text()?c+=d:(this.attr("dy",d+c),c=0))}),this.fire("rebuild")}return this},build:function(a){return this._build=!!a,this},setData:function(a){return this.dom=a,this.dom.leading=new s.Number(a.leading||1.3),this}},construct:{text:function(a){return this.put(new s.Text).text(a)},plain:function(a){return this.put(new s.Text).plain(a)}}}),s.Tspan=s.invent({create:"tspan",inherit:s.Shape,extend:{text:function(a){return null==a?this.node.textContent+(this.dom.newLined?"\n":""):("function"==typeof a?a.call(this,this):this.plain(a),this)},dx:function(a){return this.attr("dx",a)},dy:function(a){return this.attr("dy",a)},newLine:function(){var a=this.parent(s.Text);return this.dom.newLined=!0,this.dy(a.dom.leading*a.attr("font-size")).attr("x",a.x())}}}),s.extend(s.Text,s.Tspan,{plain:function(a){return this._build===!1&&this.clear(),this.node.appendChild(b.createTextNode(a)),this},tspan:function(a){var b=(this.textPath&&this.textPath()||this).node,c=new s.Tspan;return this._build===!1&&this.clear(),b.appendChild(c.node),c.text(a)},clear:function(){for(var a=(this.textPath&&this.textPath()||this).node;a.hasChildNodes();)a.removeChild(a.lastChild);return this},length:function(){return this.node.getComputedTextLength()}}),s.TextPath=s.invent({create:"textPath",inherit:s.Parent,parent:s.Text,construct:{path:function(a){for(var b=new s.TextPath,c=this.doc().defs().path(a);this.node.hasChildNodes();)b.node.appendChild(this.node.firstChild);return this.node.appendChild(b.node),b.attr("href","#"+c,s.xlink),this},plot:function(a){var b=this.track();return b&&b.plot(a),this},track:function(){var a=this.textPath();return a?a.reference("href"):void 0},textPath:function(){return this.node.firstChild&&"textPath"==this.node.firstChild.nodeName?s.adopt(this.node.firstChild):void 0}}}),s.Nested=s.invent({create:function(){this.constructor.call(this,s.create("svg")),this.style("overflow","visible")},inherit:s.Container,construct:{nested:function(){return this.put(new s.Nested)}}}),s.A=s.invent({create:"a",inherit:s.Container,extend:{to:function(a){return this.attr("href",a,s.xlink)},show:function(a){return this.attr("show",a,s.xlink)},target:function(a){return this.attr("target",a)}},construct:{link:function(a){return this.put(new s.A).to(a)}}}),s.extend(s.Element,{linkTo:function(a){var b=new s.A;return"function"==typeof a?a.call(b,b):b.to(a),this.parent().put(b).put(this)}}),s.Marker=s.invent({create:"marker",inherit:s.Container,extend:{width:function(a){return this.attr("markerWidth",a)},height:function(a){return this.attr("markerHeight",a)},ref:function(a,b){return this.attr("refX",a).attr("refY",b)},update:function(a){return this.clear(),"function"==typeof a&&a.call(this,this),this},toString:function(){return"url(#"+this.id()+")"}},construct:{marker:function(a,b,c){return this.defs().marker(a,b,c)}}}),s.extend(s.Defs,{marker:function(a,b,c){return this.put(new s.Marker).size(a,b).ref(a/2,b/2).viewbox(0,0,a,b).attr("orient","auto").update(c)}}),s.extend(s.Line,s.Polyline,s.Polygon,s.Path,{marker:function(a,b,c,d){var e=["marker"];return"all"!=a&&e.push(a),e=e.join("-"),a=arguments[1]instanceof s.Marker?arguments[1]:this.doc().marker(b,c,d),this.attr(e,a)}});var t={stroke:["color","width","opacity","linecap","linejoin","miterlimit","dasharray","dashoffset"],fill:["color","opacity","rule"],prefix:function(a,b){return"color"==b?a:a+"-"+b}};["fill","stroke"].forEach(function(a){var b,c={};c[a]=function(c){if("string"==typeof c||s.Color.isRgb(c)||c&&"function"==typeof c.fill)this.attr(a,c);else for(b=t[a].length-1;b>=0;b--)null!=c[t[a][b]]&&this.attr(t.prefix(a,t[a][b]),c[t[a][b]]);return this},s.extend(s.Element,s.FX,c)}),s.extend(s.Element,s.FX,{rotate:function(a,b,c){return this.transform({rotation:a,cx:b,cy:c})},skew:function(a,b,c,d){return this.transform({skewX:a,skewY:b,cx:c,cy:d})},scale:function(a,b,c,d){return 1==arguments.length||3==arguments.length?this.transform({scale:a,cx:b,cy:c}):this.transform({scaleX:a,scaleY:b,cx:c,cy:d})},translate:function(a,b){return this.transform({x:a,y:b})},flip:function(a,b){return this.transform({flip:a,offset:b})},matrix:function(a){return this.attr("transform",new s.Matrix(a))},opacity:function(a){return this.attr("opacity",a)},dx:function(a){return this.x((this instanceof s.FX?0:this.x())+a,!0)},dy:function(a){return this.y((this instanceof s.FX?0:this.y())+a,!0)},dmove:function(a,b){return this.dx(a).dy(b)}}),s.extend(s.Rect,s.Ellipse,s.Circle,s.Gradient,s.FX,{radius:function(a,b){var c=(this._target||this).type;return"radial"==c||"circle"==c?this.attr("r",new s.Number(a)):this.rx(a).ry(null==b?a:b)}}),s.extend(s.Path,{length:function(){return this.node.getTotalLength()},pointAt:function(a){return this.node.getPointAtLength(a)}}),s.extend(s.Parent,s.Text,s.FX,{font:function(a){for(var b in a)"leading"==b?this.leading(a[b]):"anchor"==b?this.attr("text-anchor",a[b]):"size"==b||"family"==b||"weight"==b||"stretch"==b||"variant"==b||"style"==b?this.attr("font-"+b,a[b]):this.attr(b,a[b]);return this}}),s.Set=s.invent({create:function(a){Array.isArray(a)?this.members=a:this.clear()},extend:{add:function(){var a,b,c=[].slice.call(arguments);for(a=0,b=c.length;b>a;a++)this.members.push(c[a]);return this},remove:function(a){var b=this.index(a);return b>-1&&this.members.splice(b,1),this},each:function(a){for(var b=0,c=this.members.length;c>b;b++)a.apply(this.members[b],[b,this.members]);return this},clear:function(){return this.members=[],this},length:function(){return this.members.length},has:function(a){return this.index(a)>=0},index:function(a){return this.members.indexOf(a)},get:function(a){return this.members[a]},first:function(){return this.get(0)},last:function(){return this.get(this.members.length-1)},valueOf:function(){return this.members},bbox:function(){var a=new s.BBox;if(0==this.members.length)return a;var b=this.members[0].rbox();return a.x=b.x,a.y=b.y,a.width=b.width,a.height=b.height,this.each(function(){a=a.merge(this.rbox())}),a}},construct:{set:function(a){return new s.Set(a)}}}),s.FX.Set=s.invent({create:function(a){this.set=a}}),s.Set.inherit=function(){var a,b=[];for(var a in s.Shape.prototype)"function"==typeof s.Shape.prototype[a]&&"function"!=typeof s.Set.prototype[a]&&b.push(a);b.forEach(function(a){s.Set.prototype[a]=function(){for(var b=0,c=this.members.length;c>b;b++)this.members[b]&&"function"==typeof this.members[b][a]&&this.members[b][a].apply(this.members[b],arguments);return"animate"==a?this.fx||(this.fx=new s.FX.Set(this)):this}}),b=[];for(var a in s.FX.prototype)"function"==typeof s.FX.prototype[a]&&"function"!=typeof s.FX.Set.prototype[a]&&b.push(a);b.forEach(function(a){s.FX.Set.prototype[a]=function(){for(var b=0,c=this.set.members.length;c>b;b++)this.set.members[b].fx[a].apply(this.set.members[b].fx,arguments);return this}})},s.extend(s.Element,{data:function(a,b,c){if("object"==typeof a)for(b in a)this.data(b,a[b]);else if(arguments.length<2)try{return JSON.parse(this.attr("data-"+a))}catch(d){return this.attr("data-"+a)}else this.attr("data-"+a,null===b?null:c===!0||"string"==typeof b||"number"==typeof b?b:JSON.stringify(b));return this}}),s.extend(s.Element,{remember:function(a,b){if("object"==typeof arguments[0])for(var b in a)this.remember(b,a[b]);else{if(1==arguments.length)return this.memory()[a];this.memory()[a]=b}return this},forget:function(){if(0==arguments.length)this._memory={};else for(var a=arguments.length-1;a>=0;a--)delete this.memory()[arguments[a]];return this},memory:function(){return this._memory||(this._memory={})}}),s.get=function(a){var c=b.getElementById(r(a)||a);return s.adopt(c)},s.select=function(a,c){return new s.Set(s.utils.map((c||b).querySelectorAll(a),function(a){return s.adopt(a)}))},s.extend(s.Parent,{select:function(a){return s.select(a,this.node)}});var u="abcdef".split("");if("function"!=typeof v){var v=function(a,c){c=c||{bubbles:!1,cancelable:!1,detail:void 0};var d=b.createEvent("CustomEvent");return d.initCustomEvent(a,c.bubbles,c.cancelable,c.detail),d};v.prototype=a.Event.prototype,a.CustomEvent=v}return function(b){for(var c=0,d=["moz","webkit"],e=0;e<d.length&&!a.requestAnimationFrame;++e)b.requestAnimationFrame=b[d[e]+"RequestAnimationFrame"],b.cancelAnimationFrame=b[d[e]+"CancelAnimationFrame"]||b[d[e]+"CancelRequestAnimationFrame"];b.requestAnimationFrame=b.requestAnimationFrame||function(a){var d=(new Date).getTime(),e=Math.max(0,16-(d-c)),f=b.setTimeout(function(){a(d+e)},e);return c=d+e,f},b.cancelAnimationFrame=b.cancelAnimationFrame||b.clearTimeout}(a),s}),$(function(){function a(a,c,e){var f=$("#"+a);f.on("click",function(a){b.execCommand(c)}),d.ready(function(){b=this,b.on("stateChange",function(){b.queryCommandState(c)?f.addClass("active"):f.removeClass("active")})})}var b=window.editor,c=ui.Color,d=window.Editor;a("bold","bold"),a("italic","italic"),a("underline","underline"),a("strikethrough","strikethrough"),a("align-left","align-left"),a("align-right","align-right"),a("align-center","align-center"),a("undo","undo"),a("redo","redo"),a("unorderlist","unorderlist"),a("orderlist","orderlist"),a("subscript","subscript"),a("superscript","superscript"),a("link","link"),a("unlink","unlink"),d.ready(function(){b=this,b.on("stateChange",function(){var a=b.queryCommandState("forecolor"),d=c.rbg2Hex(a);$("#select-color").css("color",d);var e=b.queryCommandState("bgcolor");if("rgba(0, 0, 0, 0)"===e)$("#select-bgcolor").css("color","#000");else{var d=c.rbg2Hex(e);$("#select-bgcolor").css("color",d)}var f=b.queryCommandState("fontsize");console.log(f),f=f.replace(/px/,""),$("#editor-font-size").val(f);var g=b.queryCommandState("fontfamily");$("#fontFamily").val(g)})}),d.ready(function(){b=this,b.on("stateChange",function(){var a=b.queryCommandState("forecolor"),d=c.rbg2Hex(a);$("#select-color").css("color",d);var e=b.queryCommandState("bgcolor");if("rgba(0, 0, 0, 0)"===e)$("#select-bgcolor").css("color","#000");else{var d=c.rbg2Hex(e);$("#select-bgcolor").css("color",d)}var f=b.queryCommandState("fontsize").replace(/px/,"");$("#editor-font-size").val(f);var g=b.queryCommandState("fontfamily");$("#fontFamily").val(g)})}),$("#link").on("click",function(){var a="",c=b.getRangeElem();c=b.getSelfOrParentByName(c,"a"),c&&(a=c.href||"");var e="",f=b.isRangeEmpty();f?c&&(e=c.textContent||c.innerHTML):e=b.getRangeText()||"",a||(a="http://"),$("#link-dialog-text").val(e),$("#link-dialog-url").val(a),$("#link-dialog").dialog({btn:["确定","取消"],yes:function(a){var c=$("#link-dialog-text").val(),e=$("#link-dialog-url").val();if(!e)return void ui.msg("请输入链接");c||(c=e);var f,g,h,i,j,k,l=b.txt.$txt,m="link"+d.random(),n=b.getRangeElem(),o=b.getSelfOrParentByName(n,"a"),p=b.isRangeEmpty();p?o?(f=$(o),h=function(){f.attr("href",e),f.text(c)},i=function(){var a=this;a.restoreSelectionByElem(o)},b.customCommand(null,h,i)):(g='<a href="'+e+'" target="_blank">'+c+"</a>",d.userAgent.indexOf("Firefox")>0&&(g+="<span>&nbsp;</span>"),b.command(null,"insertHtml",g)):(j=l.find("a"),j.attr(m,"1"),b.command(null,"createLink",e),k=l.find("a").not("["+m+"]"),k.attr("target","_blank"),j.removeAttr(m)),ui.close(a)}})}),$("#select-color").on("click",function(){ui.color(function(a){console.log(a),b.execCommand("forecolor",a)})}),$("#select-bgcolor").on("click",function(){ui.color(function(a){b.execCommand("bgcolor",a)})}),$("#editor-font-family").on("change",function(){var a=$(this).children("option:selected").val();b.execCommand("fontfamily",a)}),$("#editor-font-size").on("input",function(){b.execCommand("fontsize",$(this).val()+"px")})}),function(a){"use strict";function b(c,d){var e=this;e.opts=a.extend({},b.DEFAULTS,d),e.elem=c,e.$elem=a(c),e.rotating=!1,e.down=!1,e.init()}function c(c){return a(this).each(function(){var d=a(this),e=d.data("ui.rotateable");e||(e=new b(this,c),d.data("ui.rotateable",e)),"string"==typeof c&&e[c]()})}String.prototype.trim||(String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")}),b.DEFAULTS={handle:!1,centerX:0,centerY:0,start:function(a,b){},rotate:function(a,b){},end:function(a,b){}},b.getDeg=function(a){function b(a,b,c,d,e,f){var g=Math.round(180*Math.asin(a)/Math.PI),h=Math.round(180*Math.acos(b)/Math.PI),i=Math.round(180*Math.asin(c)/Math.PI),j=Math.round(180*Math.acos(d)/Math.PI),k=0;return g==h||-g==h?k=j:-g+h==180?k=180+i:g+h==180&&(k=360-i||360-j),k>=360?0:k}var c=a.css("transform"),d=0,e=/matrix\(([\d\D]*)\)/;if("none"!==c){var f=e.exec(c)[1].split(",");d=b(parseFloat(f[0].trim()),parseFloat(f[1].trim()),parseFloat(f[2].trim()),parseFloat(f[3].trim()),parseFloat(f[4].trim()),parseFloat(f[5].trim()))}return d};var d=b.prototype;d.init=function(){function c(a){a.stopPropagation();var b=d(g.centerX,g.centerY,a.clientX,a.clientY-f.startDeg);e(b),f.rotating?(a.deg=b,f.opts.rotate(a,f.elem)):(f.rotating=!0,f.opts.start(a,f.elem))}function d(a,b,c,d){var e=c-a,f=d-b,g=360*Math.atan2(f,e)/(2*Math.PI);return g=g<=-90?360+g:g,g+90}function e(a,b){f.$elem.css("transform","rotateZ("+(f.startRotate+a)+"deg)")}var f=this,g=f.opts;0==g.centerX&&0==g.centerY&&(g.centerX=f.$elem.offset().left+f.$elem.outerWidth()/2,g.centerY=f.$elem.offset().top+f.$elem.outerHeight()/2),g.handle?f.$handle=a(g.handle):(f.$handle=a('<div class="ui-rotate-handle"></div>'),f.$elem.append(f.$handle)),f.$handle.on("mousedown.ui.rotateable",function(e){f.down=!0,e.stopPropagation(),f.startDeg=d(g.centerX,g.centerY,event.clientX,event.clientY),f.startRotate=b.getDeg(f.$elem),a(document).on("mousemove.ui.rotateable",c)}),a(document).on("mouseup",function(b){f.down=!1,a(document).off("mousemove.ui.rotateable"),f.rotating&&(f.rotating=!1,f.opts.end(b,f.elem))})},d.enable=function(){},d.disable=function(){},d.destroy=function(){var a=this;a.$handle.off(".ui.rotateable"),a.opts.handle||a.$elem.find(".ui-rotate-handle").remove(),a.$elem.removeData("ui.rotateable")},UI.Rotateable=b,a.fn.rotateable=c}(jQuery),$(document).ready(function(){!function(a,b,c){function d(a){var c=b(window).scrollTop(),d=c+b(window).height(),e=a.offset().top,f=e+a.height();return f>=c&&e<=d&&f<=d&&e>=c}function e(a,b){var c,d,e,f,i=get_element(b);return f=2==j?"btn btn-primary btn-mini":"btn btn-primary btn-xs",a+="<div class='bootstro-nav-wrapper'>",c=i.attr("data-bootstro-nextButton")?i.attr("data-bootstro-nextButton"):i.attr("data-bootstro-nextButtonText")?'<button class="'+f+' bootstro-next-btn">'+i.attr("data-bootstro-nextButtonText")+"</button>":"undefined"!=typeof h.nextButton?h.nextButton:'<button class="'+f+' bootstro-next-btn">'+h.nextButtonText+"</button>",d=i.attr("data-bootstro-prevButton")?i.attr("data-bootstro-prevButton"):i.attr("data-bootstro-prevButtonText")?'<button class="'+f+' bootstro-prev-btn">'+i.attr("data-bootstro-prevButtonText")+"</button>":"undefined"!=typeof h.prevButton?h.prevButton:'<button class="'+f+' bootstro-prev-btn">'+h.prevButtonText+"</button>",e=i.attr("data-bootstro-finishButton")?i.attr("data-bootstro-finishButton"):i.attr("data-bootstro-finishButtonText")?'<button class="'+f+' bootstro-finish-btn">'+i.attr("data-bootstro-finishButtonText")+"</button>":"undefined"!=typeof h.finishButton?h.finishButton:'<button class="'+f+' bootstro-finish-btn">'+h.finishButtonText+"</button>",1!=g&&(0==b?a+=c:b==g-1?a+=d:a=a+c+d),a+="</div>",a=a+'<div class="bootstro-finish-btn-wrapper">'+e+"</div>"}var f,g,h,i=null,j=3,k={nextButtonText:"Next &raquo;",prevButtonText:"&laquo; Prev",finishButtonText:'<i class="icon-ok"></i> Ok I got it, get back to the site',stopOnBackdropClick:!0,stopOnEsc:!0,margin:100};process_items=function(a){var c=[];return b.each(a,function(a,d){b.each(d,function(a,c){b(d.selector).attr("data-bootstro-"+a,c)}),b(d.selector).is(":visible")&&c.push(d.selector)}),c.join(",")},get_element=function(a){return f.filter("[data-bootstro-step="+a+"]").size()>0?f.filter("[data-bootstro-step="+a+"]"):f.eq(a)},get_popup=function(a){var b={},c=get_element(a),d="";g>1&&(d="<span class='label label-success'>"+(a+1)+"/"+g+"</span>"),b.title=c.attr("data-bootstro-title")||"",""!=b.title&&""!=d?b.title=d+" - "+b.title:""==b.title&&(b.title=d),b.content=c.attr("data-bootstro-content")||"",b.content=e(b.content,a),b.placement=c.attr("data-bootstro-placement")||"top";var f="";return c.attr("data-bootstro-width")&&(b.width=c.attr("data-bootstro-width"),f=f+"width:"+c.attr("data-bootstro-width")+";"),c.attr("data-bootstro-height")&&(b.height=c.attr("data-bootstro-height"),f=f+"height:"+c.attr("data-bootstro-height")+";"),b.trigger="manual",b.html=c.attr("data-bootstro-html")||"top",c.attr("data-bootstro-container")&&(b.container=c.attr("data-bootstro-container")),b.template='<div class="popover" style="'+f+'"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>',b},a.destroy_popover=function(a){var a=a||0;if("all"!=a){var b=get_element(a);b.popover("destroy").removeClass("bootstro-highlight")}},a.stop=function(){a.destroy_popover(i),a.unbind(),b("div.bootstro-backdrop").remove(),"function"==typeof h.onExit&&h.onExit.call(this,{idx:i})},a.go_to=function(c){if(a.destroy_popover(i),0!=g){var e=get_popup(c),f=get_element(c);f.popover(e).popover("show");var j=b(window).scrollTop(),k=Math.min(b(".popover.in").offset().top,f.offset().top),l=k-j;l<h.margin?b("html,body").animate({scrollTop:k-h.margin},"slow"):d(b(".popover.in"))&&d(f)||b("html,body").animate({scrollTop:k-h.margin},"slow"),f.addClass("bootstro-highlight"),i=c}},a.next=function(){i+1==g?"function"==typeof h.onComplete&&h.onComplete.call(this,{idx:i}):(a.go_to(i+1),"function"==typeof h.onStep&&h.onStep.call(this,{idx:i,direction:"next"}))},a.prev=function(){0==i||(a.go_to(i-1),"function"==typeof h.onStep&&h.onStep.call(this,{idx:i,direction:"prev"}))},a._start=function(c){c=c||".bootstro",f=b(c),g=f.size(),g>0&&0===b("div.bootstro-backdrop").length&&(b('<div class="bootstro-backdrop"></div>').appendTo("body"),a.bind(),a.go_to(0))},a.start=function(c,d){h=b.extend(!0,{},k),b.extend(h,d||{}),"undefined"!=typeof h.url?b.ajax({url:h.url,success:function(b){if(b.success){var d=b.result;c=process_items(d),a._start(c)}}}):"undefined"!=typeof h.items?a._start(process_items(h.items)):a._start(c)},a.set_bootstrap_version=function(a){j=a},a.bind=function(){a.unbind(),b("html").on("click.bootstro",".bootstro-next-btn",function(b){return a.next(),b.preventDefault(),!1}),b("html").on("click.bootstro",".bootstro-prev-btn",function(b){return a.prev(),b.preventDefault(),!1}),b("html").on("click.bootstro",".bootstro-finish-btn",function(b){b.preventDefault(),a.stop()}),h.stopOnBackdropClick&&b("html").on("click.bootstro","div.bootstro-backdrop",function(c){b(c.target).hasClass("bootstro-backdrop")&&a.stop()}),b(document).on("keydown.bootstro",function(b){var c=b.keyCode?b.keyCode:b.which;39==c||40==c?a.next():37==c||38==c?a.prev():27==c&&h.stopOnEsc&&a.stop()})},a.unbind=function(){b("html").unbind("click.bootstro"),b(document).unbind("keydown.bootstro")}}(window.bootstro=window.bootstro||{},jQuery)}),function(a){function b(){}var c={move:{X:{next:"move-to-left-from-right",prev:"move-to-right-from-left"},Y:{next:"move-to-top-from-bottom",prev:"move-to-bottom-from-top"}},"move-fade":{X:{next:"fade-from-right",prev:"fade-from-left"},Y:{next:"fade-from-bottom",prev:"fade-from-top"}},"move-both-fade":{X:{next:"fade-left-fade-right",prev:"fade-right-fade-left"},Y:{next:"fade-top-fade-bottom",prev:"fade-bottom-fade-top"}},"move-different-easing":{X:{next:"different-easing-from-right",prev:"different-easing-from-left"},Y:{next:"different-easing-from-bottom",prev:"different-easing-from-top"}},"scale-down-out-move-in":{X:{next:"scale-down-from-right",prev:"move-to-right-scale-up"},Y:{next:"scale-down-from-bottom",prev:"move-to-bottom-scale-up"}},"move-out-scale-up":{X:{next:"move-to-left-scale-up",prev:"scale-down-from-left"},Y:{next:"move-to-top-scale-up",prev:"scale-down-from-top"}},"scale-up-up":{X:{next:"scale-up-scale-up",prev:"scale-down-scale-down"},Y:{next:"scale-up-scale-up",prev:"scale-down-scale-down"}},"scale-down-up":{X:{next:"scale-down-scale-up",prev:"scale-down-scale-up"},Y:{next:"scale-down-scale-up",prev:"scale-down-scale-up"}},glue:{X:{next:"glue-left-from-right",prev:"glue-right-from-left"},Y:{next:"glue-top-from-bottom",prev:"glue-bottom-from-top"}},flip:{X:{next:"flip-left",prev:"flip-right"},Y:{next:"flip-top",prev:"flip-bottom"}},fall:{X:{next:"fall",prev:"fall"},Y:{next:"fall",prev:"fall"}},newspaper:{X:{next:"newspaper",prev:"newspaper"},Y:{next:"newspaper",prev:"newspaper"}},push:{X:{next:"push-left-from-right",prev:"push-right-from-left"},Y:{next:"push-top-from-bottom",prev:"push-bottom-from-top"}},pull:{X:{next:"push-left-pull-right",prev:"push-right-pull-left"},Y:{next:"push-bottom-pull-top",prev:"push-top-pull-bottom"}},fold:{X:{next:"fold-left-from-right",prev:"move-to-right-unfold-left"},Y:{next:"fold-bottom-from-top",prev:"move-to-top-unfold-bottom"}},unfold:{X:{next:"move-to-left-unfold-right",prev:"fold-right-from-left"},Y:{next:"move-to-bottom-unfold-top",prev:"fold-top-from-bottom"}},room:{X:{next:"room-to-left",prev:"room-to-right"},Y:{next:"room-to-bottom",prev:"room-to-top"}},cube:{X:{next:"cube-to-left",prev:"cube-to-right"},Y:{next:"cube-to-bottom",prev:"cube-to-top"}},carousel:{X:{next:"carousel-to-left",prev:"carousel-to-right"},Y:{next:"carousel-to-bottom",prev:"carousel-to-top"}},sides:{X:{next:"sides",prev:"sides"},Y:{next:"sides",prev:"sides"}},slide:{X:{next:"slide",prev:"slide"},Y:{next:"slide",prev:"slide"}}},d={"move-to-left-from-right":{id:1,group:"move",label:"Move to left / from right",outClass:"fx-slide-moveToLeft",inClass:"fx-slide-moveFromRight",reverse:"move-to-right-from-left"},"move-to-right-from-left":{id:2,group:"move",label:"Move to right / from left",outClass:"fx-slide-moveToRight",inClass:"fx-slide-moveFromLeft",reverse:"move-to-left-from-right"},"move-to-top-from-bottom":{id:3,group:"move",label:"Move to top / from bottom",outClass:"fx-slide-moveToTop",inClass:"fx-slide-moveFromBottom",reverse:"move-to-bottom-from-top"},"move-to-bottom-from-top":{id:4,group:"move",label:"Move to bottom / from top",outClass:"fx-slide-moveToBottom",inClass:"fx-slide-moveFromTop",reverse:"move-to-top-from-bottom"},"fade-from-right":{id:5,group:"fade",label:"Fade / from right",outClass:"fx-slide-fade",inClass:"fx-slide-moveFromRight fx-slide-ontop",reverse:"fade-from-left"},"fade-from-left":{id:6,group:"fade",label:"Fade / from left",outClass:"fx-slide-fade",inClass:"fx-slide-moveFromLeft fx-slide-ontop",reverse:"fade-from-right"},"fade-from-bottom":{id:7,group:"fade",label:"Fade / from bottom",outClass:"fx-slide-fade",inClass:"fx-slide-moveFromBottom fx-slide-ontop",reverse:"fade-from-top"},"fade-from-top":{id:8,group:"fade",label:"Fade / from top",outClass:"fx-slide-fade",inClass:"fx-slide-moveFromTop fx-slide-ontop",reverse:"fade-from-bottom"},"fade-left-fade-right":{id:9,group:"fade",label:"Fade left / Fade right",outClass:"fx-slide-moveToLeftFade",inClass:"fx-slide-moveFromRightFade",reverse:"fade-right-fade-left"},"fade-right-fade-left":{id:10,group:"fade",label:"Fade right / Fade left",outClass:"fx-slide-moveToRightFade",inClass:"fx-slide-moveFromLeftFade",reverse:"fade-left-fade-right"},"fade-top-fade-bottom":{id:11,group:"fade",label:"Fade top / Fade bottom",outClass:"fx-slide-moveToTopFade",inClass:"fx-slide-moveFromBottomFade",reverse:"fade-bottom-fade-top"},"fade-bottom-fade-top":{id:12,group:"fade",label:"Fade bottom / Fade top",outClass:"fx-slide-moveToBottomFade",inClass:"fx-slide-moveFromTopFade",reverse:"fade-top-fade-bottom"},"different-easing-from-right":{id:13,group:"different-easing",label:"Different easing / from right",outClass:"fx-slide-moveToLeftEasing fx-slide-ontop",inClass:"fx-slide-moveFromRight",reverse:"different-easing-from-left"},"different-easing-from-left":{id:14,group:"different-easing",label:"Different easing / from left",outClass:"fx-slide-moveToRightEasing fx-slide-ontop",inClass:"fx-slide-moveFromLeft",reverse:"different-easing-from-right"},"different-easing-from-bottom":{id:15,group:"different-easing",label:"Different easing / from bottom",outClass:"fx-slide-moveToTopEasing fx-slide-ontop",inClass:"fx-slide-moveFromBottom",reverse:"different-easing-from-top"},"different-easing-from-top":{id:16,group:"different-easing",label:"Different easing / from top",outClass:"fx-slide-moveToBottomEasing fx-slide-ontop",inClass:"fx-slide-moveFromTop",reverse:"different-easing-from-bottom"},"scale-down-from-right":{id:17,group:"scale",label:"Scale down / from right",outClass:"fx-slide-scaleDown",inClass:"fx-slide-moveFromRight fx-slide-ontop",reverse:"move-to-right-scale-up"},"scale-down-from-left":{id:18,group:"scale",label:"Scale down / from left",outClass:"fx-slide-scaleDown",inClass:"fx-slide-moveFromLeft fx-slide-ontop",reverse:"move-to-left-scale-up"},"scale-down-from-bottom":{id:19,group:"scale",label:"Scale down / from bottom",outClass:"fx-slide-scaleDown",inClass:"fx-slide-moveFromBottom fx-slide-ontop",reverse:"move-to-bottom-scale-up"},"scale-down-from-top":{id:20,group:"scale",label:"Scale down / from top",outClass:"fx-slide-scaleDown",inClass:"fx-slide-moveFromTop fx-slide-ontop",reverse:"move-to-top-scale-up"},"scale-down-scale-down":{id:21,group:"scale",label:"Scale down / scale down",outClass:"fx-slide-scaleDown",inClass:"fx-slide-scaleUpDown fx-slide-delay300",reverse:"scale-up-scale-up"},"scale-up-scale-up":{id:22,group:"scale",label:"Scale up / scale up",outClass:"fx-slide-scaleDownUp",inClass:"fx-slide-scaleUp fx-slide-delay300",reverse:"scale-down-scale-down"},"move-to-left-scale-up":{id:23,group:"scale",label:"Move to left / scale up",outClass:"fx-slide-moveToLeft fx-slide-ontop",inClass:"fx-slide-scaleUp",reverse:"scale-down-from-left"},"move-to-right-scale-up":{id:24,group:"scale",label:"Move to right / scale up",outClass:"fx-slide-moveToRight fx-slide-ontop",inClass:"fx-slide-scaleUp",reverse:"scale-down-from-right"},"move-to-top-scale-up":{id:25,group:"scale",label:"Move to top / scale up",outClass:"fx-slide-moveToTop fx-slide-ontop",inClass:"fx-slide-scaleUp",reverse:"scale-down-from-top"},"move-to-bottom-scale-up":{id:26,group:"scale",label:"Move to bottom / scale up",outClass:"fx-slide-moveToBottom fx-slide-ontop",inClass:"fx-slide-scaleUp",reverse:"scale-down-from-bottom"},"scale-down-scale-up":{id:27,group:"scale",label:"Scale down / scale up",outClass:"fx-slide-scaleDownCenter",inClass:"fx-slide-scaleUpCenter fx-slide-delay400",reverse:"scale-down-scale-up"},"glue-left-from-right":{id:28,group:"rotate:glue",label:"Glue left / from right",outClass:"fx-slide-rotateRightSideFirst",inClass:"fx-slide-moveFromRight fx-slide-delay200 fx-slide-ontop",reverse:"glue-right-from-left"},"glue-right-from-left":{id:29,group:"rotate:glue",label:"Glue right / from left",outClass:"fx-slide-rotateLeftSideFirst",inClass:"fx-slide-moveFromLeft fx-slide-delay200 fx-slide-ontop",reverse:"glue-left-from-right"},"glue-bottom-from-top":{id:30,group:"rotate:glue",label:"Glue bottom / from top",outClass:"fx-slide-rotateTopSideFirst",inClass:"fx-slide-moveFromTop fx-slide-delay200 fx-slide-ontop",reverse:"glue-top-from-bottom"},"glue-top-from-bottom":{id:31,group:"rotate:glue",label:"Glue top / from bottom",outClass:"fx-slide-rotateBottomSideFirst",inClass:"fx-slide-moveFromBottom fx-slide-delay200 fx-slide-ontop",reverse:"glue-bottom-from-top"},"flip-right":{id:32,group:"rotate:flip",label:"Flip right",outClass:"fx-slide-flipOutRight",inClass:"fx-slide-flipInLeft fx-slide-delay500",reverse:"flip-left"},"flip-left":{id:33,group:"rotate:flip",label:"Flip left",outClass:"fx-slide-flipOutLeft",inClass:"fx-slide-flipInRight fx-slide-delay500",reverse:"flip-right"},"flip-top":{id:34,group:"rotate:flip",label:"Flip top",outClass:"fx-slide-flipOutTop",inClass:"fx-slide-flipInBottom fx-slide-delay500",reverse:"flip-bottom"},"flip-bottom":{id:35,group:"rotate:flip",label:"Flip bottom",outClass:"fx-slide-flipOutBottom",inClass:"fx-slide-flipInTop fx-slide-delay500",reverse:"flip-top"},fall:{id:36,group:"rotate",label:"Fall",outClass:"fx-slide-rotateFall fx-slide-ontop",inClass:"fx-slide-scaleUp",reverse:"fall"},newspaper:{id:37,group:"rotate",label:"Newspaper",outClass:"fx-slide-rotateOutNewspaper",inClass:"fx-slide-rotateInNewspaper fx-slide-delay500",reverse:"newspaper"},"push-left-from-right":{id:38,group:"rotate:push-pull",label:"Push left / from right",outClass:"fx-slide-rotatePushLeft",inClass:"fx-slide-moveFromRight",reverse:"push-right-from-left"},"push-right-from-left":{id:39,group:"rotate:push-pull",label:"Push right / from left",outClass:"fx-slide-rotatePushRight",inClass:"fx-slide-moveFromLeft",reverse:"push-left-from-right"},"push-top-from-bottom":{id:40,group:"rotate:push-pull",label:"Push top / from bottom",outClass:"fx-slide-rotatePushTop",inClass:"fx-slide-moveFromBottom",reverse:"push-bottom-from-top"},"push-bottom-from-top":{id:41,group:"rotate:push-pull",label:"Push bottom / from top",outClass:"fx-slide-rotatePushBottom",inClass:"fx-slide-moveFromTop",reverse:"push-top-from-bottom"},"push-left-pull-right":{id:42,group:"rotate:push-pull",label:"Push left / pull right",outClass:"fx-slide-rotatePushLeft",inClass:"fx-slide-rotatePullRight fx-slide-delay180",reverse:"push-right-pull-left"},"push-right-pull-left":{id:43,group:"rotate:push-pull",label:"Push right / pull left",outClass:"fx-slide-rotatePushRight",inClass:"fx-slide-rotatePullLeft fx-slide-delay180",reverse:"push-left-pull-right"},"push-top-pull-bottom":{id:44,group:"rotate:push-pull",label:"Push top / pull bottom",outClass:"fx-slide-rotatePushTop",inClass:"fx-slide-rotatePullBottom fx-slide-delay180",reverse:"push-bottom-pull-top"},"push-bottom-pull-top":{id:45,group:"rotate:push-pull",label:"Push bottom / pull top",outClass:"fx-slide-rotatePushBottom",inClass:"fx-slide-rotatePullTop fx-slide-delay180",reverse:"push-top-pull-bottom"},"fold-left-from-right":{id:46,group:"rotate:fold-unfold",label:"Fold left / from right",outClass:"fx-slide-rotateFoldLeft",inClass:"fx-slide-moveFromRightFade",reverse:"move-to-right-unfold-left"
},"fold-right-from-left":{id:47,group:"rotate:fold-unfold",label:"Fold right / from left",outClass:"fx-slide-rotateFoldRight",inClass:"fx-slide-moveFromLeftFade",reverse:"move-to-left-unfold-right"},"fold-top-from-bottom":{id:48,group:"rotate:fold-unfold",label:"Fold top / from bottom",outClass:"fx-slide-rotateFoldTop",inClass:"fx-slide-moveFromBottomFade",reverse:"move-to-bottom-unfold-top"},"fold-bottom-from-top":{id:49,group:"rotate:fold-unfold",label:"Fold bottom / from top",outClass:"fx-slide-rotateFoldBottom",inClass:"fx-slide-moveFromTopFade",reverse:"move-to-top-unfold-bottom"},"move-to-right-unfold-left":{id:50,group:"rotate:fold-unfold",label:"Move to right / unfold left",outClass:"fx-slide-moveToRightFade",inClass:"fx-slide-rotateUnfoldLeft",reverse:"fold-left-from-right"},"move-to-left-unfold-right":{id:51,group:"rotate:fold-unfold",label:"Move to left / unfold right",outClass:"fx-slide-moveToLeftFade",inClass:"fx-slide-rotateUnfoldRight",reverse:"fold-right-from-left"},"move-to-bottom-unfold-top":{id:52,group:"rotate:fold-unfold",label:"Move to bottom / unfold top",outClass:"fx-slide-moveToBottomFade",inClass:"fx-slide-rotateUnfoldTop",reverse:"fold-top-from-bottom"},"move-to-top-unfold-bottom":{id:53,group:"rotate:fold-unfold",label:"Move to top / unfold bottom",outClass:"fx-slide-moveToTopFade",inClass:"fx-slide-rotateUnfoldBottom",reverse:"fold-bottom-from-top"},"room-to-left":{id:54,group:"rotate:room",label:"Room to left",outClass:"fx-slide-rotateRoomLeftOut fx-slide-ontop",inClass:"fx-slide-rotateRoomLeftIn",reverse:"room-to-right"},"room-to-right":{id:55,group:"rotate:room",label:"Room to right",outClass:"fx-slide-rotateRoomRightOut fx-slide-ontop",inClass:"fx-slide-rotateRoomRightIn",reverse:"room-to-left"},"room-to-top":{id:56,group:"rotate:room",label:"Room to top",outClass:"fx-slide-rotateRoomTopOut fx-slide-ontop",inClass:"fx-slide-rotateRoomTopIn",reverse:"room-to-bottom"},"room-to-bottom":{id:57,group:"rotate:room",label:"Room to bottom",outClass:"fx-slide-rotateRoomBottomOut fx-slide-ontop",inClass:"fx-slide-rotateRoomBottomIn",reverse:"room-to-top"},"cube-to-left":{id:58,label:"Cube to left",outClass:"fx-slide-rotateCubeLeftOut fx-slide-ontop",inClass:"fx-slide-rotateCubeLeftIn",reverse:"cube-to-right"},"cube-to-right":{id:59,label:"Cube to right",outClass:"fx-slide-rotateCubeRightOut fx-slide-ontop",inClass:"fx-slide-rotateCubeRightIn",reverse:"cube-to-left"},"cube-to-top":{id:60,label:"Cube to top",outClass:"fx-slide-rotateCubeTopOut fx-slide-ontop",inClass:"fx-slide-rotateCubeTopIn",reverse:"cube-to-bottom"},"cube-to-bottom":{id:61,label:"Cube to bottom",outClass:"fx-slide-rotateCubeBottomOut fx-slide-ontop",inClass:"fx-slide-rotateCubeBottomIn",reverse:"cube-to-top"},"carousel-to-left":{id:62,group:"rotate:carousel",label:"Carousel to left",outClass:"fx-slide-rotateCarouselLeftOut fx-slide-ontop",inClass:"fx-slide-rotateCarouselLeftIn",reverse:"carousel-to-right"},"carousel-to-right":{id:63,group:"rotate:carousel",label:"Carousel to right",outClass:"fx-slide-rotateCarouselRightOut fx-slide-ontop",inClass:"fx-slide-rotateCarouselRightIn",reverse:"carousel-to-left"},"carousel-to-top":{id:64,group:"rotate:carousel",label:"Carousel to top",outClass:"fx-slide-rotateCarouselTopOut fx-slide-ontop",inClass:"fx-slide-rotateCarouselTopIn",reverse:"carousel-to-bottom"},"carousel-to-bottom":{id:65,group:"rotate:carousel",label:"Carousel to bottom",outClass:"fx-slide-rotateCarouselBottomOut fx-slide-ontop",inClass:"fx-slide-rotateCarouselBottomIn",reverse:"carousel-to-top"},sides:{id:66,group:"rotate",label:"Sides",outClass:"fx-slide-rotateSidesOut",inClass:"fx-slide-rotateSidesIn fx-slide-delay200",reverse:"sides"},slide:{id:67,label:"Slide",outClass:"fx-slide-rotateSlideOut",inClass:"fx-slide-rotateSlideIn",reverse:"slide"}};b.prototype.getAnim=function(a,b){var e=c[a].X[b];return"prev"===b?d[e]:d[e]},window.PptSlider=b}(jQuery),function(a){var b=window.UI,c="";a("#color-dialog-color").colorpicker({inline:!0,format:"rgb",container:"#color-dialog-color",sliders:{saturation:{maxLeft:200,maxTop:200,callLeft:"setSaturation",callTop:"setBrightness"},hue:{maxLeft:0,maxTop:200,callLeft:!1,callTop:"setHue"},alpha:{maxLeft:0,maxTop:200,callLeft:!1,callTop:"setAlpha"}},template:'<div class="colorpicker dropdown-menu"><div class="colorpicker-saturation"><i><b></b></i></div><div class="colorpicker-hue"><i></i></div><div class="colorpicker-alpha"><i></i></div><div class="colorpicker-selectors"></div></div>',preview:"#color-preview"}).on("changeColor",function(b){var d=b.color,e=d.value,f=d.toRGB();a("#hsl-h").val(Math.floor(360*e.h)),a("#hsl-s").val(Math.floor(100*e.s)),a("#hsl-b").val(Math.floor(100*e.b)),a("#hex").val(d.toHex().replace(/#/,"")),a("#rgb-r").val(f.r),a("#rgb-g").val(f.g),a("#rgb-b").val(f.b),c=b.color}),a("#rgb-r").on("input",function(){a("#color-dialog-color").colorpicker("setColor",c.setR(a(this).val()))}),a("#rgb-g").on("input",function(){a("#color-dialog-color").colorpicker("setColor",c.setG(a(this).val()))}),a("#rgb-b").on("input",function(){a("#color-dialog-color").colorpicker("setColor",c.setB(a(this).val()))}),a("#hsl-h").on("input",function(){a("#color-dialog-color").colorpicker("setColor",c.setHue(a(this).val()/360))}),a("#hsl-s").on("input",function(){a("#color-dialog-color").colorpicker("setColor",c.setSaturation(a(this).val()/100))}),a("#hsl-b").on("input",function(){a("#color-dialog-color").colorpicker("setColor",c.setBrightness(a(this).val()/100))}),a("#hex").on("change",function(){a("#color-dialog-color").colorpicker("setValue","#"+a(this).val())}),b.color=function(b,d){"function"==typeof b&&(d=b,b={}),a("#color-dialog-color").colorpicker("setValue","#f00"),a("#color-dialog").dialog({title:"颜色",btn:"确定",yes:function(a){ui.close(a),d(c.toHex())}})}}(jQuery),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")}),$.extend(ui.Dialog.DEFAULTS,{shadeClose:!0,draggable:!1}),function(a){function b(b,c){var d=this,e=a(b);e.on("click",function(a){a.preventDefault(),ui.color(function(a){d.color=a,e.css("background-color",d.color),e.trigger("change"),e.val(d.color)})})}b.prototype.val=function(a){return a?void(this.color=a):this.color},a.fn.color=function(c){return a(this).each(function(){new b(this)})}}(jQuery),function(a){function b(c,d){var e=this;e.opts=a.extend({},b.DEFAULTS,d),e.down=!1;var f=a("#ui-mult-select");e.$elem=a(c),e.disabled=!1;a(c).find(e.opts.item);f.length||(f=a('<div id="ui-mult-select" style="position: absolute; display: none; border: 1px dashed #000;opacity: .3;"></div>'),a(document.body).append(f))}b.DEFAULTS={item:"li",activeClass:"active"};var c=b.prototype;c.enable=function(){var a=this;a.disabled=!1},c.disable=function(){var a=this;a.disabled=!0},c.destroy=function(){var b=this;b.$elem.removeData("ui.multSelect"),b.$elem.off(".ui.multSelect"),a(document).off(".ui.multSelect")},a.fn.multSelect=function(c){return a(this).each(function(){var d=a(this),e=d.data("ui.multSelect");e||(e=new b(this,c),d.data("ui.multSelect",e)),"string"==typeof c&&e[c]()})}}(jQuery),UI.$curContextElem=null,function(a){function b(c,d){function e(b,c,d){var e=b.outerWidth(),f=b.outerHeight(),g=a(window).width(),h=a(window).height(),i=c,j=d;j<h-f||(j=j>f?d-f:h-f),i<g-e||(i=i>e?c-e:g-e),b.css({left:i,top:j})}function f(a,b){b.preventDefault(),b.stopPropagation(),UI.$curContextElem&&UI.$curContextElem.hide(),UI.$curContextElem=h,e(h,b.clientX,b.clientY),h.show(),g.opts.show&&g.opts.show(a),h.addClass("context-active"),UI.$curContextElem=h}var g=this;g.opts=a.extend({},b.DEFAULTS,d),g.elem=c;var h=a(g.opts.content);h.css("zIndex",10000001),g.opts.item?a(c).on("contextmenu",g.opts.item,function(a){return f(this,a),!0}):a(c).on("contextmenu",function(a){return f(this,a),!0}),h.on("contextmenu",function(){return!1})}b.DEFAULTS={show:function(a){},hide:function(a){}},a.fn.contextmenu=function(c){return a(this).each(function(a){new b(this,c)})}}(jQuery),$(document).on("click",function(a){(0==$(a.target).parents(".context-active").length||$(a.target).is(".dropdown-menu a"))&&UI.$curContextElem&&(UI.$curContextElem.hide(),UI.$curContextElem.removeClass("context-active"),UI.$curContextElem=null)}),function(a){a.fn.disableSelection=function(b){return a(this).each(function(){a(this).on("selectstart",function(){return!1})})}}(jQuery),function(a){"use strict";function b(c,d){this.opts=a.extend({},b.DEFAULTS,d),this.init()}window.SliderEditor=b,b.DEFAULTS={};var c=b.prototype;c.init=function(){function b(){var b=f.$curElem.position().left+1;f.$curElem.css("left",b+"px"),a("#editor-left").val(b)}function c(){var b=f.$curElem.position().left-1;f.$curElem.css("left",b+"px"),a("#editor-left").val(b)}function d(){var b=f.$curElem.position().top+1;f.$curElem.css("top",b+"px"),a("#editor-top").val(b)}function e(){var b=f.$curElem.position().top-1;f.$curElem.css("top",b+"px"),a("#editor-top").val(b)}var f=this;f.ppt={title:"新建 PowerPoint 演示文档",background:"none",bgColor:"#fff",slides:[]},f.$curElem=null,f.$editor=a("#editor"),f.$curPreviewItem=null,f.$previewList=a("#preview-list"),f.editing=!1,f.textEditor=null,a("#editor-text-edit").hide(),f.sizeType=0,f.switchAnim="glue",f.initEditArea(),f.initPreviewList(),f.initDisplay(),f.initToolArea(),f.initTopBar(),f.initIndex(),a(document).on("selectstart",function(){return f.editing}),a("#save").on("click",function(a){a.preventDefault(),f.saveModify(),ui.msg("功能暂未实现")}),f.dealBgImage(),a(document).on("keydown",function(a){if(f.editing)return!0;if(46===a.keyCode){if(f.$curElem){var b=f.$curElem;f.disableActiveElem(),b.remove()}return a.preventDefault(),!1}return!0}),a(document).on("keydown",function(a){if(!f.displaying&&f.$curElem){if("BODY"!==document.activeElement.nodeName)return;switch(a.keyCode){case 37:a.preventDefault(),c();break;case 38:a.preventDefault(),e();break;case 39:a.preventDefault(),b();break;case 40:a.preventDefault(),d()}}return!0}),a("#music").on("click",function(a){a.preventDefault(),ui.msg("暂未实现")})},c.quitEditorMode=function(){var b=this;b.editing&&(b.textEditor.destroy(),b.editing=!1,b.$editor.multSelect("enable")),a("#editor-text-edit").hide()},c.disableActiveElem=function(){if(this.$curElem){var a=this.$curElem;a.length&&(a.draggable("destroy"),a.resizable("destroy"),a.rotateable("destroy"),a.removeClass("active")),this.$curElem=null}},c.initEditArea=function(){function b(b){c(n.$curElem);var f=a("#edit-tool");f.find(".editor-box").hide(),f.find(".editor-common-box").show(),a("#editor-shadow-box").hide(),a("#editor-text-box").show(),"text"===b?(f.find(".editor-text-box").show(),k(n.$curElem)):"image"===b?(f.find(".editor-image-box").show(),d(n.$curElem)):"shape"===b?(f.find(".editor-shape-box").show(),e()):(f.find(".editor-chart-box").show(),j())}function c(b){l(),m();var c=ui.Rotateable.getDeg(n.$curElem);a("#editor-rotate").val(c);var d=b.css("border-style");if(a("#editor-border-style").val(d),"none"===d)a("#border-width-and-color").hide();else{a("#border-width-and-color").show();var e=b.css("border-width").replace("px","");a("#editor-border-width").val(e);var f=b.css("border-color");a("#editor-border-color").colorpicker("setValue",f)}var g=b.css("border-radius").replace("px","");a("#editor-border-radius").val(g);var h=b.css("opacity");a("#editor-opacity").val(100*h);var i=n.$curElem.attr("data-anim");if(i){a("#editor-anim-name").val(i),a("#editor-anim-box").show();var j=n.$curElem.css("animation-delay");j=1e3*parseInt(j.replace("s"),""),a("#editor-anim-delay").val(j);var k=n.$curElem.css("animation-duration");k=1e3*parseInt(k.replace("s"),""),a("#editor-anim-duration").val(k);var o=n.$curElem.css("animation-iteration-count");a("#editor-anim-count").val(o)}else a("#editor-anim-name").val(""),a("#editor-anim-box").hide()}function d(a){}function e(){var b=SVG(n.$curElem[0].getElementsByTagName("svg")[0]);a("#editor-fill-color").colorpicker("setValue",b.attr("fill"))}function f(a,b,c,d){for(var e=0,f=0;f<b.length;f++)b[f]>e&&(e=b[f]);var g=d/e,h=c/b.length;a.clear();for(var i=["#19bcc6","#a9e810","#f5a932","#ee6969","#8d4ccf"],f=0;f<b.length;f++){var j=b[f],k=17+h*f;a.line(k,d-g*j,k,d).back().stroke({color:i[f%5],width:h-10})}}function g(a,b,c,d){for(var e=0,f=0;f<b.length;f++)b[f]>e&&(e=b[f]);var g=d/e,h=c/b.length;a.clear();for(var i=[],f=0;f<b.length;f++){var j=b[f],k=17+h*f,l=d-g*j+4;i.push([k,l]),a.circle(8).attr("cx",k).attr("cy",l).fill("#19bcc6")}a.polyline(i).fill("none").back().stroke({color:"#19bcc6",width:2})}function h(a,b,c,d,e,f){var g=Math.PI/180,h=a+c*Math.cos(-d*g),i=a+c*Math.cos(-e*g),j=b+c*Math.sin(-d*g),k=b+c*Math.sin(-e*g),l=e-d>180?1:0;return"M "+a+" "+b+" L "+h+" "+j+" A "+c+" "+c+" 0 "+l+" 0 "+i+" "+k+" z"}function i(a,b,c,d){for(var e=(c>d?d:c)/2,f=e,g=e,i=0,j=0;j<b.length;j++)i+=b[j];a.clear();var k=["#19bcc6","#a9e810","#f5a932","#ee6969","#8d4ccf"],l=0;a.circle(2*e).attr("cx",f).attr("cy",g).fill(k[(b.length-1)%5]);for(var m=[],j=0;j<b.length-1;j++){b[j];l+=b[j]/i*360;var n=h(f,g,e,0,l);m.unshift(n)}for(var j=0;j<m.length;j++)a.path(m[j]).fill(k[j%5])}function j(){SVG(n.$curElem[0].getElementsByTagName("svg")[0]);a("#editor-data").val(n.$curElem.attr("data-data"));var b=n.$curElem.attr("data-chart");"line"===b?a("#editor-chart-type").val("line"):"bar"===b?a("#editor-chart-type").val("bar"):a("#editor-chart-type").val("pie")}function k(b){a("#editor-text-edit2").show();var c=b.css("color"),d=ui.Color.rbg2Hex(c);a("#select-color2").colorpicker("setValue",d);var e=b.css("background-color");a("#editor-bg-color").colorpicker("setValue",e);var f=b.css("font-family");a("#editor-font-family").find("option").each(function(){a(this).text()===f&&a(this).prop("selected",!0)}),f.length>10&&(f="微软雅黑"),a("#editor-font-family2").find("option").each(function(){a(this).text()===f&&a(this).prop("selected",!0)});var g=b.css("font-size").replace("px","");a("#editor-font-size").val(g),a("#editor-font-size2").val(g);var h=b.css("line-height").replace("px","");h=(parseInt(h)/parseInt(g)).toFixed(1),a("#editor-lineheight").val(h);var i=b.css("letter-spacing");0!==i&&(i=i.replace("px","")),a("#editor-letter-spacing").val(i);var j=n.$curElem.data("shadow");if("use"===j){a("#editor-shadow-box").show(),a("#editor-shadow").val("use");var k=n.$curElem.data("shadow-x");k||(k=0),a("#editor-shadow-x-offset").val(k);var l=n.$curElem.data("shadow-y");l||(l=0),a("#editor-shadow-y-offset").val(l);var m=n.$curElem.data("shadow-blur");m||(m=0),a("#editor-shadow-blur").val(m);var c=n.$curElem.data("shadow-color");c||(c="#000"),a("#editor-shadow-color").colorpicker("setValue",c)}else a("#editor-shadow-box").hide(),a("#editor-shadow").val("none")}function l(){var b=n.$curElem.outerWidth();a("#editor-width").val(b);var c=n.$curElem.outerHeight();a("#editor-height").val(c)}function m(){var b=parseInt(n.$curElem.offset().left-n.$editor.offset().left);a("#editor-left").val(b);var c=parseInt(n.$curElem.offset().top-n.$editor.offset().top);a("#editor-top").val(c)}var n=this;n.$editor.multSelect({item:".elem",activeClass:"mul-active"}),n.$editor.on("click",".elem",function(b){return n.displaying||n.editing?(console.log("bug"),!0):void n.selectElem(a(this))}),n.$editor.on("dblclick",".elem",function(b){if(b.stopPropagation(),n.displaying)return!1;if(n.disableActiveElem(),a(this).hasClass("elem-text")&&!n.editing){n.editing=!0;var c=a(this).find(".elem-content")[0];n.textEditor=new Editor(c,{simple:!0}),n.textEditor.create(),n.$editor.multSelect("disable");var d=a("#edit-tool");d.find(".editor-box").hide(),d.find(".editor-text-ediotr-box").show(),a("#tab-style").tab("show")}}),a("#elem-menu-move-front").on("click",function(){var b=n.$curElem.siblings(),c=parseInt(n.$curElem.css("z-index"));n.$curElem.css("z-index",b.length),b.each(function(){var b=parseInt(a(this).css("z-index"));b>=c&&a(this).css("z-index",b-1)}),n.updateIndex()}),a("#elem-menu-move-up").on("click",function(){var b=parseInt(n.$curElem.css("z-index")),c=n.$curElem.siblings();b>=c.length||(n.$curElem.css("z-index",b+1),c.each(function(){var c=a(this).css("z-index");parseInt(c)===parseInt(b)+1&&a(this).css("z-index",b)}),n.updateIndex())}),a("#elem-menu-move-behind").on("click",function(){var b=parseInt(n.$curElem.css("z-index"));n.$curElem.css("z-index",0),n.$curElem.siblings().each(function(){var c=parseInt(a(this).css("z-index"));c<=b&&a(this).css("z-index",c+1)}),n.updateIndex()}),a("#elem-menu-move-down").on("click",function(){var b=parseInt(n.$curElem.css("z-index"));0!==b&&(n.$curElem.css("z-index",b-1),n.$curElem.siblings().each(function(){var c=a(this).css("z-index");parseInt(c)===parseInt(b)-1&&a(this).css("z-index",b)}),n.updateIndex())}),a("#elem-menu-delete").on("click",function(a){a.preventDefault(),n.$curElem.remove()}),a("#elem-menu-cut").on("click",function(a){a.preventDefault(),n.$copyElem=n.$curElem,n.disableActiveElem(),n.$copyElem=n.$copyElem.detach()}),a("#elem-menu-copy").on("click",function(a){a.preventDefault(),n.$copyElem=n.$curElem}),a("#elem-menu-paste,#editor-menu-paste").on("click",function(b){if(b.preventDefault(),n.$copyElem){n.disableActiveElem();var c=a(n.$copyElem[0].outerHTML);c.css("top",n.$copyElem.position().top+10+"px"),c.css("left",n.$copyElem.position().left+10+"px"),c.removeClass("active"),n.$editor.append(c)}}),n.$editor.on("click",function(a){"editor"===a.target.id&&(n.disableActiveElem(),n.quitEditorMode(),n.hideBaseEditor())}),n.$editor.on("mousemove",function(b){var c=a(this).offset(),d=b.pageX-c.left,e=b.pageY-c.top;a("#position").text("("+d+", "+e+")")}),n.$editor.on("mouseout",function(){a("#position").text("(0, 0)")}),n.$editor.on("click","a",function(a){a.preventDefault()}),n.$editor.contextmenu({item:".elem",content:"#elem-menu",show:function(b){n.$copyElem?a("#elem-menu-paste").parent().removeClass("disabled"):a("#elem-menu-paste").parent().addClass("disabled"),n.selectElem(a(b))}}),n.$editor.contextmenu({content:"#editor-menu",show:function(){n.$copyElem?a("#editor-menu-paste").parent().removeClass("disabled"):a("#editor-menu-paste").parent().addClass("disabled")}}),a("#insert-chart1").on("click",function(b){b.preventDefault();var c="svg-"+(new Date).getTime(),d=(n.$editor.children().length,'<div class="elem elem-shape" data-type="chart" data-chart="pie" data-data="1,2,3,4" style="position: absolute; top: 25px; left: 26.5px; z-index: 2; width: 196px; height: 179px; cursor: auto;"><div class="elem-content"><svg id="'+c+'" width="196" height="179" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs" xmlns:svgjs="http://svgjs.com/svgjs"> </svg></div>');n.$editor.append(a(d)),n.updateIndex();var e=SVG(c);a("#editor-fill-color").colorpicker("setValue",e.attr("fill"));var f=[1,2,3,4];i(e,f,196,179)}),a("#insert-chart2").on("click",function(b){b.preventDefault();var c="svg-"+(new Date).getTime(),d=(n.$editor.children().length,'<div class="elem elem-shape" data-type="chart" data-chart="bar" data-data="1,2,3,4,5" style="position: absolute; top: 25px; left: 26.5px; z-index: 2; width: 196px; height: 179px; cursor: auto;"><div class="elem-content"><svg id="'+c+'" width="196" height="179" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs" xmlns:svgjs="http://svgjs.com/svgjs"> </svg></div>');n.$editor.append(a(d)),n.updateIndex();var e=SVG(c);a("#editor-fill-color").colorpicker("setValue",e.attr("fill"));var g=[1,2,3,4,5];f(e,g,196,179)}),a("#insert-chart3").on("click",function(b){b.preventDefault();var c="svg-"+(new Date).getTime(),d=(n.$editor.children().length,'<div class="elem elem-shape" data-type="chart" data-chart="line" data-data="1,3,4,5,2" style="position: absolute; top: 25px; left: 26.5px; z-index: 2; width: 196px; height: 179px; cursor: auto;"><div class="elem-content"><svg id="'+c+'" width="196" height="179" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs" xmlns:svgjs="http://svgjs.com/svgjs"> </svg></div>');n.$editor.append(a(d)),n.updateIndex();var e=SVG(c);a("#editor-fill-color").colorpicker("setValue",e.attr("fill"));var f=[1,3,4,5,2];g(e,f,196,179)}),a("#editor-chart-type").on("change",function(){for(var b=a(this).val(),c=a("#editor-data").val().split(","),d=0;d<c.length;d++)c[d]=parseInt(c[d]);var e=SVG(n.$curElem[0].getElementsByTagName("svg")[0]),h=n.$curElem.outerWidth(),j=n.$curElem.outerHeight();"pie"===b?(i(e,c,h,j),n.$curElem.attr("data-chart","pie")):"bar"===b?(f(e,c,h,j),n.$curElem.attr("data-chart","bar")):(g(e,c,h,j),n.$curElem.attr("data-chart","line"))}),a("#chart-update").on("click",function(b){b.preventDefault();for(var c=SVG(n.$curElem[0].getElementsByTagName("svg")[0]),d=a("#editor-data").val().split(","),e=0;e<d.length;e++)d[e]=parseInt(d[e]);var h=n.$curElem.attr("data-chart");n.$curElem.attr("data-data",a("#editor-data").val());var j=n.$curElem.outerWidth(),k=n.$curElem.outerHeight();"bar"===h?f(c,d,j,k):"line"===h?g(c,d,j,k):i(c,d,j,k)}),a(document).on("elemchnage",function(){var a=n.$curElem.data("type");b(a)}),a(document).on("elemPositionChange",function(){m()}),a(document).on("elemSizeChange",function(){l();var a=n.$curElem.attr("data-type");if("chart"===a){for(var b=n.$curElem.attr("data-chart"),c=SVG(n.$curElem[0].getElementsByTagName("svg")[0]),d=n.$curElem.attr("data-data").split(","),e=0;e<d.length;e++)d[e]=parseInt(d[e]);var h=n.$curElem.outerWidth(),j=n.$curElem.outerHeight();c.attr("width",h),c.attr("height",j),"bar"===b?f(c,d,h,j):"pie"===b?i(c,d,h,j):g(c,d,h,j)}else"video"===a&&n.$curElem.find("iframe").width(n.$curElem.outerWidth()).height(n.$curElem.outerHeight())}),"none"!==n.ppt.background&&a("#template").css("background-image","url("+n.ppt.background+")"),a("#template").css("background-color",n.ppt.bgColor)},c.selectElem=function(b){function c(b,c,d,e){if(null!=b){var f=a(b);c=f.offset(),d=f.outerWidth()-1,e=f.outerHeight()-1}return[{type:"h",left:null,top:c.top},{type:"h",left:null,top:c.top+e},{type:"v",left:c.left,top:null},{type:"v",left:c.left+d,top:null},{type:"h",left:null,top:c.top+e/2},{type:"v",left:c.left+d/2,top:null}]}function d(b,d){var e={top:{dist:i+1},left:{dist:i+1}},f=a(d),m={top:b.originalEvent.pageY-h,left:b.originalEvent.pageX-g},n=f.outerWidth()-1,o=f.outerHeight()-1,p=c(null,m,n,o);a.each(j,function(b,c){a.each(p,function(a,b){if(c.type===b.type){var d="h"===c.type?"top":"left",f=Math.abs(b[d]-c[d]);f<e[d].dist&&(e[d].dist=f,e[d].offset=b[d]-m[d],e[d].guide=c)}})}),e.top.dist<=i?k.css("top",e.top.guide.top).show():k.hide(),e.left.dist<=i?l.css("left",e.left.guide.left).show():l.hide()}function e(b,d){j=a.map(a("#editor .elem").not(".active"),c);var e=f.$editor.offset(),i=f.$editor.outerWidth(),k=f.$editor.outerHeight();j.push({type:"h",left:null,top:e.top}),j.push({type:"h",left:null,top:e.top+k}),j.push({type:"h",left:null,top:e.top+k/2}),j.push({type:"v",left:e.left,top:null}),j.push({type:"v",left:e.left+i,top:null}),j.push({type:"v",left:e.left+i/2,top:null}),g=b.originalEvent.offsetX,h=b.originalEvent.offsetY}var f=this;f.disableActiveElem(),f.$curElem=b,b.addClass("active");var g,h,i=10,j=[],k=a("#guide-h"),l=a("#guide-v");b.draggable({cursor:"move",scroll:!1,opacity:.5,distance:5,zIndex:1e4,start:function(a,b){e(a,b)},drag:function(b,d){var e={top:{dist:i+1},left:{dist:i+1}},m=a(d),n={top:b.originalEvent.pageY-h,left:b.originalEvent.pageX-g},o=m.outerWidth()-1,p=m.outerHeight()-1,q=c(null,n,o,p);a.each(j,function(b,c){a.each(q,function(a,b){if(c.type===b.type){var d="h"===c.type?"top":"left",f=Math.abs(b[d]-c[d]);f<e[d].dist&&(e[d].dist=f,e[d].offset=b[d]-n[d],e[d].guide=c)}})}),e.top.dist<=i?(k.css("top",e.top.guide.top).show(),d.style.top=e.top.guide.top-e.top.offset-f.$editor.offset().top+"px"):k.hide(),e.left.dist<=i?(l.css("left",e.left.guide.left).show(),d.style.left=e.left.guide.left-e.left.offset-f.$editor.offset().left+"px"):l.hide(),a(document).trigger("elemPositionChange")},end:function(a,b){k.hide(),l.hide()}}),b.resizable({handles:"n, e, s, w, ne, se, sw, nw",start:function(a,b){e(a,b)},resize:function(b,c){d(b,c),a(document).trigger("elemSizeChange")},end:function(b,c){k.hide(),l.hide(),a("#guide-v, #guide-h").hide()}}),b.rotateable({rotate:function(b,c){a("#editor-rotate").val(parseInt(b.deg))}}),b.draggable("enable"),b.resizable("enable"),b.rotateable("enable"),a(document).trigger("elemchnage"),f.updateIndexActive()},c.initPreviewList=function(){function b(b){j.$copyPage&&(j.totalPage+=1,b?(j.$curPreviewItem.after(a(j.$copyPage[0].outerHTML)),e(j.$curPreviewItem.index()+1)):(j.$previewList.append(a(j.$copyPage[0].outerHTML)),e(j.totalPage-1)))}function c(b){var c="none"===j.ppt.background?"background-color: "+j.ppt.bgColor:"background-image: url("+j.ppt.background+")",d='<li class="preview-item"><span class="page"></span><div class="viewport-box">  <div class="viewport" data-bg="default" style="'+c+'"></div><div class="viewport-mask"></div></div></li>',e=a(d);b?b.after(e):(j.$previewList.append(e),j.$previewList.scrollTop(j.$previewList[0].scrollHeight)),i(e),j.curPageIndex=e.index(),j.totalPage++,f()}function d(a){j.quitEditorMode(),j.disableActiveElem(),j.saveModify(),e(a),j.hideBaseEditor()}function e(a){j.curPageIndex=a;var b=j.$previewList.children().eq(a);i(b),f(),j.updateIndex()}function f(){a("#page").text("第 "+(j.curPageIndex+1)+" 张，共 "+j.totalPage+" 张"),j.$previewList.children().each(function(b){a(this).find(".page").text(b+1)})}function g(){j.curPageIndex<j.totalPage-1&&e(j.curPageIndex+1)}function h(){j.curPageIndex>0&&e(j.curPageIndex-1)}function i(b){j.$curPreviewItem=b,b.siblings().removeClass("active").end().addClass("active");var c=b.find(".viewport");if(j.$editor.html(c.html()),"default"===c.attr("data-bg"))j.$editor.css("background-image","none"),j.$editor.css("background-color","transparent");else{var d=c.css("background-image");j.$editor.css("background-image",d),j.$editor.css("background-color",c.css("background-color"))}a(".elem.active").removeClass("active");var e=j.$editor.css("background-color"),f=ui.Color.rbg2Hex(e);a("#editor-template-bg-color").colorpicker("setValue",f)}var j=this;j.curPageIndex=0,j.totalPage=j.$previewList.children().length,e(0),a(document).on("keydown",function(a){switch(a.keyCode){case 33:h();break;case 34:g()}return!0}),j.$previewList.contextmenu({content:"#preview-menu",show:function(b){j.$copyPage?a("#preview-paste").parent().removeClass("disabled"):a("#preview-paste").parent().addClass("disabled")}}),j.$previewList.contextmenu({item:".preview-item",content:"#preview-item-menu",show:function(b){j.$copyPage?a("#preview-menu-paste").parent().removeClass("disabled"):a("#preview-menu-paste").parent().addClass("disabled"),d(a(b).index())}}),j.$previewList.on("click",".preview-item",function(){d(a(this).index())}),a("#preview-menu-paste").on("click",function(a){a.preventDefault(),b(j.$curPreviewItem)}),a("#preview-paste").on("click",function(a){a.preventDefault(),b()}),a("#preview-menu-delete").on("click",function(a){if(a.preventDefault(),1===j.totalPage)j.$editor.empty(),j.$editor.css("background-image","none"),j.saveModify();else{var b,c=j.$curPreviewItem,d=j.$previewList.children();b=0===c.index()?1:c.index()===d.length-1?d.length-2:c.index()+1,e(b),c.remove(),j.totalPage--,f()}j.dealBgImage()}),a("#preview-menu-cut").on("click",function(a){a.preventDefault(),j.$copyPage=j.$curPreviewItem,j.$copyPage.removeClass("active"),j.$curPreviewItem.remove(),j.totalPage--,f()}),a("#preview-menu-copy").on("click",function(a){a.preventDefault(),j.$copyPage=j.$curPreviewItem,j.$copyPage.removeClass("active")}),a("#preview-menu-add").on("click",function(a){a.preventDefault(),c(j.$curPreviewItem)}),a("#new").on("click",function(b){b.preventDefault(),ui.confirm("所有内容将被清空？ ",function(b){ui.close(b),j.$previewList.empty(),j.totalPage=0,j.ppt.background="none",a("#template").css({"background-image":"none","background-color":"#fff"}),j.ppt.bgColor="#fff",c(),j.dealBgImage(),j.updateIndex()})}),a("#new-page,#preview-add").on("click",function(a){a.preventDefault(),c()}),j.$previewList.sortable({end:function(){j.curPageIndex=j.$previewList.find(".active").index(),f()}})},c.dealBgImage=function(){var b=this,c=b.$editor.css("background-image");"none"===c?a("#edidtor-bg-display").css("background-image",'url("asset/img/tpl/none.jpg")'):a("#edidtor-bg-display").css("background-image",c),a("#editor-base-bg-color").colorpicker("setValue",b.$editor.css("background-color")),"none"===b.ppt.background?a("#edidtor-bg-display2").css("background-image",'url("asset/img/tpl/none.jpg")'):a("#edidtor-bg-display2").css("background-image","url("+b.ppt.background+")"),a("#editor-template-bg-color").colorpicker("setValue",b.ppt.bgColor)},c.hideBaseEditor=function(){var b=this,c=a("#edit-tool");c.find(".editor-box").hide(),c.find(".editor-base-box").show(),b.dealBgImage()},c.saveModify=function(){var b=this,c=a(".preview-item.active .viewport");c.html(b.$editor.html()),c.css("background-color",b.$editor.css("background-color"));var d=b.$editor.css("background-image"),e=b.$editor.css("background-color");"none"===d?"transparent"===e||"rgba(0, 0, 0, 0)"===e||e===b.ppt.bgColor?(c.css("background-color",b.ppt.bgColor),"none"!==b.ppt.background&&c.css("background-image","url("+b.ppt.background+")")):(c.attr("data-bg","custom"),c.css("background-image","none"),c.css("background-color",e)):(c.attr("data-bg","custom"),c.css("background-image",d))},c.initIndex=function(){var b=this,c=a("#index-list");c.sortable(),c.selectable({item:".list-item",selected:function(c,d){var e=a(d).data("index");b.$editor.children().each(function(){a(this).css("z-index")==e&&b.selectElem(a(this))})}})},c.updateIndex=function(){var b=this;b.$editor.children();var c=a("#index-list");c.empty();var d="",e=[];b.$editor.children().each(function(){var b,c,d;a(this).hasClass("elem-text")?(b="text",c=a(this).find(".elem-content").text().substring(0,20),d=a(this).css("z-index"),"auto"===d&&(d=0)):a(this).hasClass("elem-image")?(b="image",c=a(this).find(".elem-content").attr("src"),d=a(this).css("z-index")):(b="shape",c="",d=a(this).css("z-index")),e.push({type:b,content:c,index:d})}),e.sort(function(a,b){return a.index<b.index});for(var f=0;f<e.length;f++){var g=e[f],h="";h+='<li class="list-item" data-index="'+g.index+'">',h+="text"===g.type?'<span class="type">文字</span><div class="content"><span>'+g.content+"</span></div>":"image"===g.type?'<span class="type" data-index="'+g.index+'">图片</span><div class="content"><img src="'+g.content+'"></div>':'<span class="type" data-index="'+g.index+'">形状</span><div class="content"><span>'+g.content+"</span></div>",h+="</li>",d+=h}c[0].innerHTML=d,b.updateIndexActive()},c.updateIndexActive=function(){var b=this;if(b.$curElem){var c=b.$editor.children().length-parseInt(b.$curElem.css("z-index"))-1,d=a("#index-list");d.find(".active").removeClass("active"),d.children().eq(c).addClass("active")}},c.initDisplay=function(){function b(){h.displaying=!1,a("#display").hide(),h.$editor.show()}function c(){var b=a(".display-list"),c=b.find(".display-item");c.eq(h.displayIndex);a("[data-anim]",c).each(function(){var b=a(this),c=b.attr("data-anim");b.addClass("animated"),b.addClass(c)})}function d(b){a("#display-progress-bar").css("width",(b+1)/h.totalPage*100+"%")}function e(){a(".preview-item.active .viewport").html(h.$editor.html());var b=h.$previewList.find(".preview-item");h.totalPage=b.length;var c=a(".display-list");c.empty();var e="",f=0;b.each(function(){f++;var b=a(this).find(".viewport"),c=b.css("background-image");c=c.replace(/\"/g,"'"),e+='<li class="display-item" asd'+f+' style=";background-image: '+c+";background-color: "+b.css("background-color")+';">'+b.html()+"</li>"}),c.html(e),a(".display-list").find(".display-item").eq(0).show();var g=0===h.sizeType?755:600,i=a(window).width()/g,j=a(window).height()/506;a("#display-device").css("transform","scale("+i+", "+j+")"),d(h.displayIndex)}function f(){if(h.displayIndex>0){if(h.displayScrolling)return;
h.displayIndex--;var b=a(".display-list"),e=b.find(".display-item"),f=e.eq(h.displayIndex+1),g=e.eq(h.displayIndex);if("none"===h.switchAnim)f.hide(),g.show();else if("fade"===h.switchAnim)f.fadeOut(),g.fadeIn();else{g.show();var j=i.getAnim(h.switchAnim,"prev");f.addClass(j.outClass),f.one("animationend ",function(a){f.removeClass(j.outClass),f.hide()}),h.displayScrolling=!0,g.addClass(j.inClass),g.one("animationend ",function(){g.removeClass(j.inClass),c(),h.displayScrolling=!1})}d(h.displayIndex)}else ui.msg("没有上一页了")}function g(){if(h.displayIndex<h.totalPage-1){if(h.displayScrolling)return;h.displayIndex++;var b=a(".display-list"),e=b.find(".display-item"),f=e.eq(h.displayIndex),g=e.eq(h.displayIndex-1);if("none"===h.switchAnim)f.show(),g.hide();else if("fade"===h.switchAnim)f.fadeIn(),g.fadeOut();else{f.show();var j=i.getAnim(h.switchAnim,"next");h.displayScrolling=!0,g.addClass(j.outClass),g.one("animationend ",function(){h.displayScrolling=!1,g.removeClass(j.outClass),g.hide()}),f.addClass(j.inClass),f.one("animationend ",function(){f.removeClass(j.inClass),c()})}d(h.displayIndex)}else ui.msg("没有下一页了")}var h=this;h.displaying=!1,h.displayIndex=0,a(document).on("keydown",function(a){if(h.displaying)switch(a.keyCode){case 8:case 33:case 37:case 38:f();break;case 32:case 34:case 39:case 40:g();break;case 27:b()}return!0}),a(document).on("mousewheel",function(a,b){return!a.ctrlKey&&(!h.displaying||(b>0?f():g(),!1))}),a("#display-show").on("click",function(){h.disableActiveElem(),h.saveModify(),e(),h.hideBaseEditor(),h.displaying=!0,h.displayIndex=0,h.$editor.hide(),a("#display").show(),c()});var i=new PptSlider;a("#display-prev").on("click",function(){f()}),a("#display-list").on("click",function(a){g()}),a("#display-list").on("click","a",function(a){a.stopPropagation()}),a("#display-list").on("click",".elem-video",function(b){b.stopPropagation(),a(this).find(".elem-icon").hide(),a(this).find("iframe").show()}),a("#display-next").on("click",function(){g()}),a("#display-close").on("click",function(){b()}),a("#display-menu-all").on("click",function(a){a.preventDefault(),b()}),a("#display-menu-close").on("click",function(a){a.preventDefault(),b()})},c.initToolArea=function(){function b(a){var b=c.$curElem.attr("data-anim");c.$curElem.removeClass(b),c.$curElem.addClass("animated"),c.$curElem.attr("data-anim",a),c.$curElem.addClass(a);var d=c.$curElem.css("animation-duration").replace("s","");d=1e3*parseInt(d),setTimeout(function(){var a=c.$curElem.attr("data-anim");c.$curElem.removeClass(a),c.$curElem.removeClass("animated")},d)}var c=this,d=a("#edit-tool");d.find(".editor-box").hide(),d.find(".editor-base-box").show(),a("#editor-anim-name").on("change",function(){var c=a(this).val();b(c),c?a("#editor-anim-box").show():a("#editor-anim-box").hide()}),a("#editor-font-family2").on("change",function(){a(this).val();c.$curElem.css("font-family",a(this).val())}),a("#editor-lineheight").on("input",function(){c.$curElem.css("line-height",a(this).val())}),a("#editor-letter-spacing").on("input",function(){c.$curElem.css("letter-spacing",a(this).val()+"px")}),a("#editor-font-size2").on("input",function(){a(this).val();c.$curElem.css("font-size",a(this).val()+"px")}),a("#editor-border-width").on("input",function(){c.$curElem.css("border-width",a(this).val()+"px")}),a("#editor-border-style").on("change",function(){var b,d=a(this).children("option:selected").val();if(b="none"===c.$curElem.css("border-style")?1:c.$curElem.css("border-width").replace("px",""),c.$curElem.css("border-style",d),"none"===d)a("#border-width-and-color").hide();else{a("#border-width-and-color").show(),a("#editor-border-width").val(b),c.$curElem.css("border-width",b+"px");var e=c.$curElem.css("border-color");a("#editor-border-color").colorpicker("setValue",e)}}),a("#editor-switch").on("change",function(){var b=a(this).val();c.switchAnim=b}),a("#editor-shadow").on("change",function(){var b=a(this).val();"none"===b?(a("#editor-shadow-box").hide(),c.$curElem.attr("data-shadow","none"),c.$curElem.css("text-shadow","none")):(a("#editor-shadow-box").show(),c.$curElem.attr("data-shadow","yes"),a("#editor-shadow-x-offset").val(0),a("#editor-shadow-y-offset").val(0),a("#editor-shadow-blur").val(3),c.$curElem.attr("data-shadow-blur",3),a("#editor-shadow-color").colorpicker("setValue","#000"),c.$curElem.css("text-shadow","0 0 3px #000"))}),a("#editor-shadow-x-offset").on("input",function(){var b=a(this).val();c.$curElem.attr("data-shadow-x",b);var d=c.$curElem.data("shadow-y");d||(d=0);var e=c.$curElem.data("shadow-blur");e||(e=0);var f=c.$curElem.data("shadow-color");f||(f="#000");var g=b+"px "+d+"px "+e+"px "+f;c.$curElem.css("text-shadow",g)}),a("#editor-shadow-y-offset").on("input",function(){var b=c.$curElem.data("shadow-x");b||(b=0);var d=a(this).val();c.$curElem.attr("data-shadow-y",d);var e=c.$curElem.data("shadow-blur");e||(e=0);var f=c.$curElem.data("shadow-color");f||(f="#000");var g=b+"px "+d+"px "+e+"px "+f;c.$curElem.css("text-shadow",g)}),a("#editor-shadow-blur").on("input",function(){var b=c.$curElem.data("shadow-x");b||(b=0);var d=c.$curElem.data("shadow-y");d||(d=0);var e=a(this).val();c.$curElem.attr("data-shadow-blur",e);var f=c.$curElem.data("shadow-color");f||(f="#000");var g=b+"px "+d+"px "+e+"px "+f;c.$curElem.css("text-shadow",g)}),a("#editor-shadow-color").colorpicker({format:"rgba"}).on("changeColor",function(a){var b=c.$curElem.data("shadow-x");b||(b=0);var d=c.$curElem.data("shadow-y");d||(d=0);var e=c.$curElem.data("shadow-blur");e||(e=0);var f=a.color.toString("rgba");c.$curElem.attr("data-shadow-color",f);var g=b+"px "+d+"px "+e+"px "+f;c.$curElem.css("text-shadow",g)}),a("#editor-border-radius").on("input",function(){c.$curElem.css("border-radius",a(this).val()+"px"),c.$curElem.find(".elem-content").css("border-radius",a(this).val()+"px")}),a("#editor-width").on("input",function(){c.$curElem.css("width",a(this).val()+"px")}),a("#editor-height").on("input",function(){c.$curElem.css("height",a(this).val()+"px")}),a("#editor-left").on("input",function(){c.$curElem.css("left",a(this).val()+"px")}),a("#editor-top").on("input",function(){c.$curElem.css("top",a(this).val()+"px")}),a("#editor-opacity").on("input",function(){c.$curElem.css("opacity",a(this).val()/100)}),a("#editor-rotate").on("input",function(){c.$curElem.css("transform","rotateZ("+a(this).val()+"deg)")}),a("#editor-anim-duration").on("change",function(){var b=a(this).val()/1e3+"s";c.$curElem.css("animation-duration",b)}),a("#editor-anim-delay").on("change",function(){var b=a(this).val()/1e3+"s";c.$curElem.css("animation-delay",b)}),a("#editor-anim-count").on("change",function(){c.$curElem.css("animation-iteration-count",a(this).val())}),a("#select-color2").colorpicker({}).on("changeColor",function(a){c.$curElem.css("color",a.color.toHex())}),a("#editor-base-bg-color").colorpicker({}).on("changeColor",function(a){c.$editor.css("background-image","none"),c.$editor.css("background-color",a.color.toHex()),c.saveModify(),c.dealBgImage()}),a("#editor-base-bg-img-cancel").on("click",function(){c.$editor.css("background-image","none"),c.$editor.css("background-color","transparent"),c.saveModify(),c.dealBgImage()}),a("#editor-base-bg-img").on("click",function(a){a.preventDefault(),ui.selectImage("替换背景图片",function(a){c.$editor.css("background-image","url("+a+")"),c.saveModify(),c.dealBgImage()})}),a("#editor-base-bg-img2").on("click",function(b){b.preventDefault(),ui.selectImage("选择图片",function(b){a("#template").css("background-image","url("+b+")"),c.$previewList.children().each(function(){var d=a(this).find(".viewport"),e=d.css("background-image");e=e.replace(/\"/g,"'"),e.indexOf(c.ppt.background)!==-1&&d.css("background-image","url("+b+")")}),c.ppt.background=b,c.dealBgImage()})}),a("#editor-template-bg-color").colorpicker({}).on("changeColor",function(b){c.$editor.css("background-color",b.color.toHex()),c.ppt.bgColor=b.color.toHex(),a("#template").css("background-image","none"),a("#template").css("background-color",c.ppt.bgColor),c.$previewList.children().each(function(){var b=a(this).find(".viewport");"default"==b.attr("data-bg")&&(b.css("background-image","none"),b.css("background-color",c.ppt.bgColor))}),c.ppt.background="none",c.dealBgImage()});a("#editor-bg-color").colorpicker({format:"rgb"}).on("changeColor",function(a){c.$curElem.css("background-color",a.color.toString("rgb"))}),a("#editor-fill-color").colorpicker({format:"rgba"}).on("changeColor",function(a){c.$curElem.find("svg").attr("fill",a.color.toString("rgba"))}),a("#editor-border-color").colorpicker({}).on("changeColor",function(a){c.$curElem.css("border-color",a.color.toHex())}),a("#editor-add-anim").on("click",function(a){a.preventDefault()}),a("#editor-play-anim").on("click",function(a){a.preventDefault();var d=c.$curElem.attr("data-anim");b(d)}),c.imageSelectCall=null,ui.selectImage=function(b,d){a("#image-selector").dialog({title:b.title,shadeClose:!0}),c.imageSelectCall=d},a("#editor-relace-img").on("click",function(a){a.preventDefault(),ui.selectImage("选择图片",function(a){c.$curElem.find(".elem-content").attr("src",a)})}),a(".select-img-list").on("click",".select-img-item",function(b){b.preventDefault();var d=a(this).find("img").attr("src");c.imageSelectCall&&c.imageSelectCall(d),ui.closeAll()})},c.initTopBar=function(){function b(b){b.addEventListener("dragenter",function(a){a.stopPropagation(),a.preventDefault()},!1),b.addEventListener("dragover",function(a){a.stopPropagation(),a.preventDefault()},!1),b.addEventListener("drop",function(b){b.stopPropagation(),b.preventDefault();var d=b.dataTransfer.files[0],e=window.URL||window.webkitURL,f=e.createObjectURL(d);c.imageSelectCall&&c.imageSelectCall(f),a("#image-selector").dialog("hide")},!1)}var c=this;a("#shape-box svg").click(function(b){b.preventDefault();var d=c.$editor.children().length,e='<div class="elem elem-shape" data-type="shape" style="position: absolute; top: 200px; left: 110px; z-index:'+d+';width: 100px;height:100px;"><div class="elem-content">'+this.outerHTML+"</div></div>";c.$editor.append(a(e)),ui.closeAll()}),a("#insert-text").on("click",function(b){b.preventDefault();var d=c.$editor.children().length,e='<div class="elem elem-text" data-type="text" style="position: absolute; top: 200px; left: 110px; z-index:'+d+';width: 400px;"><div class="elem-content"><p>点击编辑文字</p></div></div>';c.$editor.append(a(e)),c.updateIndex()}),a("#insert-video").on("click",function(b){b.preventDefault(),ui.prompt({title:"输入「视频」的 iframe",formType:2},function(b,d){if(!b)return void ui.msg("输入「视频」的 iframe");if(b.indexOf("iframe")===-1)return void ui.msg("请输入正确的 iframe");ui.close(d);var e=c.$editor.children().length,f='<div class="elem elem-video" data-type="video" style="position: absolute; top: 200px; left: 110px; z-index:'+e+';width: 400px; height: 300px">'+b+'<div class="elem-icon"><i class="icon icon-play"></i> </div><div class="elem-content"><p>点击编辑文字</p></div></div>',g=a(f);c.$editor.append(g),g.find("iframe").hide().width(400).height(300),c.updateIndex()})}),a("#insert-img").on("click",function(a){a.preventDefault(),ui.selectImage("替换背景图片",function(a){c.insertImage(a)})}),a("#insert-shape").on("click",function(b){b.preventDefault(),a("#shape-box").dialog({title:"插入形状"})}),a("#insert-table").on("click",function(b){b.preventDefault(),a("#table-dialog").dialog({title:"插入表格"})});var d=a("#choose-table"),e=a("#row"),f=a("#col");d.on("mouseenter","td",function(b){var c=a(b.currentTarget),g=c.attr("index"),h=c.parent(),i=h.attr("index");e.text(i),f.text(g),d.find("tr").each(function(){var b=a(this),c=b.attr("index");parseInt(c,10)<=parseInt(i,10)?b.find("td").each(function(){var b=a(this),c=b.attr("index");parseInt(c,10)<=parseInt(g,10)?b.addClass("active"):b.removeClass("active")}):b.find("td").removeClass("active")})}).on("mouseleave",function(a){d.find("td").removeClass("active"),e.text(0),f.text(0)}),d.on("click","td",function(b){var d,e,f=a(b.currentTarget),g=f.attr("index"),h=f.parent(),i=h.attr("index"),j=parseInt(i,10),k=parseInt(g,10),l="<table>";for(d=0;d<j;d++){for(l+="<tr>",e=0;e<k;e++)l+="<td><span>&nbsp;</span></td>";l+="</tr>"}l+="</table>";var m=c.$editor.children().length,n='<div class="elem elem-text" data-type="text" style="position: absolute; top: 50px; left: 50px; z-index: '+m+';width: 300px; height: 150px;"><div class="elem-content">'+l+"</div></div>";c.$editor.append(a(n)),ui.closeAll()}),a("#upload").on("click",function(){var b=a('<input type="file">');a(document.body).append(b),b.on("change",function(){if(a(this).val()){var b=this.files[0],d=window.URL||window.webkitURL,e=d.createObjectURL(b);a("#image-selector").dialog("hide"),c.imageSelectCall&&c.imageSelectCall(e)}}),b.hide(),b.trigger("click")});var g=(document.getElementById("editor"),document.getElementById("drop-area"));b(g),a("#image-selector-insert").on("click",function(b){b.preventDefault();var d=a("#image-selector-url").val();return d?(a("#image-selector").dialog("hide"),void c.insertImage(d)):void ui.msg("请输入网络图片地址")}),a("#design-list").on("click",".design-item",function(b){b.preventDefault();var d=a(this).find(".viewport");c.$editor.html(d.html());var e=d.css("background-image").trim();e.indexOf(c.ppt.background)===-1?c.$editor.css("background-image",e):c.$editor.css("background-image","none"),c.saveModify()}),a("#style").on("click",function(b){b.preventDefault(),0===c.sizeType?(c.sizeType=1,ui.msg("已切换至标准大小（4:3）"),a("#device").css("width","600px")):(c.sizeType=0,ui.msg("已切换至宽屏大小（16:9）"),a("#device").css("width","750px"))})},c.insertImage=function(b){var c=this,d=new Image;d.src=b,d.onload=function(){var e=d.width,f=d.height;if(e>750||f>750){var g=e>f?e:f;e=750*e/g,f=750*f/g}var h=c.$editor.children().length,i='<div class="elem elem-image" data-type="image" style="position: absolute; top: 225px; left: 100px; z-index: '+h+";width: "+e+"px; height: "+f+'px;"><img class="elem-content" src="'+b+'"></div>';c.$editor.append(a(i)),c.updateIndex()}}}(jQuery),$(document).ready(function(){"use strict";function a(){ui.frame("help.html",{title:"快捷键",size:"300px"})}function b(a){a.requestFullscreen?a.requestFullscreen():a.msRequestFullscreen?a.msRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullScreen&&a.webkitRequestFullScreen()}new SliderEditor("#demo",{});$("#key").on("click",function(b){b.preventDefault(),a()}),$("#about").on("click",function(a){a.preventDefault(),ui.alert("Slides v17.4.0")}),$("#display").contextmenu({content:"#display-menu"}),$("#help").on("click",function(a){a.preventDefault(),bootstro.start(".bootstro",{nextButtonText:"继续 >>",prevButtonText:"<< 返回",finishButtonText:"关闭"})});var c=!1;$("#fullscreen").click(function(){document.getElementById("editor");c?($(this).text("全屏"),c=!1,document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen()):($(this).text("取消全屏"),c=!0,b(document.documentElement))}),document.addEventListener("fullscreenchange, webkitfullscreenchange",function(){alert(1);document.fullscreenEnabled||window.fullScreen||document.webkitIsFullScreen||document.msFullscreenEnabled}),$("[data-toggle='tooltip']").tooltip()});